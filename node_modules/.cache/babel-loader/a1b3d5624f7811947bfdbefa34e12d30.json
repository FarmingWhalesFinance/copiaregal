{"ast":null,"code":"import { isThenable } from '../../lib/is-thenable';\nexport var createTaskGroup = function () {\n  var taskCompletionPromise;\n  var resolvePromise;\n  var count = 0;\n  return {\n    done: function () {\n      return taskCompletionPromise;\n    },\n    run: function (op) {\n      var returnValue = op();\n\n      if (isThenable(returnValue)) {\n        if (++count === 1) {\n          taskCompletionPromise = new Promise(function (res) {\n            return resolvePromise = res;\n          });\n        }\n\n        returnValue.finally(function () {\n          return --count === 0 && resolvePromise();\n        });\n      }\n\n      return returnValue;\n    }\n  };\n};","map":{"version":3,"sources":["../../../../src/core/task/task-group.ts"],"names":[],"mappings":"AAAA,SAAS,UAAT,QAA2B,uBAA3B;AASA,OAAO,IAAM,eAAe,GAAG,YAAA;EAC7B,IAAI,qBAAJ;EACA,IAAI,cAAJ;EACA,IAAI,KAAK,GAAG,CAAZ;EAEA,OAAO;IACL,IAAI,EAAE,YAAA;MAAM,OAAA,qBAAA;IAAqB,CAD5B;IAEL,GAAG,EAAE,UAAC,EAAD,EAAG;MACN,IAAM,WAAW,GAAG,EAAE,EAAtB;;MAEA,IAAI,UAAU,CAAC,WAAD,CAAd,EAA6B;QAC3B,IAAI,EAAE,KAAF,KAAY,CAAhB,EAAmB;UACjB,qBAAqB,GAAG,IAAI,OAAJ,CAAY,UAAC,GAAD,EAAI;YAAK,OAAC,cAAc,GAAf,GAAA;UAAsB,CAA3C,CAAxB;QACD;;QAED,WAAW,CAAC,OAAZ,CAAoB,YAAA;UAAM,OAAA,EAAE,KAAF,KAAY,CAAZ,IAAiB,cAAjB,EAAA;QAAiC,CAA3D;MACD;;MAED,OAAO,WAAP;IACD;EAdI,CAAP;AAgBD,CArBM","sourceRoot":"","sourcesContent":["import { isThenable } from '../../lib/is-thenable';\nexport var createTaskGroup = function () {\n    var taskCompletionPromise;\n    var resolvePromise;\n    var count = 0;\n    return {\n        done: function () { return taskCompletionPromise; },\n        run: function (op) {\n            var returnValue = op();\n            if (isThenable(returnValue)) {\n                if (++count === 1) {\n                    taskCompletionPromise = new Promise(function (res) { return (resolvePromise = res); });\n                }\n                returnValue.finally(function () { return --count === 0 && resolvePromise(); });\n            }\n            return returnValue;\n        },\n    };\n};\n//# sourceMappingURL=task-group.js.map"]},"metadata":{},"sourceType":"module"}