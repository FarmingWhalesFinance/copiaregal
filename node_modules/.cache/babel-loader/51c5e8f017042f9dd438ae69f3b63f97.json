{"ast":null,"code":"function findScript(src) {\n  var scripts = Array.prototype.slice.call(window.document.querySelectorAll('script'));\n  return scripts.find(function (s) {\n    return s.src === src;\n  });\n}\n\nexport function loadScript(src, attributes) {\n  var found = findScript(src);\n\n  if (found !== undefined) {\n    var status_1 = found === null || found === void 0 ? void 0 : found.getAttribute('status');\n\n    if (status_1 === 'loaded') {\n      return Promise.resolve(found);\n    }\n\n    if (status_1 === 'loading') {\n      return new Promise(function (resolve, reject) {\n        found.addEventListener('load', function () {\n          return resolve(found);\n        });\n        found.addEventListener('error', function (err) {\n          return reject(err);\n        });\n      });\n    }\n  }\n\n  return new Promise(function (resolve, reject) {\n    var _a;\n\n    var script = window.document.createElement('script');\n    script.type = 'text/javascript';\n    script.src = src;\n    script.async = true;\n    script.setAttribute('status', 'loading');\n\n    for (var _i = 0, _b = Object.entries(attributes !== null && attributes !== void 0 ? attributes : {}); _i < _b.length; _i++) {\n      var _c = _b[_i],\n          k = _c[0],\n          v = _c[1];\n      script.setAttribute(k, v);\n    }\n\n    script.onload = function () {\n      script.onerror = script.onload = null;\n      script.setAttribute('status', 'loaded');\n      resolve(script);\n    };\n\n    script.onerror = function () {\n      script.onerror = script.onload = null;\n      script.setAttribute('status', 'error');\n      reject(new Error(\"Failed to load \".concat(src)));\n    };\n\n    var tag = window.document.getElementsByTagName('script')[0];\n    (_a = tag.parentElement) === null || _a === void 0 ? void 0 : _a.insertBefore(script, tag);\n  });\n}\nexport function unloadScript(src) {\n  var found = findScript(src);\n\n  if (found !== undefined) {\n    found.remove();\n  }\n\n  return Promise.resolve();\n}","map":{"version":3,"sources":["../../../src/lib/load-script.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["function findScript(src) {\n    var scripts = Array.prototype.slice.call(window.document.querySelectorAll('script'));\n    return scripts.find(function (s) { return s.src === src; });\n}\nexport function loadScript(src, attributes) {\n    var found = findScript(src);\n    if (found !== undefined) {\n        var status_1 = found === null || found === void 0 ? void 0 : found.getAttribute('status');\n        if (status_1 === 'loaded') {\n            return Promise.resolve(found);\n        }\n        if (status_1 === 'loading') {\n            return new Promise(function (resolve, reject) {\n                found.addEventListener('load', function () { return resolve(found); });\n                found.addEventListener('error', function (err) { return reject(err); });\n            });\n        }\n    }\n    return new Promise(function (resolve, reject) {\n        var _a;\n        var script = window.document.createElement('script');\n        script.type = 'text/javascript';\n        script.src = src;\n        script.async = true;\n        script.setAttribute('status', 'loading');\n        for (var _i = 0, _b = Object.entries(attributes !== null && attributes !== void 0 ? attributes : {}); _i < _b.length; _i++) {\n            var _c = _b[_i], k = _c[0], v = _c[1];\n            script.setAttribute(k, v);\n        }\n        script.onload = function () {\n            script.onerror = script.onload = null;\n            script.setAttribute('status', 'loaded');\n            resolve(script);\n        };\n        script.onerror = function () {\n            script.onerror = script.onload = null;\n            script.setAttribute('status', 'error');\n            reject(new Error(\"Failed to load \".concat(src)));\n        };\n        var tag = window.document.getElementsByTagName('script')[0];\n        (_a = tag.parentElement) === null || _a === void 0 ? void 0 : _a.insertBefore(script, tag);\n    });\n}\nexport function unloadScript(src) {\n    var found = findScript(src);\n    if (found !== undefined) {\n        found.remove();\n    }\n    return Promise.resolve();\n}\n//# sourceMappingURL=load-script.js.map"]},"metadata":{},"sourceType":"module"}