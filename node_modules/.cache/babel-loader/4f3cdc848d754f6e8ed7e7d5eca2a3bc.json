{"ast":null,"code":"import { pickPrefix } from './pickPrefix';\nimport { gracefulDecodeURIComponent } from './gracefulDecodeURIComponent';\nexport function queryString(analytics, query) {\n  var a = document.createElement('a');\n  a.href = query;\n  var parsed = a.search.slice(1);\n  var params = parsed.split('&').reduce(function (acc, str) {\n    var _a = str.split('='),\n        k = _a[0],\n        v = _a[1];\n\n    acc[k] = gracefulDecodeURIComponent(v);\n    return acc;\n  }, {});\n  var calls = [];\n  var ajs_uid = params.ajs_uid,\n      ajs_event = params.ajs_event,\n      ajs_aid = params.ajs_aid;\n\n  if (ajs_aid) {\n    var anonId = Array.isArray(params.ajs_aid) ? params.ajs_aid[0] : params.ajs_aid;\n    analytics.setAnonymousId(anonId);\n  }\n\n  if (ajs_uid) {\n    var uid = Array.isArray(params.ajs_uid) ? params.ajs_uid[0] : params.ajs_uid;\n    var traits = pickPrefix('ajs_trait_', params);\n    calls.push(analytics.identify(uid, traits));\n  }\n\n  if (ajs_event) {\n    var event_1 = Array.isArray(params.ajs_event) ? params.ajs_event[0] : params.ajs_event;\n    var props = pickPrefix('ajs_prop_', params);\n    calls.push(analytics.track(event_1, props));\n  }\n\n  return Promise.all(calls);\n}","map":{"version":3,"sources":["../../../../src/core/query-string/index.ts"],"names":[],"mappings":"AAAA,SAAS,UAAT,QAA2B,cAA3B;AACA,SAAS,0BAAT,QAA2C,8BAA3C;AAQA,OAAM,SAAU,WAAV,CACJ,SADI,EAEJ,KAFI,EAES;EAEb,IAAM,CAAC,GAAG,QAAQ,CAAC,aAAT,CAAuB,GAAvB,CAAV;EACA,CAAC,CAAC,IAAF,GAAS,KAAT;EACA,IAAM,MAAM,GAAG,CAAC,CAAC,MAAF,CAAS,KAAT,CAAe,CAAf,CAAf;EACA,IAAM,MAAM,GAAG,MAAM,CAAC,KAAP,CAAa,GAAb,EAAkB,MAAlB,CAAyB,UAAC,GAAD,EAAyB,GAAzB,EAA4B;IAC5D,IAAA,EAAA,GAAS,GAAG,CAAC,KAAJ,CAAU,GAAV,CAAT;IAAA,IAAC,CAAC,GAAA,EAAA,CAAA,CAAA,CAAF;IAAA,IAAI,CAAC,GAAA,EAAA,CAAA,CAAA,CAAL;;IACN,GAAG,CAAC,CAAD,CAAH,GAAS,0BAA0B,CAAC,CAAD,CAAnC;IACA,OAAO,GAAP;EACD,CAJc,EAIZ,EAJY,CAAf;EAMA,IAAM,KAAK,GAAG,EAAd;EAEQ,IAAA,OAAO,GAAyB,MAAM,CAA/B,OAAP;EAAA,IAAS,SAAS,GAAc,MAAM,CAApB,SAAlB;EAAA,IAAoB,OAAO,GAAK,MAAM,CAAX,OAA3B;;EAER,IAAI,OAAJ,EAAa;IACX,IAAM,MAAM,GAAG,KAAK,CAAC,OAAN,CAAc,MAAM,CAAC,OAArB,IACX,MAAM,CAAC,OAAP,CAAe,CAAf,CADW,GAEX,MAAM,CAAC,OAFX;IAIA,SAAS,CAAC,cAAV,CAAyB,MAAzB;EACD;;EAED,IAAI,OAAJ,EAAa;IACX,IAAM,GAAG,GAAG,KAAK,CAAC,OAAN,CAAc,MAAM,CAAC,OAArB,IACR,MAAM,CAAC,OAAP,CAAe,CAAf,CADQ,GAER,MAAM,CAAC,OAFX;IAGA,IAAM,MAAM,GAAG,UAAU,CAAC,YAAD,EAAe,MAAf,CAAzB;IAEA,KAAK,CAAC,IAAN,CAAW,SAAS,CAAC,QAAV,CAAmB,GAAnB,EAAwB,MAAxB,CAAX;EACD;;EAED,IAAI,SAAJ,EAAe;IACb,IAAM,OAAK,GAAG,KAAK,CAAC,OAAN,CAAc,MAAM,CAAC,SAArB,IACV,MAAM,CAAC,SAAP,CAAiB,CAAjB,CADU,GAEV,MAAM,CAAC,SAFX;IAGA,IAAM,KAAK,GAAG,UAAU,CAAC,WAAD,EAAc,MAAd,CAAxB;IACA,KAAK,CAAC,IAAN,CAAW,SAAS,CAAC,KAAV,CAAgB,OAAhB,EAAuB,KAAvB,CAAX;EACD;;EAED,OAAO,OAAO,CAAC,GAAR,CAAY,KAAZ,CAAP;AACD","sourceRoot":"","sourcesContent":["import { pickPrefix } from './pickPrefix';\nimport { gracefulDecodeURIComponent } from './gracefulDecodeURIComponent';\nexport function queryString(analytics, query) {\n    var a = document.createElement('a');\n    a.href = query;\n    var parsed = a.search.slice(1);\n    var params = parsed.split('&').reduce(function (acc, str) {\n        var _a = str.split('='), k = _a[0], v = _a[1];\n        acc[k] = gracefulDecodeURIComponent(v);\n        return acc;\n    }, {});\n    var calls = [];\n    var ajs_uid = params.ajs_uid, ajs_event = params.ajs_event, ajs_aid = params.ajs_aid;\n    if (ajs_aid) {\n        var anonId = Array.isArray(params.ajs_aid)\n            ? params.ajs_aid[0]\n            : params.ajs_aid;\n        analytics.setAnonymousId(anonId);\n    }\n    if (ajs_uid) {\n        var uid = Array.isArray(params.ajs_uid)\n            ? params.ajs_uid[0]\n            : params.ajs_uid;\n        var traits = pickPrefix('ajs_trait_', params);\n        calls.push(analytics.identify(uid, traits));\n    }\n    if (ajs_event) {\n        var event_1 = Array.isArray(params.ajs_event)\n            ? params.ajs_event[0]\n            : params.ajs_event;\n        var props = pickPrefix('ajs_prop_', params);\n        calls.push(analytics.track(event_1, props));\n    }\n    return Promise.all(calls);\n}\n//# sourceMappingURL=index.js.map"]},"metadata":{},"sourceType":"module"}