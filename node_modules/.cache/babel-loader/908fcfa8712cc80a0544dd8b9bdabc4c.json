{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\rober\\\\Documents\\\\swaps-client\\\\src\\\\Helpers.js\",\n    _window,\n    _window$location,\n    _window2,\n    _window2$location,\n    _window3,\n    _window3$location,\n    _window4,\n    _window4$location,\n    _window5,\n    _window5$location,\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$(),\n    _s3 = $RefreshSig$(),\n    _s4 = $RefreshSig$(),\n    _s5 = $RefreshSig$(),\n    _s6 = $RefreshSig$(),\n    _s7 = $RefreshSig$(),\n    _s8 = $RefreshSig$(),\n    _s9 = $RefreshSig$();\n\nimport React, { useState, useRef, useEffect, useCallback } from \"react\";\nimport { InjectedConnector } from \"@web3-react/injected-connector\";\nimport { WalletConnectConnector, UserRejectedRequestError as UserRejectedRequestErrorWalletConnect } from \"@web3-react/walletconnect-connector\";\nimport { toast } from \"react-toastify\";\nimport { useWeb3React, UnsupportedChainIdError } from \"@web3-react/core\";\nimport { useLocalStorage } from \"react-use\";\nimport { ethers } from \"ethers\";\nimport { format as formatDateFn } from \"date-fns\";\nimport Token from \"./abis/Token.json\";\nimport _ from \"lodash\";\nimport { getContract } from \"./Addresses\";\nimport useSWR from \"swr\";\nimport OrderBookReader from \"./abis/OrderBookReader.json\";\nimport OrderBook from \"./abis/OrderBook.json\";\nimport { getWhitelistedTokens, isValidToken } from \"./data/Tokens\";\nimport ComingSoonTooltip from \"./components/Tooltip/ComingSoon\";\nimport { isAddress } from \"ethers/lib/utils\";\nimport { copyToClipboard } from './utils/common';\nimport { REFERRAL_CODE_QUERY_PARAMS, CURRENT_PROVIDER_LOCALSTORAGE_KEY, WALLET_CONNECT_LOCALSTORAGE_KEY, WALLET_LINK_LOCALSTORAGE_PREFIX, SHOULD_EAGER_CONNECT_LOCALSTORAGE_KEY } from \"./config/localstorage\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst {\n  AddressZero\n} = ethers.constants;\nexport const UI_VERSION = \"1.3\"; // use a random placeholder account instead of the zero address as the zero address might have tokens\n\nexport const PLACEHOLDER_ACCOUNT = ethers.Wallet.createRandom().address;\nexport const ETHEREUM = 1;\nexport const ARBITRUM_GOERLI = 421613;\nexport const ARBITRUM = 42161; // TODO take it from web3\n\nexport const DEFAULT_CHAIN_ID = ARBITRUM;\nexport const CHAIN_ID = DEFAULT_CHAIN_ID;\nexport const MIN_PROFIT_TIME = 0;\nconst SELECTED_NETWORK_LOCAL_STORAGE_KEY = \"SELECTED_NETWORK\";\nconst CHAIN_NAMES_MAP = {\n  [ARBITRUM_GOERLI]: \"Testnet\",\n  [ARBITRUM]: \"Arbitrum\"\n};\nconst GAS_PRICE_ADJUSTMENT_MAP = {\n  [ARBITRUM]: \"0\"\n};\nconst MAX_GAS_PRICE_MAP = {};\nconst alchemyWhitelistedDomains = [\"swaps.mycelium.xyz\"];\nexport function getFallbackArbitrumRpcUrl(useWebsocket) {\n  if (useWebsocket) {\n    return \"wss://arb1.arbitrum.io/ws\";\n  }\n\n  return \"https://arb1.arbitrum.io/rpc\";\n}\nexport function getDefaultArbitrumRpcUrl(useWebsocket) {\n  if (alchemyWhitelistedDomains.includes(window.location.host)) {\n    if (useWebsocket) {\n      return \"wss://arb-mainnet.g.alchemy.com/v2/SKz5SvTuqIVjE38XsFsy0McZbgfFPOng\";\n    }\n\n    return \"https://arb-mainnet.g.alchemy.com/v2/SKz5SvTuqIVjE38XsFsy0McZbgfFPOng\";\n  }\n\n  return getFallbackArbitrumRpcUrl(useWebsocket);\n}\nexport function getFallbackArbitrumGoerliRpcUrl(useWebsocket) {\n  if (useWebsocket) {\n    return \"https://goerli-rollup.arbitrum.io/rpc\";\n  }\n\n  return \"https://goerli-rollup.arbitrum.io/rpc\";\n}\nexport function getDefaultArbitrumGoerliRpcUrl(useWebsocket) {\n  if (alchemyWhitelistedDomains.includes(window.location.host)) {\n    if (useWebsocket) {\n      return \"wss://arb-goerli.g.alchemy.com/v2/sI8AlA8NGlqAZR_28jfPm9JPQQqmsN4U\";\n    }\n\n    return \"https://arb-goerli.g.alchemy.com/v2/sI8AlA8NGlqAZR_28jfPm9JPQQqmsN4U\";\n  }\n\n  return getFallbackArbitrumGoerliRpcUrl(useWebsocket);\n}\nconst ETHEREUM_RPC_PROVIDERS = [\"https://cloudflare-eth.com\"];\nconst ARBITRUM_RPC_PROVIDERS = [getDefaultArbitrumRpcUrl()];\nconst ARBITRUM_GOERLI_RPC_PROVIDERS = [getDefaultArbitrumGoerliRpcUrl()];\nexport function getChainName(chainId) {\n  return CHAIN_NAMES_MAP[chainId];\n}\nexport const USDG_ADDRESS = getContract(CHAIN_ID, \"USDG\");\n_c = USDG_ADDRESS;\nexport const MAX_LEVERAGE = 100 * 10000;\nexport const MAX_PRICE_DEVIATION_BASIS_POINTS = 250;\nexport const DEFAULT_GAS_LIMIT = 1 * 1000 * 1000;\nexport const SECONDS_PER_YEAR = 31536000;\nexport const FORTNIGHTS_IN_YEAR = 365 / 14;\nexport const USDG_DECIMALS = 18;\nexport const USD_DECIMALS = 30;\nexport const BASIS_POINTS_DIVISOR = 10000;\nexport const DEPOSIT_FEE = 30;\nexport const DUST_BNB = \"2000000000000000\";\nexport const DUST_USD = expandDecimals(1, USD_DECIMALS);\nexport const PRECISION = expandDecimals(1, 30);\nexport const ETH_DECIMALS = 18;\nexport const MLP_DECIMALS = 18;\nexport const MYC_DECIMALS = 18;\nexport const DEFAULT_MAX_USDG_AMOUNT = expandDecimals(200 * 1000 * 1000, 18);\nexport const TAX_BASIS_POINTS = 40;\nexport const STABLE_TAX_BASIS_POINTS = 2;\nexport const MINT_BURN_FEE_BASIS_POINTS = 18;\nexport const SWAP_FEE_BASIS_POINTS = 20;\nexport const STABLE_SWAP_FEE_BASIS_POINTS = 3;\nexport const MARGIN_FEE_BASIS_POINTS = 9;\nexport const LIQUIDATION_FEE = expandDecimals(5, USD_DECIMALS);\nexport const MLP_COOLDOWN_DURATION = 15 * 60;\nexport const THRESHOLD_REDEMPTION_VALUE = expandDecimals(993, 27); // 0.993\n\nexport const FUNDING_RATE_PRECISION = 1000000;\nexport const SWAP = \"Swap\";\nexport const INCREASE = \"Increase\";\nexport const DECREASE = \"Decrease\";\nexport const LONG = \"Long\";\nexport const SHORT = \"Short\";\nexport const MARKET = \"Market\";\nexport const LIMIT = \"Limit\";\nexport const STOP = \"Stop\";\nexport const LEVERAGE_ORDER_OPTIONS = [MARKET, LIMIT];\nexport const SWAP_ORDER_OPTIONS = [MARKET, LIMIT];\nexport const SWAP_OPTIONS = [LONG, SHORT, SWAP];\nexport const DEFAULT_SLIPPAGE_AMOUNT = 30;\nexport const DEFAULT_HIGHER_SLIPPAGE_AMOUNT = 100;\nexport const TRIGGER_PREFIX_ABOVE = \">\";\nexport const TRIGGER_PREFIX_BELOW = \"<\";\nexport const MIN_PROFIT_BIPS = 0;\nexport const MLP_POOL_COLORS = {\n  ETH: \"#6062a6\",\n  BTC: \"#F7931A\",\n  USDC: \"#2775CA\",\n  PPUSD: \"#2A5ADA\",\n  \"USDC.e\": \"#2A5ADA\",\n  USDT: \"#67B18A\",\n  MIM: \"#9695F8\",\n  FRAX: \"#000\",\n  DAI: \"#FAC044\",\n  UNI: \"#E9167C\",\n  LINK: \"#3256D6\",\n  CTM: \"#F8B500\",\n  FXS: \"#3B3B3B\",\n  BAL: \"#1B1B1B\",\n  CRV: \"#CF0301\",\n  TEST: \"#994443\"\n};\nexport const HIGH_SPREAD_THRESHOLD = expandDecimals(1, USD_DECIMALS).div(100); // 1%;\n\nexport const ICONLINKS = {\n  [ARBITRUM_GOERLI]: {\n    TCR: {\n      coingecko: \"https://www.coingecko.com/en/coins/tracer-dao\",\n      arbitrum: `https://arbiscan.io/address/${getContract(ARBITRUM_GOERLI, \"TCR\")}`\n    },\n    MLP: {\n      arbitrum: `https://arbiscan.io/address/${getContract(ARBITRUM_GOERLI, \"StakedMlpTracker\")}`\n    },\n    MYC: {\n      coingecko: \"https://www.coingecko.com/en/coins/mycelium\",\n      arbitrum: \"https://arbiscan.io/token/0xc74fe4c715510ec2f8c61d70d397b32043f55abe\"\n    },\n    ETH: {\n      coingecko: \"https://www.coingecko.com/en/coins/ethereum\"\n    },\n    BTC: {\n      coingecko: \"https://www.coingecko.com/en/coins/wrapped-bitcoin\",\n      arbitrum: \"https://arbiscan.io/address/0x2f2a2543b76a4166549f7aab2e75bef0aefc5b0f\"\n    },\n    LINK: {\n      coingecko: \"https://www.coingecko.com/en/coins/chainlink\",\n      arbitrum: \"https://arbiscan.io/address/0xf97f4df75117a78c1a5a0dbb814af92458539fb4\"\n    },\n    UNI: {\n      coingecko: \"https://www.coingecko.com/en/coins/uniswap\",\n      arbitrum: \"https://arbiscan.io/address/0xfa7f8980b0f1e64a2062791cc3b0871572f1f7f0\"\n    },\n    USDC: {\n      coingecko: \"https://www.coingecko.com/en/coins/usd-coin\",\n      arbitrum: \"https://arbiscan.io/address/0xff970a61a04b1ca14834a43f5de4533ebddb5cc8\"\n    },\n    PPUSD: {\n      arbitrum: \"https://goerli-rollup-explorer.arbitrum.io/address/0x9e062eee2c0Ab96e1E1c8cE38bF14bA3fa0a35F6\"\n    },\n    TEST: {\n      arbitrum: \"https://goerli-rollup-explorer.arbitrum.io/address/0xf76A36092f52Ea0ad1dFdDB5aced4e9f414524F2\"\n    },\n    USDT: {\n      coingecko: \"https://www.coingecko.com/en/coins/tether\",\n      arbitrum: \"https://arbiscan.io/address/0xfd086bc7cd5c481dcc9c85ebe478a1c0b69fcbb9\"\n    },\n    DAI: {\n      coingecko: \"https://www.coingecko.com/en/coins/dai\",\n      arbitrum: \"https://arbiscan.io/address/0xda10009cbd5d07dd0cecc66161fc93d7c9000da1\"\n    },\n    MIM: {\n      coingecko: \"https://www.coingecko.com/en/coins/magic-internet-money\",\n      arbitrum: \"https://arbiscan.io/address/0xfea7a6a0b346362bf88a9e4a88416b77a57d6c2a\"\n    },\n    FRAX: {\n      coingecko: \"https://www.coingecko.com/en/coins/frax\",\n      arbitrum: \"https://arbiscan.io/address/0x17fc002b466eec40dae837fc4be5c67993ddbd6f\"\n    }\n  },\n  42161: {\n    TCR: {\n      coingecko: \"https://www.coingecko.com/en/coins/tracer-dao\",\n      arbitrum: `https://arbiscan.io/address/${getContract(ARBITRUM, \"TCR\")}`\n    },\n    MLP: {\n      arbitrum: `https://arbiscan.io/address/${getContract(ARBITRUM, \"StakedMlpTracker\")}`\n    },\n    MYC: {\n      coingecko: \"https://www.coingecko.com/en/coins/mycelium\",\n      arbitrum: \"https://arbiscan.io/token/0xc74fe4c715510ec2f8c61d70d397b32043f55abe\"\n    },\n    ETH: {\n      coingecko: \"https://www.coingecko.com/en/coins/ethereum\"\n    },\n    BTC: {\n      coingecko: \"https://www.coingecko.com/en/coins/wrapped-bitcoin\",\n      arbitrum: \"https://arbiscan.io/address/0x2f2a2543b76a4166549f7aab2e75bef0aefc5b0f\"\n    },\n    LINK: {\n      coingecko: \"https://www.coingecko.com/en/coins/chainlink\",\n      arbitrum: \"https://arbiscan.io/address/0xf97f4df75117a78c1a5a0dbb814af92458539fb4\"\n    },\n    UNI: {\n      coingecko: \"https://www.coingecko.com/en/coins/uniswap\",\n      arbitrum: \"https://arbiscan.io/address/0xfa7f8980b0f1e64a2062791cc3b0871572f1f7f0\"\n    },\n    USDC: {\n      coingecko: \"https://www.coingecko.com/en/coins/usd-coin\",\n      arbitrum: \"https://arbiscan.io/address/0xff970a61a04b1ca14834a43f5de4533ebddb5cc8\"\n    },\n    USDT: {\n      coingecko: \"https://www.coingecko.com/en/coins/tether\",\n      arbitrum: \"https://arbiscan.io/address/0xfd086bc7cd5c481dcc9c85ebe478a1c0b69fcbb9\"\n    },\n    DAI: {\n      coingecko: \"https://www.coingecko.com/en/coins/dai\",\n      arbitrum: \"https://arbiscan.io/address/0xda10009cbd5d07dd0cecc66161fc93d7c9000da1\"\n    },\n    MIM: {\n      coingecko: \"https://www.coingecko.com/en/coins/magic-internet-money\",\n      arbitrum: \"https://arbiscan.io/address/0xfea7a6a0b346362bf88a9e4a88416b77a57d6c2a\"\n    },\n    FRAX: {\n      coingecko: \"https://www.coingecko.com/en/coins/frax\",\n      arbitrum: \"https://arbiscan.io/address/0x17fc002b466eec40dae837fc4be5c67993ddbd6f\"\n    },\n    FXS: {\n      coingecko: \"https://www.coingecko.com/en/coins/frax-share\",\n      arbitrum: \"https://arbiscan.io/address/0x9d2F299715D94d8A7E6F5eaa8E654E8c74a988A7\"\n    },\n    BAL: {\n      coingecko: \"https://www.coingecko.com/en/coins/balancer\",\n      arbitrum: \"https://arbiscan.io/address/0x040d1EdC9569d4Bab2D15287Dc5A4F10F56a56B8\"\n    },\n    CRV: {\n      coingecko: \"https://www.coingecko.com/en/coins/crv-dao-token\",\n      arbitrum: \"https://arbiscan.io/address/0x11cDb42B0EB46D95f990BeDD4695A6e3fA034978\"\n    }\n  }\n};\nexport const platformTokens = {\n  [ARBITRUM_GOERLI]: {\n    // arbitrum testnet\n    TCR: {\n      name: \"TCR\",\n      symbol: \"TCR\",\n      decimals: 18,\n      address: getContract(ARBITRUM_GOERLI, \"TCR\"),\n      imageUrl: `${(_window = window) === null || _window === void 0 ? void 0 : (_window$location = _window.location) === null || _window$location === void 0 ? void 0 : _window$location.origin}/icons/ic_tcr_40.svg`\n    },\n    MLP: {\n      name: \"TCR LP\",\n      symbol: \"MLP\",\n      decimals: 18,\n      address: getContract(ARBITRUM_GOERLI, \"StakedMlpTracker\"),\n      // address of fsMLP token because user only holds fsMLP\n      imageUrl: `${(_window2 = window) === null || _window2 === void 0 ? void 0 : (_window2$location = _window2.location) === null || _window2$location === void 0 ? void 0 : _window2$location.origin}/icons/ic_mlp_custom.svg`\n    }\n  },\n  [ARBITRUM]: {\n    // arbitrum\n    TCR: {\n      name: \"TCR\",\n      symbol: \"TCR\",\n      decimals: 18,\n      address: getContract(ARBITRUM, \"TCR\"),\n      imageUrl: `${(_window3 = window) === null || _window3 === void 0 ? void 0 : (_window3$location = _window3.location) === null || _window3$location === void 0 ? void 0 : _window3$location.origin}/icons/ic_tcr_40.svg`\n    },\n    MYC: {\n      name: \"MYC\",\n      symbol: \"MYC\",\n      decimals: 18,\n      address: getContract(ARBITRUM, \"MYC\"),\n      imageUrl: `${(_window4 = window) === null || _window4 === void 0 ? void 0 : (_window4$location = _window4.location) === null || _window4$location === void 0 ? void 0 : _window4$location.origin}/icons/ic_myc_custom.svg`\n    },\n    MLP: {\n      name: \"MYC LP\",\n      symbol: \"MLP\",\n      decimals: 18,\n      address: getContract(ARBITRUM, \"StakedMlpTracker\"),\n      // address of fsMLP token because user only holds fsMLP\n      imageUrl: `${(_window5 = window) === null || _window5 === void 0 ? void 0 : (_window5$location = _window5.location) === null || _window5$location === void 0 ? void 0 : _window5$location.origin}/icons/ic_mlp_custom.svg`\n    }\n  }\n};\nexport const networkOptions = [{\n  label: \"Testnet\",\n  value: ARBITRUM_GOERLI,\n  icon: \"ic_arbitrum_24.svg\",\n  color: \"#000000\"\n}];\nconst supportedChainIds = [ARBITRUM, ARBITRUM_GOERLI];\nconst injectedConnector = new InjectedConnector({\n  supportedChainIds\n});\n\nconst getWalletConnectConnector = () => {\n  const chainId = localStorage.getItem(SELECTED_NETWORK_LOCAL_STORAGE_KEY) || DEFAULT_CHAIN_ID;\n  return new WalletConnectConnector({\n    rpc: {\n      [ETHEREUM]: ETHEREUM_RPC_PROVIDERS[0],\n      [ARBITRUM]: ARBITRUM_RPC_PROVIDERS[0],\n      [ARBITRUM_GOERLI]: ARBITRUM_GOERLI_RPC_PROVIDERS[0]\n    },\n    qrcode: true,\n    chainId\n  });\n};\n\nexport function isSupportedChain(chainId) {\n  return supportedChainIds.includes(chainId);\n}\nexport function deserialize(data) {\n  for (const [key, value] of Object.entries(data)) {\n    if (value._type === \"BigNumber\") {\n      data[key] = bigNumberify(value.value);\n    }\n  }\n\n  return data;\n}\nexport const helperToast = {\n  success: content => {\n    toast.success(content);\n  },\n  error: content => {\n    toast.error(content);\n  }\n};\nexport function useLocalStorageByChainId(chainId, key, defaultValue) {\n  _s();\n\n  const [internalValue, setInternalValue] = useLocalStorage(key, {});\n  const setValue = useCallback(value => {\n    setInternalValue(internalValue => {\n      if (typeof value === \"function\") {\n        value = value(internalValue[chainId] || defaultValue);\n      }\n\n      const newInternalValue = { ...internalValue,\n        [chainId]: value\n      };\n      return newInternalValue;\n    });\n  }, [chainId, setInternalValue, defaultValue]);\n  let value;\n\n  if (chainId in internalValue) {\n    value = internalValue[chainId];\n  } else {\n    value = defaultValue;\n  }\n\n  return [value, setValue];\n}\n\n_s(useLocalStorageByChainId, \"E/lzpugvyMpWuZMg7Be6g3NFr+I=\", false, function () {\n  return [useLocalStorage];\n});\n\nexport function useLocalStorageSerializeKey(key, value, opts) {\n  _s2();\n\n  key = JSON.stringify(key);\n  return useLocalStorage(key, value, opts);\n}\n\n_s2(useLocalStorageSerializeKey, \"cjcH6UV3r3BpJj6dUjZ/UwDNNow=\", false, function () {\n  return [useLocalStorage];\n});\n\nfunction getTriggerPrice(tokenAddress, max, info, orderOption, triggerPriceUsd) {\n  // Limit/stop orders are executed with price specified by user\n  if (orderOption && orderOption !== MARKET && triggerPriceUsd) {\n    return triggerPriceUsd;\n  } // Market orders are executed with current market price\n\n\n  if (!info) {\n    return;\n  }\n\n  if (max && !info.maxPrice) {\n    return;\n  }\n\n  if (!max && !info.minPrice) {\n    return;\n  }\n\n  return max ? info.maxPrice : info.minPrice;\n}\n\nexport function getLiquidationPriceFromDelta(_ref) {\n  let {\n    liquidationAmount,\n    size,\n    collateral,\n    averagePrice,\n    isLong\n  } = _ref;\n\n  if (!size || size.eq(0)) {\n    return;\n  }\n\n  if (liquidationAmount.gt(collateral)) {\n    const liquidationDelta = liquidationAmount.sub(collateral);\n    const priceDelta = liquidationDelta.mul(averagePrice).div(size);\n    return isLong ? averagePrice.add(priceDelta) : averagePrice.sub(priceDelta);\n  }\n\n  const liquidationDelta = collateral.sub(liquidationAmount);\n  const priceDelta = liquidationDelta.mul(averagePrice).div(size);\n  return isLong ? averagePrice.sub(priceDelta) : averagePrice.add(priceDelta);\n}\nexport const replaceNativeTokenAddress = (path, nativeTokenAddress) => {\n  if (!path) {\n    return;\n  }\n\n  let updatedPath = [];\n\n  for (let i = 0; i < path.length; i++) {\n    let address = path[i];\n\n    if (address === AddressZero) {\n      address = nativeTokenAddress;\n    }\n\n    updatedPath.push(address);\n  }\n\n  return updatedPath;\n};\nexport function getMarginFee(sizeDelta) {\n  if (!sizeDelta) {\n    return bigNumberify(0);\n  }\n\n  const afterFeeUsd = sizeDelta.mul(BASIS_POINTS_DIVISOR - MARGIN_FEE_BASIS_POINTS).div(BASIS_POINTS_DIVISOR);\n  return sizeDelta.sub(afterFeeUsd);\n}\nexport function isTriggerRatioInverted(fromTokenInfo, toTokenInfo) {\n  if (!toTokenInfo || !fromTokenInfo) return false;\n  if (toTokenInfo.isStable || toTokenInfo.isUsdg) return true;\n  if (toTokenInfo.maxPrice) return toTokenInfo.maxPrice.lt(fromTokenInfo.maxPrice);\n  return false;\n}\nexport function getExchangeRate(tokenAInfo, tokenBInfo, inverted) {\n  if (!tokenAInfo || !tokenAInfo.minPrice || !tokenBInfo || !tokenBInfo.maxPrice) {\n    return;\n  }\n\n  if (inverted) {\n    return tokenAInfo.minPrice.mul(PRECISION).div(tokenBInfo.maxPrice);\n  }\n\n  return tokenBInfo.maxPrice.mul(PRECISION).div(tokenAInfo.minPrice);\n}\nexport function getMostAbundantStableToken(chainId, infoTokens) {\n  const whitelistedTokens = getWhitelistedTokens(chainId);\n  let availableAmount;\n  let stableToken = whitelistedTokens.find(t => t.isStable);\n\n  for (let i = 0; i < whitelistedTokens.length; i++) {\n    const info = getTokenInfo(infoTokens, whitelistedTokens[i].address);\n\n    if (!info.isStable || !info.availableAmount) {\n      continue;\n    }\n\n    const adjustedAvailableAmount = adjustForDecimals(info.availableAmount, info.decimals, USD_DECIMALS);\n\n    if (!availableAmount || adjustedAvailableAmount.gt(availableAmount)) {\n      availableAmount = adjustedAvailableAmount;\n      stableToken = info;\n    }\n  }\n\n  return stableToken;\n}\nexport function shouldInvertTriggerRatio(tokenA, tokenB) {\n  if (tokenB.isStable || tokenB.isUsdg) return true;\n  if (tokenB.maxPrice && tokenA.maxPrice && tokenB.maxPrice.lt(tokenA.maxPrice)) return true;\n  return false;\n}\nexport function getExchangeRateDisplay(rate, tokenA, tokenB) {\n  let opts = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n  if (!rate || !tokenA || !tokenB) return \"...\";\n\n  if (shouldInvertTriggerRatio(tokenA, tokenB)) {\n    [tokenA, tokenB] = [tokenB, tokenA];\n    rate = PRECISION.mul(PRECISION).div(rate);\n  }\n\n  const rateValue = formatAmount(rate, USD_DECIMALS, tokenA.isStable || tokenA.isUsdg ? 2 : 4, true);\n\n  if (opts.omitSymbols) {\n    return rateValue;\n  }\n\n  return `${rateValue} ${tokenA.symbol} / ${tokenB.symbol}`;\n}\n\nconst adjustForDecimalsFactory = n => number => {\n  if (n === 0) {\n    return number;\n  }\n\n  if (n > 0) {\n    return number.mul(expandDecimals(1, n));\n  }\n\n  return number.div(expandDecimals(1, -n));\n};\n\nexport function adjustForDecimals(amount, divDecimals, mulDecimals) {\n  return amount.mul(expandDecimals(1, mulDecimals)).div(expandDecimals(1, divDecimals));\n}\nexport function getTargetUsdgAmount(token, usdgSupply, totalTokenWeights) {\n  if (!token || !token.weight || !usdgSupply) {\n    return;\n  }\n\n  if (usdgSupply.eq(0)) {\n    return bigNumberify(0);\n  }\n\n  return token.weight.mul(usdgSupply).div(totalTokenWeights);\n}\nexport function getFeeBasisPoints(token, usdgDelta, feeBasisPoints, taxBasisPoints, increment, usdgSupply, totalTokenWeights) {\n  if (!token || !token.usdgAmount || !usdgSupply || !totalTokenWeights) {\n    return 0;\n  }\n\n  feeBasisPoints = bigNumberify(feeBasisPoints);\n  taxBasisPoints = bigNumberify(taxBasisPoints);\n  const initialAmount = token.usdgAmount;\n  let nextAmount = initialAmount.add(usdgDelta);\n\n  if (!increment) {\n    nextAmount = usdgDelta.gt(initialAmount) ? bigNumberify(0) : initialAmount.sub(usdgDelta);\n  }\n\n  const targetAmount = getTargetUsdgAmount(token, usdgSupply, totalTokenWeights);\n\n  if (!targetAmount || targetAmount.eq(0)) {\n    return feeBasisPoints.toNumber();\n  }\n\n  const initialDiff = initialAmount.gt(targetAmount) ? initialAmount.sub(targetAmount) : targetAmount.sub(initialAmount);\n  const nextDiff = nextAmount.gt(targetAmount) ? nextAmount.sub(targetAmount) : targetAmount.sub(nextAmount);\n\n  if (nextDiff.lt(initialDiff)) {\n    const rebateBps = taxBasisPoints.mul(initialDiff).div(targetAmount);\n    return rebateBps.gt(feeBasisPoints) ? 0 : feeBasisPoints.sub(rebateBps).toNumber();\n  }\n\n  let averageDiff = initialDiff.add(nextDiff).div(2);\n\n  if (averageDiff.gt(targetAmount)) {\n    averageDiff = targetAmount;\n  }\n\n  const taxBps = taxBasisPoints.mul(averageDiff).div(targetAmount);\n  return feeBasisPoints.add(taxBps).toNumber();\n}\nexport function getBuyMlpToAmount(fromAmount, swapTokenAddress, infoTokens, mlpPrice, usdgSupply, totalTokenWeights) {\n  const defaultValue = {\n    amount: bigNumberify(0),\n    feeBasisPoints: 0\n  };\n\n  if (!fromAmount || !swapTokenAddress || !infoTokens || !mlpPrice || !usdgSupply || !totalTokenWeights) {\n    return defaultValue;\n  }\n\n  const swapToken = getTokenInfo(infoTokens, swapTokenAddress);\n\n  if (!swapToken || !swapToken.minPrice) {\n    return defaultValue;\n  }\n\n  let mlpAmount = fromAmount.mul(swapToken.minPrice).div(mlpPrice);\n  mlpAmount = adjustForDecimals(mlpAmount, swapToken.decimals, USDG_DECIMALS);\n  let usdgAmount = fromAmount.mul(swapToken.minPrice).div(PRECISION);\n  usdgAmount = adjustForDecimals(usdgAmount, swapToken.decimals, USDG_DECIMALS);\n  const feeBasisPoints = getFeeBasisPoints(swapToken, usdgAmount, MINT_BURN_FEE_BASIS_POINTS, TAX_BASIS_POINTS, true, usdgSupply, totalTokenWeights);\n  mlpAmount = mlpAmount.mul(BASIS_POINTS_DIVISOR - feeBasisPoints).div(BASIS_POINTS_DIVISOR);\n  return {\n    amount: mlpAmount,\n    feeBasisPoints\n  };\n}\nexport function getSellMlpFromAmount(toAmount, swapTokenAddress, infoTokens, mlpPrice, usdgSupply, totalTokenWeights) {\n  const defaultValue = {\n    amount: bigNumberify(0),\n    feeBasisPoints: 0\n  };\n\n  if (!toAmount || !swapTokenAddress || !infoTokens || !mlpPrice || !usdgSupply || !totalTokenWeights) {\n    return defaultValue;\n  }\n\n  const swapToken = getTokenInfo(infoTokens, swapTokenAddress);\n\n  if (!swapToken || !swapToken.maxPrice) {\n    return defaultValue;\n  }\n\n  let mlpAmount = toAmount.mul(swapToken.maxPrice).div(mlpPrice);\n  mlpAmount = adjustForDecimals(mlpAmount, swapToken.decimals, USDG_DECIMALS);\n  let usdgAmount = toAmount.mul(swapToken.maxPrice).div(PRECISION);\n  usdgAmount = adjustForDecimals(usdgAmount, swapToken.decimals, USDG_DECIMALS);\n  const feeBasisPoints = getFeeBasisPoints(swapToken, usdgAmount, MINT_BURN_FEE_BASIS_POINTS, TAX_BASIS_POINTS, false, usdgSupply, totalTokenWeights);\n  mlpAmount = mlpAmount.mul(BASIS_POINTS_DIVISOR).div(BASIS_POINTS_DIVISOR - feeBasisPoints);\n  return {\n    amount: mlpAmount,\n    feeBasisPoints\n  };\n}\nexport function getBuyMlpFromAmount(toAmount, fromTokenAddress, infoTokens, mlpPrice, usdgSupply, totalTokenWeights) {\n  const defaultValue = {\n    amount: bigNumberify(0)\n  };\n\n  if (!toAmount || !fromTokenAddress || !infoTokens || !mlpPrice || !usdgSupply || !totalTokenWeights) {\n    return defaultValue;\n  }\n\n  const fromToken = getTokenInfo(infoTokens, fromTokenAddress);\n\n  if (!fromToken || !fromToken.minPrice) {\n    return defaultValue;\n  }\n\n  let fromAmount = toAmount.mul(mlpPrice).div(fromToken.minPrice);\n  fromAmount = adjustForDecimals(fromAmount, MLP_DECIMALS, fromToken.decimals);\n  const usdgAmount = toAmount.mul(mlpPrice).div(PRECISION);\n  const feeBasisPoints = getFeeBasisPoints(fromToken, usdgAmount, MINT_BURN_FEE_BASIS_POINTS, TAX_BASIS_POINTS, true, usdgSupply, totalTokenWeights);\n  fromAmount = fromAmount.mul(BASIS_POINTS_DIVISOR).div(BASIS_POINTS_DIVISOR - feeBasisPoints);\n  return {\n    amount: fromAmount,\n    feeBasisPoints\n  };\n}\nexport function getSellMlpToAmount(toAmount, fromTokenAddress, infoTokens, mlpPrice, usdgSupply, totalTokenWeights) {\n  const defaultValue = {\n    amount: bigNumberify(0)\n  };\n\n  if (!toAmount || !fromTokenAddress || !infoTokens || !mlpPrice || !usdgSupply || !totalTokenWeights) {\n    return defaultValue;\n  }\n\n  const fromToken = getTokenInfo(infoTokens, fromTokenAddress);\n\n  if (!fromToken || !fromToken.maxPrice) {\n    return defaultValue;\n  }\n\n  let fromAmount = toAmount.mul(mlpPrice).div(fromToken.maxPrice);\n  fromAmount = adjustForDecimals(fromAmount, MLP_DECIMALS, fromToken.decimals);\n  const usdgAmount = toAmount.mul(mlpPrice).div(PRECISION);\n  const feeBasisPoints = getFeeBasisPoints(fromToken, usdgAmount, MINT_BURN_FEE_BASIS_POINTS, TAX_BASIS_POINTS, false, usdgSupply, totalTokenWeights);\n  fromAmount = fromAmount.mul(BASIS_POINTS_DIVISOR - feeBasisPoints).div(BASIS_POINTS_DIVISOR);\n  return {\n    amount: fromAmount,\n    feeBasisPoints\n  };\n}\nexport function getNextFromAmount(chainId, toAmount, fromTokenAddress, toTokenAddress, infoTokens, toTokenPriceUsd, ratio, usdgSupply, totalTokenWeights) {\n  const defaultValue = {\n    amount: bigNumberify(0)\n  };\n\n  if (!toAmount || !fromTokenAddress || !toTokenAddress || !infoTokens) {\n    return defaultValue;\n  }\n\n  if (fromTokenAddress === toTokenAddress) {\n    return {\n      amount: toAmount\n    };\n  }\n\n  const fromToken = getTokenInfo(infoTokens, fromTokenAddress);\n  const toToken = getTokenInfo(infoTokens, toTokenAddress);\n\n  if (fromToken.isNative && toToken.isWrapped) {\n    return {\n      amount: toAmount\n    };\n  }\n\n  if (fromToken.isWrapped && toToken.isNative) {\n    return {\n      amount: toAmount\n    };\n  }\n\n  if (!fromToken || !fromToken.minPrice || !toToken || !toToken.maxPrice) {\n    return defaultValue;\n  }\n\n  const adjustDecimals = adjustForDecimalsFactory(fromToken.decimals - toToken.decimals);\n  let fromAmountBasedOnRatio;\n\n  if (ratio && !ratio.isZero()) {\n    fromAmountBasedOnRatio = toAmount.mul(ratio).div(PRECISION);\n  }\n\n  if (toTokenAddress === USDG_ADDRESS) {\n    const feeBasisPoints = getSwapFeeBasisPoints(fromToken.isStable);\n\n    if (ratio && !ratio.isZero()) {\n      return {\n        amount: adjustDecimals(fromAmountBasedOnRatio.mul(BASIS_POINTS_DIVISOR + feeBasisPoints).div(BASIS_POINTS_DIVISOR))\n      };\n    }\n\n    const fromAmount = toAmount.mul(PRECISION).div(fromToken.maxPrice);\n    return {\n      amount: adjustDecimals(fromAmount.mul(BASIS_POINTS_DIVISOR + feeBasisPoints).div(BASIS_POINTS_DIVISOR))\n    };\n  }\n\n  if (fromTokenAddress === USDG_ADDRESS) {\n    const redemptionValue = toToken.redemptionAmount.mul(toToken.maxPrice).div(expandDecimals(1, toToken.decimals));\n\n    if (redemptionValue.gt(THRESHOLD_REDEMPTION_VALUE)) {\n      const feeBasisPoints = getSwapFeeBasisPoints(toToken.isStable);\n      const fromAmount = ratio && !ratio.isZero() ? fromAmountBasedOnRatio : toAmount.mul(expandDecimals(1, toToken.decimals)).div(toToken.redemptionAmount);\n      return {\n        amount: adjustDecimals(fromAmount.mul(BASIS_POINTS_DIVISOR + feeBasisPoints).div(BASIS_POINTS_DIVISOR))\n      };\n    }\n\n    const expectedAmount = toAmount.mul(toToken.maxPrice).div(PRECISION);\n    const stableToken = getMostAbundantStableToken(chainId, infoTokens);\n\n    if (!stableToken || stableToken.availableAmount.lt(expectedAmount)) {\n      const feeBasisPoints = getSwapFeeBasisPoints(toToken.isStable);\n      const fromAmount = ratio && !ratio.isZero() ? fromAmountBasedOnRatio : toAmount.mul(expandDecimals(1, toToken.decimals)).div(toToken.redemptionAmount);\n      return {\n        amount: adjustDecimals(fromAmount.mul(BASIS_POINTS_DIVISOR + feeBasisPoints).div(BASIS_POINTS_DIVISOR))\n      };\n    }\n\n    const feeBasisPoints0 = getSwapFeeBasisPoints(true);\n    const feeBasisPoints1 = getSwapFeeBasisPoints(false);\n\n    if (ratio && !ratio.isZero()) {\n      // apply fees twice usdg -> token1 -> token2\n      const fromAmount = fromAmountBasedOnRatio.mul(BASIS_POINTS_DIVISOR + feeBasisPoints0 + feeBasisPoints1).div(BASIS_POINTS_DIVISOR);\n      return {\n        amount: adjustDecimals(fromAmount),\n        path: [USDG_ADDRESS, stableToken.address, toToken.address]\n      };\n    } // get fromAmount for stableToken => toToken\n\n\n    let fromAmount = toAmount.mul(toToken.maxPrice).div(stableToken.minPrice); // apply stableToken => toToken fees\n\n    fromAmount = fromAmount.mul(BASIS_POINTS_DIVISOR + feeBasisPoints1).div(BASIS_POINTS_DIVISOR); // get fromAmount for USDG => stableToken\n\n    fromAmount = fromAmount.mul(stableToken.maxPrice).div(PRECISION); // apply USDG => stableToken fees\n\n    fromAmount = fromAmount.mul(BASIS_POINTS_DIVISOR + feeBasisPoints0).div(BASIS_POINTS_DIVISOR);\n    return {\n      amount: adjustDecimals(fromAmount),\n      path: [USDG_ADDRESS, stableToken.address, toToken.address]\n    };\n  }\n\n  const fromAmount = ratio && !ratio.isZero() ? fromAmountBasedOnRatio : toAmount.mul(toToken.maxPrice).div(fromToken.minPrice);\n  let usdgAmount = fromAmount.mul(fromToken.minPrice).div(PRECISION);\n  usdgAmount = adjustForDecimals(usdgAmount, toToken.decimals, USDG_DECIMALS);\n  const swapFeeBasisPoints = fromToken.isStable && toToken.isStable ? STABLE_SWAP_FEE_BASIS_POINTS : SWAP_FEE_BASIS_POINTS;\n  const taxBasisPoints = fromToken.isStable && toToken.isStable ? STABLE_TAX_BASIS_POINTS : TAX_BASIS_POINTS;\n  const feeBasisPoints0 = getFeeBasisPoints(fromToken, usdgAmount, swapFeeBasisPoints, taxBasisPoints, true, usdgSupply, totalTokenWeights);\n  const feeBasisPoints1 = getFeeBasisPoints(toToken, usdgAmount, swapFeeBasisPoints, taxBasisPoints, false, usdgSupply, totalTokenWeights);\n  const feeBasisPoints = feeBasisPoints0 > feeBasisPoints1 ? feeBasisPoints0 : feeBasisPoints1;\n  return {\n    amount: adjustDecimals(fromAmount.mul(BASIS_POINTS_DIVISOR).div(BASIS_POINTS_DIVISOR - feeBasisPoints)),\n    feeBasisPoints\n  };\n}\nexport function getNextToAmount(chainId, fromAmount, fromTokenAddress, toTokenAddress, infoTokens, toTokenPriceUsd, ratio, usdgSupply, totalTokenWeights) {\n  const defaultValue = {\n    amount: bigNumberify(0)\n  };\n\n  if (!fromAmount || !fromTokenAddress || !toTokenAddress || !infoTokens) {\n    return defaultValue;\n  }\n\n  if (fromTokenAddress === toTokenAddress) {\n    return {\n      amount: fromAmount\n    };\n  }\n\n  const fromToken = getTokenInfo(infoTokens, fromTokenAddress);\n  const toToken = getTokenInfo(infoTokens, toTokenAddress);\n\n  if (fromToken.isNative && toToken.isWrapped) {\n    return {\n      amount: fromAmount\n    };\n  }\n\n  if (fromToken.isWrapped && toToken.isNative) {\n    return {\n      amount: fromAmount\n    };\n  }\n\n  if (!fromToken || !fromToken.minPrice || !toToken || !toToken.maxPrice) {\n    return defaultValue;\n  }\n\n  const adjustDecimals = adjustForDecimalsFactory(toToken.decimals - fromToken.decimals);\n  let toAmountBasedOnRatio = bigNumberify(0);\n\n  if (ratio && !ratio.isZero()) {\n    toAmountBasedOnRatio = fromAmount.mul(PRECISION).div(ratio);\n  }\n\n  if (toTokenAddress === USDG_ADDRESS) {\n    const feeBasisPoints = getSwapFeeBasisPoints(fromToken.isStable);\n\n    if (ratio && !ratio.isZero()) {\n      const toAmount = toAmountBasedOnRatio;\n      return {\n        amount: adjustDecimals(toAmount.mul(BASIS_POINTS_DIVISOR - feeBasisPoints).div(BASIS_POINTS_DIVISOR)),\n        feeBasisPoints\n      };\n    }\n\n    const toAmount = fromAmount.mul(fromToken.minPrice).div(PRECISION);\n    return {\n      amount: adjustDecimals(toAmount.mul(BASIS_POINTS_DIVISOR - feeBasisPoints).div(BASIS_POINTS_DIVISOR)),\n      feeBasisPoints\n    };\n  }\n\n  if (fromTokenAddress === USDG_ADDRESS) {\n    const redemptionValue = toToken.redemptionAmount.mul(toTokenPriceUsd || toToken.maxPrice).div(expandDecimals(1, toToken.decimals));\n\n    if (redemptionValue.gt(THRESHOLD_REDEMPTION_VALUE)) {\n      const feeBasisPoints = getSwapFeeBasisPoints(toToken.isStable);\n      const toAmount = ratio && !ratio.isZero() ? toAmountBasedOnRatio : fromAmount.mul(toToken.redemptionAmount).div(expandDecimals(1, toToken.decimals));\n      return {\n        amount: adjustDecimals(toAmount.mul(BASIS_POINTS_DIVISOR - feeBasisPoints).div(BASIS_POINTS_DIVISOR)),\n        feeBasisPoints\n      };\n    }\n\n    const expectedAmount = fromAmount;\n    const stableToken = getMostAbundantStableToken(chainId, infoTokens);\n\n    if (!stableToken || stableToken.availableAmount.lt(expectedAmount)) {\n      const toAmount = ratio && !ratio.isZero() ? toAmountBasedOnRatio : fromAmount.mul(toToken.redemptionAmount).div(expandDecimals(1, toToken.decimals));\n      const feeBasisPoints = getSwapFeeBasisPoints(toToken.isStable);\n      return {\n        amount: adjustDecimals(toAmount.mul(BASIS_POINTS_DIVISOR - feeBasisPoints).div(BASIS_POINTS_DIVISOR)),\n        feeBasisPoints\n      };\n    }\n\n    const feeBasisPoints0 = getSwapFeeBasisPoints(true);\n    const feeBasisPoints1 = getSwapFeeBasisPoints(false);\n\n    if (ratio && !ratio.isZero()) {\n      const toAmount = toAmountBasedOnRatio.mul(BASIS_POINTS_DIVISOR - feeBasisPoints0 - feeBasisPoints1).div(BASIS_POINTS_DIVISOR);\n      return {\n        amount: adjustDecimals(toAmount),\n        path: [USDG_ADDRESS, stableToken.address, toToken.address],\n        feeBasisPoints: feeBasisPoints0 + feeBasisPoints1\n      };\n    } // get toAmount for USDG => stableToken\n\n\n    let toAmount = fromAmount.mul(PRECISION).div(stableToken.maxPrice); // apply USDG => stableToken fees\n\n    toAmount = toAmount.mul(BASIS_POINTS_DIVISOR - feeBasisPoints0).div(BASIS_POINTS_DIVISOR); // get toAmount for stableToken => toToken\n\n    toAmount = toAmount.mul(stableToken.minPrice).div(toTokenPriceUsd || toToken.maxPrice); // apply stableToken => toToken fees\n\n    toAmount = toAmount.mul(BASIS_POINTS_DIVISOR - feeBasisPoints1).div(BASIS_POINTS_DIVISOR);\n    return {\n      amount: adjustDecimals(toAmount),\n      path: [USDG_ADDRESS, stableToken.address, toToken.address],\n      feeBasisPoints: feeBasisPoints0 + feeBasisPoints1\n    };\n  }\n\n  const toAmount = ratio && !ratio.isZero() ? toAmountBasedOnRatio : fromAmount.mul(fromToken.minPrice).div(toTokenPriceUsd || toToken.maxPrice);\n  let usdgAmount = fromAmount.mul(fromToken.minPrice).div(PRECISION);\n  usdgAmount = adjustForDecimals(usdgAmount, fromToken.decimals, USDG_DECIMALS);\n  const swapFeeBasisPoints = fromToken.isStable && toToken.isStable ? STABLE_SWAP_FEE_BASIS_POINTS : SWAP_FEE_BASIS_POINTS;\n  const taxBasisPoints = fromToken.isStable && toToken.isStable ? STABLE_TAX_BASIS_POINTS : TAX_BASIS_POINTS;\n  const feeBasisPoints0 = getFeeBasisPoints(fromToken, usdgAmount, swapFeeBasisPoints, taxBasisPoints, true, usdgSupply, totalTokenWeights);\n  const feeBasisPoints1 = getFeeBasisPoints(toToken, usdgAmount, swapFeeBasisPoints, taxBasisPoints, false, usdgSupply, totalTokenWeights);\n  const feeBasisPoints = feeBasisPoints0 > feeBasisPoints1 ? feeBasisPoints0 : feeBasisPoints1;\n  return {\n    amount: adjustDecimals(toAmount.mul(BASIS_POINTS_DIVISOR - feeBasisPoints).div(BASIS_POINTS_DIVISOR)),\n    feeBasisPoints\n  };\n}\nexport function getProfitPrice(closePrice, position) {\n  let profitPrice;\n\n  if (position && position.averagePrice && closePrice) {\n    profitPrice = position.isLong ? position.averagePrice.mul(BASIS_POINTS_DIVISOR + MIN_PROFIT_BIPS).div(BASIS_POINTS_DIVISOR) : position.averagePrice.mul(BASIS_POINTS_DIVISOR - MIN_PROFIT_BIPS).div(BASIS_POINTS_DIVISOR);\n  }\n\n  return profitPrice;\n}\nexport function calculatePositionDelta(price, _ref2, sizeDelta) {\n  let {\n    size,\n    collateral,\n    isLong,\n    averagePrice,\n    lastIncreasedTime\n  } = _ref2;\n\n  if (!sizeDelta) {\n    sizeDelta = size;\n  }\n\n  const priceDelta = averagePrice.gt(price) ? averagePrice.sub(price) : price.sub(averagePrice);\n  let delta = sizeDelta.mul(priceDelta).div(averagePrice);\n  const pendingDelta = delta;\n  const minProfitExpired = lastIncreasedTime + MIN_PROFIT_TIME < Date.now() / 1000;\n  const hasProfit = isLong ? price.gt(averagePrice) : price.lt(averagePrice);\n\n  if (!minProfitExpired && hasProfit && delta.mul(BASIS_POINTS_DIVISOR).lte(size.mul(MIN_PROFIT_BIPS))) {\n    delta = bigNumberify(0);\n  }\n\n  const deltaPercentage = delta.mul(BASIS_POINTS_DIVISOR).div(collateral);\n  const pendingDeltaPercentage = pendingDelta.mul(BASIS_POINTS_DIVISOR).div(collateral);\n  return {\n    delta,\n    pendingDelta,\n    pendingDeltaPercentage,\n    hasProfit,\n    deltaPercentage\n  };\n}\nexport function getDeltaStr(_ref3) {\n  let {\n    delta,\n    deltaPercentage,\n    hasProfit\n  } = _ref3;\n  let deltaStr;\n  let deltaPercentageStr;\n\n  if (delta.gt(0)) {\n    deltaStr = hasProfit ? \"+\" : \"-\";\n    deltaPercentageStr = hasProfit ? \"+\" : \"-\";\n  } else {\n    deltaStr = \"\";\n    deltaPercentageStr = \"\";\n  }\n\n  deltaStr += `$${formatAmount(delta, USD_DECIMALS, 2, true)}`;\n  deltaPercentageStr += `${formatAmount(deltaPercentage, 2, 2)}%`;\n  return {\n    deltaStr,\n    deltaPercentageStr\n  };\n}\nexport function getDeltaAfterFees(_ref4) {\n  let {\n    delta,\n    totalFees,\n    collateral,\n    hasProfit\n  } = _ref4;\n  let hasProfitAfterFees;\n  let pendingDeltaAfterFees;\n\n  if (hasProfit) {\n    if (delta.gt(totalFees)) {\n      hasProfitAfterFees = true;\n      pendingDeltaAfterFees = delta.sub(totalFees);\n    } else {\n      hasProfitAfterFees = false;\n      pendingDeltaAfterFees = totalFees.sub(delta);\n    }\n  } else {\n    hasProfitAfterFees = false;\n    pendingDeltaAfterFees = delta.add(totalFees);\n  }\n\n  let deltaPercentageAfterFees = pendingDeltaAfterFees.mul(BASIS_POINTS_DIVISOR).div(collateral);\n  return {\n    pendingDeltaAfterFees,\n    deltaPercentageAfterFees,\n    hasProfitAfterFees\n  };\n}\nexport function getLeverage(_ref5) {\n  let {\n    size,\n    sizeDelta,\n    increaseSize,\n    collateral,\n    collateralDelta,\n    increaseCollateral,\n    entryFundingRate,\n    cumulativeFundingRate,\n    hasProfit,\n    delta,\n    includeDelta\n  } = _ref5;\n\n  if (!size && !sizeDelta) {\n    return;\n  }\n\n  if (!collateral && !collateralDelta) {\n    return;\n  }\n\n  let nextSize = size ? size : bigNumberify(0);\n\n  if (sizeDelta) {\n    if (increaseSize) {\n      nextSize = size.add(sizeDelta);\n    } else {\n      if (sizeDelta.gte(size)) {\n        return;\n      }\n\n      nextSize = size.sub(sizeDelta);\n    }\n  }\n\n  let remainingCollateral = collateral ? collateral : bigNumberify(0);\n\n  if (collateralDelta) {\n    if (increaseCollateral) {\n      remainingCollateral = collateral.add(collateralDelta);\n    } else {\n      if (collateralDelta.gte(collateral)) {\n        return;\n      }\n\n      remainingCollateral = collateral.sub(collateralDelta);\n    }\n  }\n\n  if (delta && includeDelta) {\n    if (hasProfit) {\n      remainingCollateral = remainingCollateral.add(delta);\n    } else {\n      if (delta.gt(remainingCollateral)) {\n        return;\n      }\n\n      remainingCollateral = remainingCollateral.sub(delta);\n    }\n  }\n\n  if (remainingCollateral.eq(0)) {\n    return;\n  }\n\n  remainingCollateral = sizeDelta ? remainingCollateral.mul(BASIS_POINTS_DIVISOR - MARGIN_FEE_BASIS_POINTS).div(BASIS_POINTS_DIVISOR) : remainingCollateral;\n\n  if (entryFundingRate && cumulativeFundingRate) {\n    const fundingFee = size.mul(cumulativeFundingRate.sub(entryFundingRate)).div(FUNDING_RATE_PRECISION);\n    remainingCollateral = remainingCollateral.sub(fundingFee);\n  }\n\n  return nextSize.mul(BASIS_POINTS_DIVISOR).div(remainingCollateral);\n}\nexport function getLiquidationPrice(data) {\n  let {\n    isLong,\n    size,\n    collateral,\n    averagePrice,\n    entryFundingRate,\n    cumulativeFundingRate,\n    sizeDelta,\n    collateralDelta,\n    increaseCollateral,\n    increaseSize,\n    delta,\n    hasProfit,\n    includeDelta\n  } = data;\n\n  if (!size || !collateral || !averagePrice) {\n    return;\n  }\n\n  let nextSize = size ? size : bigNumberify(0);\n  let remainingCollateral = collateral;\n\n  if (sizeDelta) {\n    if (increaseSize) {\n      nextSize = size.add(sizeDelta);\n    } else {\n      if (sizeDelta.gte(size)) {\n        return;\n      }\n\n      nextSize = size.sub(sizeDelta);\n    }\n\n    if (includeDelta && !hasProfit) {\n      const adjustedDelta = sizeDelta.mul(delta).div(size);\n      remainingCollateral = remainingCollateral.sub(adjustedDelta);\n    }\n  }\n\n  if (collateralDelta) {\n    if (increaseCollateral) {\n      remainingCollateral = remainingCollateral.add(collateralDelta);\n    } else {\n      if (collateralDelta.gte(remainingCollateral)) {\n        return;\n      }\n\n      remainingCollateral = remainingCollateral.sub(collateralDelta);\n    }\n  }\n\n  let positionFee = getMarginFee(size).add(LIQUIDATION_FEE);\n\n  if (entryFundingRate && cumulativeFundingRate) {\n    const fundingFee = size.mul(cumulativeFundingRate.sub(entryFundingRate)).div(FUNDING_RATE_PRECISION);\n    positionFee = positionFee.add(fundingFee);\n  }\n\n  const liquidationPriceForFees = getLiquidationPriceFromDelta({\n    liquidationAmount: positionFee,\n    size: nextSize,\n    collateral: remainingCollateral,\n    averagePrice,\n    isLong\n  });\n  const liquidationPriceForMaxLeverage = getLiquidationPriceFromDelta({\n    liquidationAmount: nextSize.mul(BASIS_POINTS_DIVISOR).div(MAX_LEVERAGE),\n    size: nextSize,\n    collateral: remainingCollateral,\n    averagePrice,\n    isLong\n  });\n\n  if (!liquidationPriceForFees) {\n    return liquidationPriceForMaxLeverage;\n  }\n\n  if (!liquidationPriceForMaxLeverage) {\n    return liquidationPriceForFees;\n  }\n\n  if (isLong) {\n    // return the higher price\n    return liquidationPriceForFees.gt(liquidationPriceForMaxLeverage) ? liquidationPriceForFees : liquidationPriceForMaxLeverage;\n  } // return the lower price\n\n\n  return liquidationPriceForFees.lt(liquidationPriceForMaxLeverage) ? liquidationPriceForFees : liquidationPriceForMaxLeverage;\n}\nexport function getUsd(amount, tokenAddress, max, infoTokens, orderOption, triggerPriceUsd) {\n  if (!amount) {\n    return;\n  }\n\n  if (tokenAddress === USDG_ADDRESS) {\n    return amount.mul(PRECISION).div(expandDecimals(1, 18));\n  }\n\n  const info = getTokenInfo(infoTokens, tokenAddress);\n  const price = getTriggerPrice(tokenAddress, max, info, orderOption, triggerPriceUsd);\n\n  if (!price) {\n    return;\n  }\n\n  return amount.mul(price).div(expandDecimals(1, info.decimals));\n}\nexport function getPositionKey(account, collateralTokenAddress, indexTokenAddress, isLong, nativeTokenAddress) {\n  const tokenAddress0 = collateralTokenAddress === AddressZero ? nativeTokenAddress : collateralTokenAddress;\n  const tokenAddress1 = indexTokenAddress === AddressZero ? nativeTokenAddress : indexTokenAddress;\n  return account + \":\" + tokenAddress0 + \":\" + tokenAddress1 + \":\" + isLong;\n}\nexport function getPositionContractKey(account, collateralToken, indexToken, isLong) {\n  return ethers.utils.solidityKeccak256([\"address\", \"address\", \"address\", \"bool\"], [account, collateralToken, indexToken, isLong]);\n}\nexport function getSwapFeeBasisPoints(isStable) {\n  return isStable ? STABLE_SWAP_FEE_BASIS_POINTS : SWAP_FEE_BASIS_POINTS;\n}\nconst RPC_PROVIDERS = {\n  [ETHEREUM]: ETHEREUM_RPC_PROVIDERS,\n  [ARBITRUM]: ARBITRUM_RPC_PROVIDERS,\n  [ARBITRUM_GOERLI]: ARBITRUM_GOERLI_RPC_PROVIDERS\n};\nconst FALLBACK_PROVIDERS = {\n  [ARBITRUM]: [getFallbackArbitrumRpcUrl()],\n  [ARBITRUM_GOERLI]: [getFallbackArbitrumGoerliRpcUrl()]\n};\nexport function shortenAddress(address, length) {\n  if (!length) {\n    return \"\";\n  }\n\n  if (!address) {\n    return address;\n  }\n\n  if (address.length < 10) {\n    return address;\n  }\n\n  let left = Math.floor((length - 3) / 2) + 1;\n  return address.substring(0, left) + \"...\" + address.substring(address.length - (length - (left + 3)), address.length);\n}\nexport function formatTimeTill(time) {\n  const dateNow = new Date() / 1000;\n\n  if (time < dateNow) {\n    return \"0d 0h 0s\";\n  }\n\n  const secondsTill = Math.floor(time - dateNow);\n  let minutes = Math.floor(secondsTill / 60);\n  let hours = Math.floor(minutes / 60);\n  const days = Math.floor(hours / 24);\n  hours = hours - days * 24;\n  minutes = minutes - days * 24 * 60 - hours * 60;\n  return `${days}d ${hours}h ${minutes}m`;\n}\nexport function formatDateTime(time) {\n  return formatDateFn(time * 1000, \"dd MMM yyyy, h:mm a\");\n}\nexport function getTimeRemaining(time) {\n  const now = parseInt(Date.now() / 1000);\n\n  if (time < now) {\n    return \"0h 0m\";\n  }\n\n  const diff = time - now;\n  const hours = parseInt(diff / (60 * 60));\n  const minutes = parseInt((diff - hours * 60 * 60) / 60);\n  return `${hours}h ${minutes}m`;\n}\nexport function formatDate(time) {\n  return formatDateFn(time * 1000, \"dd MMM yyyy\");\n}\nexport function hasMetaMaskWalletExtension() {\n  return window.ethereum;\n}\nexport function hasCoinBaseWalletExtension() {\n  const {\n    ethereum\n  } = window;\n\n  if (!(ethereum !== null && ethereum !== void 0 && ethereum.providers) && !(ethereum !== null && ethereum !== void 0 && ethereum.isCoinbaseWallet)) {\n    return false;\n  }\n\n  return window.ethereum.isCoinbaseWallet || ethereum.providers.find(_ref6 => {\n    let {\n      isCoinbaseWallet\n    } = _ref6;\n    return isCoinbaseWallet;\n  });\n}\nexport function activateInjectedProvider(providerName) {\n  const {\n    ethereum\n  } = window;\n\n  if (!(ethereum !== null && ethereum !== void 0 && ethereum.providers) && !(ethereum !== null && ethereum !== void 0 && ethereum.isCoinbaseWallet) && !(ethereum !== null && ethereum !== void 0 && ethereum.isMetaMask)) {\n    return undefined;\n  }\n\n  let provider;\n\n  if (ethereum !== null && ethereum !== void 0 && ethereum.providers) {\n    switch (providerName) {\n      case \"CoinBase\":\n        provider = ethereum.providers.find(_ref7 => {\n          let {\n            isCoinbaseWallet\n          } = _ref7;\n          return isCoinbaseWallet;\n        });\n        break;\n\n      case \"MetaMask\":\n      default:\n        provider = ethereum.providers.find(_ref8 => {\n          let {\n            isMetaMask\n          } = _ref8;\n          return isMetaMask;\n        });\n        break;\n    }\n  }\n\n  if (provider) {\n    ethereum.setSelectedProvider(provider);\n  }\n}\nexport function getInjectedConnector() {\n  return injectedConnector;\n}\nexport function useChainId() {\n  _s3();\n\n  let {\n    chainId\n  } = useWeb3React();\n\n  if (!chainId) {\n    const chainIdFromLocalStorage = localStorage.getItem(SELECTED_NETWORK_LOCAL_STORAGE_KEY);\n\n    if (chainIdFromLocalStorage) {\n      chainId = parseInt(chainIdFromLocalStorage);\n\n      if (!chainId) {\n        // localstorage value is invalid\n        localStorage.removeItem(SELECTED_NETWORK_LOCAL_STORAGE_KEY);\n      }\n    }\n  }\n\n  if (!chainId || !supportedChainIds.includes(chainId)) {\n    chainId = DEFAULT_CHAIN_ID;\n  }\n\n  return {\n    chainId\n  };\n}\n\n_s3(useChainId, \"reA9FJLirN6bQm5X4sUUozGx1bA=\", false, function () {\n  return [useWeb3React];\n});\n\nexport function useENS(address) {\n  _s4();\n\n  const [ensName, setENSName] = useState();\n  useEffect(() => {\n    async function resolveENS() {\n      if (address) {\n        const provider = new ethers.providers.JsonRpcProvider(\"https://rpc.ankr.com/eth\");\n        const name = await provider.lookupAddress(address.toLowerCase());\n\n        if (name) {\n          setENSName(name);\n        } else {\n          setENSName();\n        }\n      }\n    }\n\n    resolveENS();\n  }, [address]);\n  return {\n    ensName\n  };\n}\n\n_s4(useENS, \"/ZBxVfc3L5Lxg6pg+Uk9XZz0sv8=\");\n\nexport function clearWalletConnectData() {\n  localStorage.removeItem(WALLET_CONNECT_LOCALSTORAGE_KEY);\n}\nexport function clearWalletLinkData() {\n  Object.entries(localStorage).map(x => x[0]).filter(x => x.startsWith(WALLET_LINK_LOCALSTORAGE_PREFIX)).map(x => localStorage.removeItem(x));\n}\nexport function useEagerConnect(setActivatingConnector) {\n  _s5();\n\n  const {\n    activate,\n    active\n  } = useWeb3React();\n  const [tried, setTried] = useState(false);\n  useEffect(() => {\n    (async function () {\n      if (Boolean(localStorage.getItem(SHOULD_EAGER_CONNECT_LOCALSTORAGE_KEY)) !== true) {\n        // only works with WalletConnect\n        clearWalletConnectData(); // force clear localStorage connection for MM/CB Wallet (Brave legacy)\n\n        clearWalletLinkData();\n        return;\n      }\n\n      let shouldTryWalletConnect = false;\n\n      try {\n        // naive validation to not trigger Wallet Connect if data is corrupted\n        const rawData = localStorage.getItem(WALLET_CONNECT_LOCALSTORAGE_KEY);\n\n        if (rawData) {\n          const data = JSON.parse(rawData);\n\n          if (data && data.connected) {\n            shouldTryWalletConnect = true;\n          }\n        }\n      } catch (ex) {\n        if (ex instanceof SyntaxError) {\n          // rawData is not a valid json\n          clearWalletConnectData();\n        }\n      }\n\n      if (shouldTryWalletConnect) {\n        try {\n          const connector = getWalletConnectConnector();\n          setActivatingConnector(connector);\n          await activate(connector, undefined, true); // in case Wallet Connect is activated no need to check injected wallet\n\n          return;\n        } catch (ex) {\n          // assume data in localstorage is corrupted and delete it to not retry on next page load\n          clearWalletConnectData();\n        }\n      }\n\n      try {\n        var _localStorage$getItem;\n\n        const connector = getInjectedConnector();\n        const currentProviderName = (_localStorage$getItem = localStorage.getItem(CURRENT_PROVIDER_LOCALSTORAGE_KEY)) !== null && _localStorage$getItem !== void 0 ? _localStorage$getItem : false;\n\n        if (currentProviderName !== false) {\n          activateInjectedProvider(currentProviderName);\n        }\n\n        const authorized = await connector.isAuthorized();\n\n        if (authorized) {\n          setActivatingConnector(connector);\n          await activate(connector, undefined, true);\n        }\n      } catch (ex) {}\n\n      setTried(true);\n    })(); // eslint-disable-next-line react-hooks/exhaustive-deps\n\n  }, []); // intentionally only running on mount (make sure it's only mounted once :))\n  // if the connection worked, wait until we get confirmation of that to flip the flag\n\n  useEffect(() => {\n    if (!tried && active) {\n      setTried(true);\n    }\n  }, [tried, active]);\n  return tried;\n}\n\n_s5(useEagerConnect, \"GLh+9ege4oFDiozdAF2n3i5tC+o=\", false, function () {\n  return [useWeb3React];\n});\n\nexport function useInactiveListener() {\n  _s6();\n\n  let suppress = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n  const injected = getInjectedConnector();\n  const {\n    active,\n    error,\n    activate\n  } = useWeb3React();\n  useEffect(() => {\n    const {\n      ethereum\n    } = window;\n\n    if (ethereum && ethereum.on && !active && !error && !suppress) {\n      const handleConnect = () => {\n        activate(injected);\n      };\n\n      const handleChainChanged = chainId => {\n        activate(injected);\n      };\n\n      const handleAccountsChanged = accounts => {\n        if (accounts.length > 0) {\n          activate(injected);\n        }\n      };\n\n      const handleNetworkChanged = networkId => {\n        activate(injected);\n      };\n\n      ethereum.on(\"connect\", handleConnect);\n      ethereum.on(\"chainChanged\", handleChainChanged);\n      ethereum.on(\"accountsChanged\", handleAccountsChanged);\n      ethereum.on(\"networkChanged\", handleNetworkChanged);\n      return () => {\n        if (ethereum.removeListener) {\n          ethereum.removeListener(\"connect\", handleConnect);\n          ethereum.removeListener(\"chainChanged\", handleChainChanged);\n          ethereum.removeListener(\"accountsChanged\", handleAccountsChanged);\n          ethereum.removeListener(\"networkChanged\", handleNetworkChanged);\n        }\n      };\n    } // eslint-disable-next-line react-hooks/exhaustive-deps\n\n  }, [active, error, suppress, activate]);\n}\n\n_s6(useInactiveListener, \"tg+LUTCYzAVRTYzC32Q8yta1BMA=\", false, function () {\n  return [useWeb3React];\n});\n\nexport function getProvider(library, chainId) {\n  let provider;\n\n  if (library) {\n    return library.getSigner();\n  }\n\n  provider = _.sample(RPC_PROVIDERS[chainId]);\n  return new ethers.providers.StaticJsonRpcProvider(provider, {\n    chainId\n  });\n}\nexport function getFallbackProvider(chainId) {\n  if (!FALLBACK_PROVIDERS[chainId]) {\n    return;\n  }\n\n  const provider = _.sample(FALLBACK_PROVIDERS[chainId]);\n\n  return new ethers.providers.StaticJsonRpcProvider(provider, {\n    chainId\n  });\n}\nexport const getContractCall = _ref9 => {\n  let {\n    provider,\n    contractInfo,\n    arg0,\n    arg1,\n    method,\n    params,\n    additionalArgs,\n    onError\n  } = _ref9;\n\n  if (ethers.utils.isAddress(arg0)) {\n    const address = arg0;\n    const contract = new ethers.Contract(address, contractInfo.abi, provider);\n\n    if (additionalArgs) {\n      return contract[method](...params.concat(additionalArgs));\n    }\n\n    return contract[method](...params);\n  }\n\n  if (!provider) {\n    return;\n  }\n\n  return provider[method](arg1, ...params);\n}; // prettier-ignore\n\nexport const fetcher = (library, contractInfo, additionalArgs) => function () {\n  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n    args[_key] = arguments[_key];\n  }\n\n  // eslint-disable-next-line\n  const [id, chainId, arg0, arg1, ...params] = args;\n  const provider = getProvider(library, chainId);\n  const method = ethers.utils.isAddress(arg0) ? arg1 : arg0;\n  const contractCall = getContractCall({\n    provider,\n    contractInfo,\n    arg0,\n    arg1,\n    method,\n    params,\n    additionalArgs\n  });\n  let shouldCallFallback = true;\n\n  const handleFallback = async (resolve, reject, error) => {\n    if (!shouldCallFallback) {\n      return;\n    } // prevent fallback from being called twice\n\n\n    shouldCallFallback = false;\n    const fallbackProvider = getFallbackProvider(chainId);\n\n    if (!fallbackProvider) {\n      reject(error);\n      return;\n    }\n\n    console.info(\"using fallbackProvider for\", method);\n    const fallbackContractCall = getContractCall({\n      provider: fallbackProvider,\n      contractInfo,\n      arg0,\n      arg1,\n      method,\n      params,\n      additionalArgs\n    });\n    fallbackContractCall.then(result => resolve(result)).catch(e => {\n      console.error(\"fallback fetcher error\", id, contractInfo.contractName, method, e);\n      reject(e);\n    });\n  };\n\n  return new Promise(async (resolve, reject) => {\n    contractCall.then(result => {\n      shouldCallFallback = false;\n      resolve(result);\n    }).catch(e => {\n      console.error(\"fetcher error\", id, contractInfo.contractName, method, e);\n      handleFallback(resolve, reject, e);\n    });\n    setTimeout(() => {\n      handleFallback(resolve, reject, \"contractCall timeout\");\n    }, 2000);\n  });\n};\nexport function bigNumberify(n) {\n  return ethers.BigNumber.from(n);\n}\nexport function expandDecimals(n, decimals) {\n  return bigNumberify(n).mul(bigNumberify(10).pow(decimals));\n}\nexport const trimZeroDecimals = amount => {\n  if (parseFloat(amount) === parseInt(amount)) {\n    return parseInt(amount).toString();\n  }\n\n  return amount;\n};\nexport const limitDecimals = (amount, maxDecimals) => {\n  let amountStr = amount.toString();\n\n  if (maxDecimals === undefined) {\n    return amountStr;\n  }\n\n  if (maxDecimals === 0) {\n    return amountStr.split(\".\")[0];\n  }\n\n  const dotIndex = amountStr.indexOf(\".\");\n\n  if (dotIndex !== -1) {\n    let decimals = amountStr.length - dotIndex - 1;\n\n    if (decimals > maxDecimals) {\n      amountStr = amountStr.substr(0, amountStr.length - (decimals - maxDecimals));\n    }\n  }\n\n  return amountStr;\n};\nexport const padDecimals = (amount, minDecimals) => {\n  let amountStr = amount.toString();\n  const dotIndex = amountStr.indexOf(\".\");\n\n  if (dotIndex !== -1) {\n    const decimals = amountStr.length - dotIndex - 1;\n\n    if (decimals < minDecimals) {\n      amountStr = amountStr.padEnd(amountStr.length + (minDecimals - decimals), \"0\");\n    }\n  } else {\n    amountStr = amountStr + Number(0).toFixed(minDecimals).slice(1);\n  }\n\n  return amountStr;\n};\nexport const formatKeyAmount = (map, key, tokenDecimals, displayDecimals, useCommas) => {\n  if (!map || !map[key]) {\n    return \"...\";\n  }\n\n  return formatAmount(map[key], tokenDecimals, displayDecimals, useCommas);\n};\nexport const formatArrayAmount = (arr, index, tokenDecimals, displayDecimals, useCommas) => {\n  if (!arr || !arr[index]) {\n    return \"...\";\n  }\n\n  return formatAmount(arr[index], tokenDecimals, displayDecimals, useCommas);\n};\n\nfunction _parseOrdersData(ordersData, account, indexes, extractor, uintPropsLength, addressPropsLength) {\n  if (!ordersData || ordersData.length === 0) {\n    return [];\n  }\n\n  const [uintProps, addressProps] = ordersData;\n  const count = uintProps.length / uintPropsLength;\n  const orders = [];\n\n  for (let i = 0; i < count; i++) {\n    const sliced = addressProps.slice(addressPropsLength * i, addressPropsLength * (i + 1)).concat(uintProps.slice(uintPropsLength * i, uintPropsLength * (i + 1)));\n\n    if (sliced[0] === AddressZero && sliced[1] === AddressZero) {\n      continue;\n    }\n\n    const order = extractor(sliced);\n    order.index = indexes[i];\n    order.account = account;\n    orders.push(order);\n  }\n\n  return orders;\n}\n\nfunction parseDecreaseOrdersData(chainId, decreaseOrdersData, account, indexes) {\n  const extractor = sliced => {\n    const isLong = sliced[4].toString() === \"1\";\n    return {\n      collateralToken: sliced[0],\n      indexToken: sliced[1],\n      collateralDelta: sliced[2],\n      sizeDelta: sliced[3],\n      isLong,\n      triggerPrice: sliced[5],\n      triggerAboveThreshold: sliced[6].toString() === \"1\",\n      type: DECREASE\n    };\n  };\n\n  return _parseOrdersData(decreaseOrdersData, account, indexes, extractor, 5, 2).filter(order => {\n    return isValidToken(chainId, order.collateralToken) && isValidToken(chainId, order.indexToken);\n  });\n}\n\nfunction parseIncreaseOrdersData(chainId, increaseOrdersData, account, indexes) {\n  const extractor = sliced => {\n    const isLong = sliced[5].toString() === \"1\";\n    return {\n      purchaseToken: sliced[0],\n      collateralToken: sliced[1],\n      indexToken: sliced[2],\n      purchaseTokenAmount: sliced[3],\n      sizeDelta: sliced[4],\n      isLong,\n      triggerPrice: sliced[6],\n      triggerAboveThreshold: sliced[7].toString() === \"1\",\n      type: INCREASE\n    };\n  };\n\n  return _parseOrdersData(increaseOrdersData, account, indexes, extractor, 5, 3).filter(order => {\n    return isValidToken(chainId, order.purchaseToken) && isValidToken(chainId, order.collateralToken) && isValidToken(chainId, order.indexToken);\n  });\n}\n\nfunction parseSwapOrdersData(chainId, swapOrdersData, account, indexes) {\n  if (!swapOrdersData || !swapOrdersData.length) {\n    return [];\n  }\n\n  const extractor = sliced => {\n    const triggerAboveThreshold = sliced[6].toString() === \"1\";\n    const shouldUnwrap = sliced[7].toString() === \"1\";\n    return {\n      path: [sliced[0], sliced[1], sliced[2]].filter(address => address !== AddressZero),\n      amountIn: sliced[3],\n      minOut: sliced[4],\n      triggerRatio: sliced[5],\n      triggerAboveThreshold,\n      type: SWAP,\n      shouldUnwrap\n    };\n  };\n\n  return _parseOrdersData(swapOrdersData, account, indexes, extractor, 5, 3).filter(order => {\n    return order.path.every(token => isValidToken(chainId, token));\n  });\n}\n\nexport function getOrderKey(order) {\n  return `${order.type}-${order.account}-${order.index}`;\n}\nexport function useAccountOrders(flagOrdersEnabled, overrideAccount) {\n  _s7();\n\n  const {\n    library,\n    account: connectedAccount\n  } = useWeb3React();\n  const active = true; // this is used in Actions.js so set active to always be true\n\n  const account = overrideAccount || connectedAccount;\n  const {\n    chainId\n  } = useChainId();\n  const shouldRequest = active && account && flagOrdersEnabled;\n  const orderBookAddress = getContract(chainId, \"OrderBook\");\n  const orderBookReaderAddress = getContract(chainId, \"OrderBookReader\");\n  const key = shouldRequest ? [active, chainId, orderBookAddress, account] : false;\n  const {\n    data: orders = [],\n    mutate: updateOrders,\n    error: ordersError\n  } = useSWR(key, {\n    dedupingInterval: 5000,\n    fetcher: async (active, chainId, orderBookAddress, account) => {\n      const provider = getProvider(library, chainId);\n      const orderBookContract = new ethers.Contract(orderBookAddress, OrderBook.abi, provider);\n      const orderBookReaderContract = new ethers.Contract(orderBookReaderAddress, OrderBookReader.abi, provider);\n\n      const fetchLastIndex = async type => {\n        const method = type.toLowerCase() + \"OrdersIndex\";\n        return await orderBookContract[method](account).then(res => bigNumberify(res._hex).toNumber());\n      };\n\n      const fetchLastIndexes = async () => {\n        const [swap, increase, decrease] = await Promise.all([fetchLastIndex(\"swap\"), fetchLastIndex(\"increase\"), fetchLastIndex(\"decrease\")]);\n        return {\n          swap,\n          increase,\n          decrease\n        };\n      };\n\n      const getRange = (to, from) => {\n        const LIMIT = 10;\n        const _indexes = [];\n        from = from || Math.max(to - LIMIT, 0);\n\n        for (let i = to - 1; i >= from; i--) {\n          _indexes.push(i);\n        }\n\n        return _indexes;\n      };\n\n      const getIndexes = (knownIndexes, lastIndex) => {\n        if (knownIndexes.length === 0) {\n          return getRange(lastIndex);\n        }\n\n        return [...knownIndexes, ...getRange(lastIndex, knownIndexes[knownIndexes.length - 1] + 1).sort((a, b) => b - a)];\n      };\n\n      const getOrders = async (method, knownIndexes, lastIndex, parseFunc) => {\n        const indexes = getIndexes(knownIndexes, lastIndex);\n        const ordersData = await orderBookReaderContract[method](orderBookAddress, account, indexes);\n        const orders = parseFunc(chainId, ordersData, account, indexes);\n        return orders;\n      };\n\n      try {\n        const lastIndexes = await fetchLastIndexes();\n        const serverIndexes = {\n          swap: [],\n          increase: [],\n          decrease: []\n        };\n        const [swapOrders = [], increaseOrders = [], decreaseOrders = []] = await Promise.all([getOrders(\"getSwapOrders\", serverIndexes.swap, lastIndexes.swap, parseSwapOrdersData), getOrders(\"getIncreaseOrders\", serverIndexes.increase, lastIndexes.increase, parseIncreaseOrdersData), getOrders(\"getDecreaseOrders\", serverIndexes.decrease, lastIndexes.decrease, parseDecreaseOrdersData)]);\n        return [...swapOrders, ...increaseOrders, ...decreaseOrders];\n      } catch (ex) {\n        console.error(ex);\n      }\n    }\n  });\n  return [orders, updateOrders, ordersError];\n}\n\n_s7(useAccountOrders, \"Iuam21Xwr+IWaAcV9pZsEiYdXBM=\", false, function () {\n  return [useWeb3React, useChainId, useSWR];\n});\n\nexport const formatAmount = (amount, tokenDecimals, displayDecimals, useCommas, defaultValue) => {\n  if (!defaultValue) {\n    defaultValue = \"...\";\n  }\n\n  if (amount === undefined || amount.toString().length === 0) {\n    return defaultValue;\n  }\n\n  if (displayDecimals === undefined) {\n    displayDecimals = 4;\n  }\n\n  let amountStr = ethers.utils.formatUnits(amount, tokenDecimals);\n  amountStr = limitDecimals(amountStr, displayDecimals);\n\n  if (displayDecimals !== 0) {\n    amountStr = padDecimals(amountStr, displayDecimals);\n  }\n\n  if (useCommas) {\n    return numberWithCommas(amountStr);\n  }\n\n  return amountStr;\n};\nexport const formatAmountFree = (amount, tokenDecimals, displayDecimals) => {\n  if (!amount) {\n    return \"...\";\n  }\n\n  let amountStr = ethers.utils.formatUnits(amount, tokenDecimals);\n  amountStr = limitDecimals(amountStr, displayDecimals);\n  return trimZeroDecimals(amountStr);\n};\nexport const parseValue = (value, tokenDecimals) => {\n  const pValue = parseFloat(value);\n\n  if (isNaN(pValue)) {\n    return undefined;\n  }\n\n  value = limitDecimals(value, tokenDecimals);\n  const amount = ethers.utils.parseUnits(value, tokenDecimals);\n  return bigNumberify(amount);\n};\nexport function numberWithCommas(x) {\n  if (!x) {\n    return \"...\";\n  }\n\n  var parts = x.toString().split(\".\");\n  parts[0] = parts[0].replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\n  return parts.join(\".\");\n}\nexport function getExplorerUrl(chainId) {\n  if (chainId === 3) {\n    return \"https://ropsten.etherscan.io/\";\n  } else if (chainId === 42) {\n    return \"https://kovan.etherscan.io/\";\n  } else if (chainId === ARBITRUM_GOERLI) {\n    return \"https://goerli-rollup-explorer.arbitrum.io/\";\n  } else if (chainId === ARBITRUM) {\n    return \"https://arbiscan.io/\";\n  }\n\n  return \"https://etherscan.io/\";\n}\nexport function getAccountUrl(chainId, account) {\n  if (!account) {\n    return getExplorerUrl(chainId);\n  }\n\n  return getExplorerUrl(chainId) + \"address/\" + account;\n}\nexport function getTokenUrl(chainId, address) {\n  if (!address) {\n    return getExplorerUrl(chainId);\n  }\n\n  return getExplorerUrl(chainId) + \"token/\" + address;\n}\nexport function usePrevious(value) {\n  _s8();\n\n  const ref = useRef();\n  useEffect(() => {\n    ref.current = value;\n  });\n  return ref.current;\n}\n\n_s8(usePrevious, \"8uVE59eA/r6b92xF80p7sH8rXLk=\");\n\nexport async function setGasPrice(txnOpts, provider, chainId) {\n  let maxGasPrice = MAX_GAS_PRICE_MAP[chainId];\n  const premium = GAS_PRICE_ADJUSTMENT_MAP[chainId] || bigNumberify(0);\n\n  if (maxGasPrice) {\n    const gasPrice = await provider.getGasPrice();\n\n    if (gasPrice.gt(maxGasPrice)) {\n      maxGasPrice = gasPrice;\n    }\n\n    const feeData = await provider.getFeeData();\n    txnOpts.maxFeePerGas = maxGasPrice;\n    txnOpts.maxPriorityFeePerGas = feeData.maxPriorityFeePerGas.add(premium);\n  } else {\n    const gasPrice = await provider.getGasPrice();\n    txnOpts.gasPrice = gasPrice.add(premium);\n  }\n}\nexport async function getGasLimit(contract, method) {\n  let params = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];\n  let value = arguments.length > 3 ? arguments[3] : undefined;\n  let gasBuffer = arguments.length > 4 ? arguments[4] : undefined;\n  const defaultGasBuffer = 300000;\n  const defaultValue = bigNumberify(0);\n\n  if (!value) {\n    value = defaultValue;\n  }\n\n  let gasLimit = await contract.estimateGas[method](...params, {\n    value\n  });\n\n  if (!gasBuffer) {\n    gasBuffer = defaultGasBuffer;\n  }\n\n  return gasLimit.add(gasBuffer);\n}\nexport function approveTokens(_ref10) {\n  let {\n    setIsApproving,\n    library,\n    tokenAddress,\n    spender,\n    chainId,\n    onApproveSubmitted,\n    getTokenInfo,\n    infoTokens,\n    pendingTxns,\n    setPendingTxns,\n    includeMessage\n  } = _ref10;\n  setIsApproving(true);\n  const contract = new ethers.Contract(tokenAddress, Token.abi, library.getSigner());\n  contract.approve(spender, ethers.constants.MaxUint256).then(async res => {\n    const txUrl = getExplorerUrl(chainId) + \"tx/\" + res.hash;\n    helperToast.success( /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [\"Approval submitted!\", \" \", /*#__PURE__*/_jsxDEV(\"a\", {\n        href: txUrl,\n        target: \"_blank\",\n        rel: \"noopener noreferrer\",\n        children: \"View status.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 2077,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 2080,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 2075,\n      columnNumber: 9\n    }, this));\n\n    if (onApproveSubmitted) {\n      onApproveSubmitted();\n    }\n\n    if (getTokenInfo && infoTokens && pendingTxns && setPendingTxns) {\n      const token = getTokenInfo(infoTokens, tokenAddress);\n      const pendingTxn = {\n        hash: res.hash,\n        message: includeMessage ? `${token.symbol} Approved!` : false\n      };\n      setPendingTxns([...pendingTxns, pendingTxn]);\n    }\n  }).catch(e => {\n    var _e$data, _e$message;\n\n    console.error(e);\n    let failMsg;\n\n    if ([\"not enough funds for gas\", \"failed to execute call with revert code InsufficientGasFunds\"].includes((_e$data = e.data) === null || _e$data === void 0 ? void 0 : _e$data.message)) {\n      failMsg = /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [\"There is not enough ETH in your account on Arbitrum to send this transaction.\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 2106,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 2107,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n          href: \"https://arbitrum.io/bridge-tutorial/\",\n          target: \"_blank\",\n          rel: \"noopener noreferrer\",\n          children: \"Bridge ETH to Arbitrum\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 2108,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 2104,\n        columnNumber: 11\n      }, this);\n    } else if ((_e$message = e.message) !== null && _e$message !== void 0 && _e$message.includes(\"User denied transaction signature\")) {\n      failMsg = \"Approval was cancelled.\";\n    } else {\n      failMsg = \"Approval failed.\";\n    }\n\n    helperToast.error(failMsg);\n  }).finally(() => {\n    setIsApproving(false);\n  });\n}\nexport const shouldRaiseGasError = (token, amount) => {\n  if (!amount) {\n    return false;\n  }\n\n  if (token.address !== AddressZero) {\n    return false;\n  }\n\n  if (!token.balance) {\n    return false;\n  }\n\n  if (amount.gte(token.balance)) {\n    return true;\n  }\n\n  if (token.balance.sub(amount).lt(DUST_BNB)) {\n    return true;\n  }\n\n  return false;\n};\nexport const getTokenInfo = (infoTokens, tokenAddress, replaceNative, nativeTokenAddress) => {\n  if (replaceNative && tokenAddress === nativeTokenAddress) {\n    return infoTokens[AddressZero];\n  }\n\n  return infoTokens[tokenAddress];\n};\nconst NETWORK_METADATA = {\n  [ARBITRUM_GOERLI]: {\n    chainId: \"0x\" + ARBITRUM_GOERLI.toString(16),\n    chainName: \"Arbitrum Goerli\",\n    nativeCurrency: {\n      name: \"ETH\",\n      symbol: \"ETH\",\n      decimals: 18\n    },\n    rpcUrls: ARBITRUM_GOERLI_RPC_PROVIDERS,\n    blockExplorerUrls: [getExplorerUrl(ARBITRUM_GOERLI)]\n  },\n  [ARBITRUM]: {\n    chainId: \"0x\" + ARBITRUM.toString(16),\n    chainName: \"Arbitrum\",\n    nativeCurrency: {\n      name: \"ETH\",\n      symbol: \"ETH\",\n      decimals: 18\n    },\n    rpcUrls: ARBITRUM_RPC_PROVIDERS,\n    blockExplorerUrls: [getExplorerUrl(ARBITRUM)]\n  }\n};\nexport const addNetwork = async metadata => {\n  await window.ethereum.request({\n    method: \"wallet_addEthereumChain\",\n    params: [metadata]\n  }).catch();\n};\nexport const switchNetwork = async (chainId, active) => {\n  if (!active) {\n    // chainId in localStorage allows to switch network even if wallet is not connected\n    // or there is no wallet at all\n    localStorage.setItem(SELECTED_NETWORK_LOCAL_STORAGE_KEY, chainId);\n    document.location.reload();\n    return;\n  }\n\n  try {\n    const chainIdHex = \"0x\" + chainId.toString(16);\n    await window.ethereum.request({\n      method: \"wallet_switchEthereumChain\",\n      params: [{\n        chainId: chainIdHex\n      }]\n    });\n    helperToast.success(\"Connected to \" + getChainName(chainId));\n    return getChainName(chainId);\n  } catch (ex) {\n    // https://docs.metamask.io/guide/rpc-api.html#other-rpc-methods\n    // This error code indicates that the chain has not been added to MetaMask.\n    // 4001 error means user has denied the request\n    // If the error code is not 4001, then we need to add the network\n    if (ex.code !== 4001) {\n      return await addNetwork(NETWORK_METADATA[chainId]);\n    }\n\n    console.error(\"error\", ex);\n  }\n};\nexport const getWalletConnectHandler = (activate, deactivate, setActivatingConnector) => {\n  const fn = async () => {\n    const walletConnect = getWalletConnectConnector();\n    setActivatingConnector(walletConnect);\n    activate(walletConnect, ex => {\n      if (ex instanceof UnsupportedChainIdError) {\n        helperToast.error(\"Unsupported chain. Switch to Arbitrum network on your wallet and try again\");\n        console.warn(ex);\n      } else if (!(ex instanceof UserRejectedRequestErrorWalletConnect)) {\n        helperToast.error(ex.message);\n        console.warn(ex);\n      }\n\n      clearWalletConnectData();\n      deactivate();\n    });\n  };\n\n  return fn;\n};\nexport const getInjectedHandler = activate => {\n  const fn = async () => {\n    activate(getInjectedConnector(), e => {\n      var _e$message2;\n\n      const chainId = localStorage.getItem(SELECTED_NETWORK_LOCAL_STORAGE_KEY) || DEFAULT_CHAIN_ID;\n\n      if (e instanceof UnsupportedChainIdError) {\n        helperToast.error( /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [\"Your wallet is not connected to \", getChainName(chainId), \".\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 2237,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 2238,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"clickable underline margin-bottom\",\n            onClick: () => switchNetwork(chainId, true),\n            children: [\"Switch to \", getChainName(chainId)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 2239,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"clickable underline\",\n            onClick: () => switchNetwork(chainId, true),\n            children: [\"Add \", getChainName(chainId)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 2242,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 2236,\n          columnNumber: 11\n        }, this));\n        return;\n      }\n\n      const errString = (_e$message2 = e.message) !== null && _e$message2 !== void 0 ? _e$message2 : e.toString();\n      helperToast.error(errString);\n    });\n  };\n\n  return fn;\n};\nexport function isMobileDevice(navigator) {\n  return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\n}\nexport function setTokenUsingIndexPrices(token, indexPrices, nativeTokenAddress) {\n  if (!indexPrices) {\n    return;\n  }\n\n  const tokenAddress = token.isNative ? nativeTokenAddress : token.address;\n  const indexPrice = indexPrices[tokenAddress];\n\n  if (!indexPrice) {\n    return;\n  }\n\n  const indexPriceBn = bigNumberify(indexPrice);\n\n  if (indexPriceBn.eq(0)) {\n    return;\n  }\n\n  const spread = token.maxPrice.sub(token.minPrice);\n  const spreadBps = spread.mul(BASIS_POINTS_DIVISOR).div(token.maxPrice);\n\n  if (spreadBps.gt(MAX_PRICE_DEVIATION_BASIS_POINTS - 1)) {\n    // only set of the values as there will be a spread between the index price and the Chainlink price\n    if (indexPriceBn.gt(token.minPrimaryPrice)) {\n      token.maxPrice = indexPriceBn;\n    } else {\n      token.minPrice = indexPriceBn;\n    }\n\n    return;\n  }\n\n  const halfSpreadBps = spreadBps.div(2).toNumber();\n  token.maxPrice = indexPriceBn.mul(BASIS_POINTS_DIVISOR + halfSpreadBps).div(BASIS_POINTS_DIVISOR);\n  token.minPrice = indexPriceBn.mul(BASIS_POINTS_DIVISOR - halfSpreadBps).div(BASIS_POINTS_DIVISOR);\n}\nexport const CHART_PERIODS = {\n  \"5m\": 60 * 5,\n  \"15m\": 60 * 15,\n  \"1h\": 60 * 60,\n  \"4h\": 60 * 60 * 4,\n  \"1d\": 60 * 60 * 24\n};\nexport function getTotalVolumeSum(volumes) {\n  if (!volumes || volumes.length === 0) {\n    return;\n  }\n\n  let volume = bigNumberify(0);\n\n  for (let i = 0; i < volumes.length; i++) {\n    volume = volume.add(volumes[i].data.volume);\n  }\n\n  return volume;\n}\nexport function getBalanceAndSupplyData(balances) {\n  if (!balances || balances.length === 0) {\n    return {};\n  }\n\n  const keys = [\"myc\", \"esMyc\", \"mlp\", \"stakedMycTracker\"];\n  const balanceData = {};\n  const supplyData = {};\n  const propsLength = 2;\n\n  for (let i = 0; i < keys.length; i++) {\n    const key = keys[i];\n    balanceData[key] = balances[i * propsLength];\n    supplyData[key] = balances[i * propsLength + 1];\n  }\n\n  return {\n    balanceData,\n    supplyData\n  };\n}\nexport function getDepositBalanceData(depositBalances) {\n  if (!depositBalances || depositBalances.length === 0) {\n    return;\n  }\n\n  const keys = [\"mycInStakedMyc\", \"esMycInStakedMyc\", \"stakedMycInBonusMyc\", \"bonusMycInFeeMyc\", \"bnMycInFeeMyc\", \"mlpInStakedMlp\"];\n  const data = {};\n\n  for (let i = 0; i < keys.length; i++) {\n    const key = keys[i];\n    data[key] = depositBalances[i];\n  }\n\n  return data;\n}\nexport function getVestingData(vestingInfo) {\n  if (!vestingInfo || vestingInfo.length === 0) {\n    return;\n  }\n\n  const keys = [\"mycVester\", \"mlpVester\"];\n  const data = {};\n  const propsLength = 7;\n\n  for (let i = 0; i < keys.length; i++) {\n    const key = keys[i];\n    data[key] = {\n      pairAmount: vestingInfo[i * propsLength],\n      vestedAmount: vestingInfo[i * propsLength + 1],\n      escrowedBalance: vestingInfo[i * propsLength + 2],\n      claimedAmounts: vestingInfo[i * propsLength + 3],\n      claimable: vestingInfo[i * propsLength + 4],\n      maxVestableAmount: vestingInfo[i * propsLength + 5],\n      averageStakedAmount: vestingInfo[i * propsLength + 6]\n    };\n    data[key + \"PairAmount\"] = data[key].pairAmount;\n    data[key + \"VestedAmount\"] = data[key].vestedAmount;\n    data[key + \"EscrowedBalance\"] = data[key].escrowedBalance;\n    data[key + \"ClaimSum\"] = data[key].claimedAmounts.add(data[key].claimable);\n    data[key + \"Claimable\"] = data[key].claimable;\n    data[key + \"MaxVestableAmount\"] = data[key].maxVestableAmount;\n    data[key + \"AverageStakedAmount\"] = data[key].averageStakedAmount;\n  }\n\n  return data;\n}\nexport function getStakingData(stakingInfo) {\n  if (!stakingInfo || stakingInfo.length === 0) {\n    return;\n  }\n\n  const keys = [\"stakedMycTracker\", \"bonusMycTracker\", \"feeMycTracker\", \"stakedMlpTracker\", \"feeMlpTracker\"];\n  const data = {};\n  const propsLength = 5;\n\n  for (let i = 0; i < keys.length; i++) {\n    const key = keys[i];\n    data[key] = {\n      claimable: stakingInfo[i * propsLength],\n      tokensPerInterval: stakingInfo[i * propsLength + 1],\n      averageStakedAmounts: stakingInfo[i * propsLength + 2],\n      cumulativeRewards: stakingInfo[i * propsLength + 3],\n      totalSupply: stakingInfo[i * propsLength + 4]\n    };\n  }\n\n  return data;\n}\nexport function getProcessedData(balanceData, supplyData, depositBalanceData, stakingData, vestingData, aum, nativeTokenPrice, stakedMycSupply, mycPrice, mycSupply) {\n  if (!balanceData || !supplyData || !depositBalanceData || !stakingData || !vestingData || !aum || !nativeTokenPrice || !stakedMycSupply || !mycPrice || !mycSupply) {\n    return {};\n  }\n\n  const data = {};\n  data.mycBalance = balanceData.myc;\n  data.mycBalanceUsd = balanceData.myc.mul(mycPrice).div(expandDecimals(1, 18));\n  data.mycSupply = bigNumberify(mycSupply);\n  data.mycSupplyUsd = data.mycSupply.mul(mycPrice).div(expandDecimals(1, 18));\n  data.stakedMycSupply = stakedMycSupply;\n  data.stakedMycSupplyUsd = stakedMycSupply.mul(mycPrice).div(expandDecimals(1, 18));\n  data.mycInStakedMyc = depositBalanceData.mycInStakedMyc;\n  data.mycInStakedMycUsd = depositBalanceData.mycInStakedMyc.mul(mycPrice).div(expandDecimals(1, 18));\n  data.esMycBalance = balanceData.esMyc;\n  data.esMycBalanceUsd = balanceData.esMyc.mul(mycPrice).div(expandDecimals(1, 18));\n  data.stakedMycTrackerSupply = supplyData.stakedMycTracker;\n  data.stakedMycTrackerSupplyUsd = supplyData.stakedMycTracker.mul(mycPrice).div(expandDecimals(1, 18));\n  data.stakedEsMycSupply = data.stakedMycTrackerSupply.sub(data.stakedMycSupply);\n  data.stakedEsMycSupplyUsd = data.stakedEsMycSupply.mul(mycPrice).div(expandDecimals(1, 18));\n  data.esMycInStakedMyc = depositBalanceData.esMycInStakedMyc;\n  data.esMycInStakedMycUsd = depositBalanceData.esMycInStakedMyc.mul(mycPrice).div(expandDecimals(1, 18));\n  data.bnMycInFeeMyc = depositBalanceData.bnMycInFeeMyc;\n  data.bonusMycInFeeMyc = depositBalanceData.bonusMycInFeeMyc;\n  data.feeMycSupply = stakingData.feeMycTracker.totalSupply;\n  data.feeMycSupplyUsd = data.feeMycSupply.mul(mycPrice).div(expandDecimals(1, 18));\n  data.stakedMycTrackerRewards = stakingData.stakedMycTracker.claimable;\n  data.stakedMycTrackerRewardsUsd = stakingData.stakedMycTracker.claimable.mul(mycPrice).div(expandDecimals(1, 18));\n  data.bonusMycTrackerRewards = stakingData.bonusMycTracker.claimable;\n  data.feeMycTrackerRewards = stakingData.feeMycTracker.claimable;\n  data.feeMycTrackerRewardsUsd = stakingData.feeMycTracker.claimable.mul(nativeTokenPrice).div(expandDecimals(1, 18));\n  data.boostBasisPoints = bigNumberify(0);\n\n  if (data && data.bnMycInFeeMyc && data.bonusMycInFeeMyc && data.bonusMycInFeeMyc.gt(0)) {\n    data.boostBasisPoints = data.bnMycInFeeMyc.mul(BASIS_POINTS_DIVISOR).div(data.bonusMycInFeeMyc);\n  }\n\n  data.stakedMycTrackerAnnualRewardsUsd = stakingData.stakedMycTracker.tokensPerInterval.mul(SECONDS_PER_YEAR).mul(mycPrice).div(expandDecimals(1, 18));\n  data.mycAprForEsMyc = data.stakedMycTrackerSupplyUsd && data.stakedMycTrackerSupplyUsd.gt(0) ? data.stakedMycTrackerAnnualRewardsUsd.mul(BASIS_POINTS_DIVISOR).div(data.stakedMycTrackerSupplyUsd) : bigNumberify(0);\n  data.feeMycTrackerAnnualRewardsUsd = stakingData.feeMycTracker.tokensPerInterval.mul(SECONDS_PER_YEAR).mul(nativeTokenPrice).div(expandDecimals(1, 18));\n  data.mycAprForNativeToken = data.feeMycSupplyUsd && data.feeMycSupplyUsd.gt(0) ? data.feeMycTrackerAnnualRewardsUsd.mul(BASIS_POINTS_DIVISOR).div(data.feeMycSupplyUsd) : bigNumberify(0);\n  data.mycBoostAprForNativeToken = data.mycAprForNativeToken.mul(data.boostBasisPoints).div(BASIS_POINTS_DIVISOR);\n  data.mycAprTotal = data.mycAprForNativeToken.add(data.mycAprForEsMyc);\n  data.mycAprTotalWithBoost = data.mycAprForNativeToken.add(data.mycBoostAprForNativeToken).add(data.mycAprForEsMyc);\n  data.mycAprForNativeTokenWithBoost = data.mycAprForNativeToken.add(data.mycBoostAprForNativeToken);\n  data.totalMycRewardsUsd = data.stakedMycTrackerRewardsUsd.add(data.feeMycTrackerRewardsUsd);\n  data.mlpSupply = supplyData.mlp;\n  data.mlpPrice = data.mlpSupply && data.mlpSupply.gt(0) ? aum.mul(expandDecimals(1, MLP_DECIMALS)).div(data.mlpSupply) : bigNumberify(0);\n  data.mlpSupplyUsd = supplyData.mlp.mul(data.mlpPrice).div(expandDecimals(1, 18));\n  data.mlpBalance = depositBalanceData.mlpInStakedMlp;\n  data.mlpBalanceUsd = depositBalanceData.mlpInStakedMlp.mul(data.mlpPrice).div(expandDecimals(1, MLP_DECIMALS));\n  data.stakedMlpTrackerRewards = stakingData.stakedMlpTracker.claimable;\n  data.stakedMlpTrackerRewardsUsd = stakingData.stakedMlpTracker.claimable.mul(mycPrice).div(expandDecimals(1, 18));\n  data.feeMlpTrackerRewards = stakingData.feeMlpTracker.claimable;\n  data.feeMlpTrackerRewardsUsd = stakingData.feeMlpTracker.claimable.mul(nativeTokenPrice).div(expandDecimals(1, 18));\n  data.stakedMlpTrackerAnnualRewardsUsd = stakingData.stakedMlpTracker.tokensPerInterval.mul(SECONDS_PER_YEAR).mul(mycPrice).div(expandDecimals(1, 18));\n  data.mlpAprForEsMyc = data.mlpSupplyUsd && data.mlpSupplyUsd.gt(0) ? data.stakedMlpTrackerAnnualRewardsUsd.mul(BASIS_POINTS_DIVISOR).div(data.mlpSupplyUsd) : bigNumberify(0);\n  data.feeMlpTrackerAnnualRewardsUsd = stakingData.feeMlpTracker.tokensPerInterval.mul(SECONDS_PER_YEAR).mul(nativeTokenPrice).div(expandDecimals(1, 18));\n  data.mlpAprForNativeToken = data.mlpSupplyUsd && data.mlpSupplyUsd.gt(0) ? data.feeMlpTrackerAnnualRewardsUsd.mul(BASIS_POINTS_DIVISOR).div(data.mlpSupplyUsd) : bigNumberify(0);\n  data.mlpAprTotal = data.mlpAprForNativeToken.add(data.mlpAprForEsMyc);\n  data.totalMlpRewardsUsd = data.stakedMlpTrackerRewardsUsd.add(data.feeMlpTrackerRewardsUsd);\n  data.totalEsMycRewards = data.stakedMycTrackerRewards.add(data.stakedMlpTrackerRewards);\n  data.totalEsMycRewardsUsd = data.stakedMycTrackerRewardsUsd.add(data.stakedMlpTrackerRewardsUsd);\n  data.mycVesterRewards = vestingData.mycVester.claimable;\n  data.mlpVesterRewards = vestingData.mlpVester.claimable;\n  data.mlpVesterRewardsUsd = vestingData.mlpVester.claimable.mul(mycPrice).div(expandDecimals(1, 18));\n  data.totalVesterRewards = data.mycVesterRewards.add(data.mlpVesterRewards);\n  data.totalVesterRewardsUsd = data.totalVesterRewards.mul(mycPrice).div(expandDecimals(1, 18));\n  data.mlpVesterVestedAmountUsd = vestingData.mlpVesterVestedAmount.mul(mycPrice).div(expandDecimals(1, 18));\n  data.totalNativeTokenRewards = data.feeMycTrackerRewards.add(data.feeMlpTrackerRewards);\n  data.totalNativeTokenRewardsUsd = data.feeMycTrackerRewardsUsd.add(data.feeMlpTrackerRewardsUsd);\n  data.totalRewardsUsd = data.totalEsMycRewardsUsd.add(data.totalNativeTokenRewardsUsd).add(data.totalVesterRewardsUsd);\n  return data;\n}\nexport async function addTokenToMetamask(token) {\n  try {\n    const wasAdded = await window.ethereum.request({\n      method: \"wallet_watchAsset\",\n      params: {\n        type: \"ERC20\",\n        options: {\n          address: token.address,\n          symbol: token.symbol,\n          decimals: token.decimals,\n          image: token.imageUrl\n        }\n      }\n    });\n\n    if (wasAdded) {// https://github.com/MetaMask/metamask-extension/issues/11377\n      // We can show a toast message when the token is added to metamask but because of the bug we can't. Once the bug is fixed we can show a toast message.\n    }\n  } catch (error) {\n    console.error(error);\n  }\n}\nexport function sleep(ms) {\n  return new Promise(resolve => resolve(), ms);\n}\nexport function getPageTitle(data) {\n  return `${data} | Perpetual Swaps`;\n}\nexport function isHashZero(value) {\n  return value === ethers.constants.HashZero;\n}\nexport function isAddressZero(value) {\n  return value === ethers.constants.AddressZero;\n}\nexport function useDebounce(value, delay) {\n  _s9();\n\n  // State and setters for debounced value\n  const [debouncedValue, setDebouncedValue] = useState(value);\n  useEffect(() => {\n    // Update debounced value after delay\n    const handler = setTimeout(() => {\n      setDebouncedValue(value);\n    }, delay); // Cancel the timeout if value changes (also on delay change or unmount)\n    // This is how we prevent debounced value from updating if value is changed ...\n    // .. within the delay period. Timeout gets cleared and restarted.\n\n    return () => {\n      clearTimeout(handler);\n    };\n  }, [value, delay] // Only re-call effect if value or delay changes\n  );\n  return debouncedValue;\n}\n\n_s9(useDebounce, \"KDuPAtDOgxm8PU6legVJOb3oOmA=\");\n\nexport function hasUserConsented() {\n  const consent = localStorage.getItem(\"consentAcknowledged\");\n  return consent && consent === \"true\";\n}\nexport function formatTitleCase(string) {\n  let isLowerCase = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n  return `${string[0].toUpperCase()}${isLowerCase ? string.slice(1).toLowerCase() : string.slice(1)}`;\n}\nexport const NETWORK_NAME = {\n  [ARBITRUM]: \"Arbitrum\",\n  [ARBITRUM_GOERLI]: \"Testnet\"\n};\nexport function getSpread(fromTokenInfo, toTokenInfo, isLong, nativeTokenAddress) {\n  if (fromTokenInfo && fromTokenInfo.maxPrice && toTokenInfo && toTokenInfo.minPrice) {\n    const fromDiff = fromTokenInfo.maxPrice.sub(fromTokenInfo.minPrice);\n    const fromSpread = fromDiff.mul(PRECISION).div(fromTokenInfo.maxPrice);\n    const toDiff = toTokenInfo.maxPrice.sub(toTokenInfo.minPrice);\n    const toSpread = toDiff.mul(PRECISION).div(toTokenInfo.maxPrice);\n    let value = fromSpread.add(toSpread);\n    const fromTokenAddress = fromTokenInfo.isNative ? nativeTokenAddress : fromTokenInfo.address;\n    const toTokenAddress = toTokenInfo.isNative ? nativeTokenAddress : toTokenInfo.address;\n\n    if (isLong && fromTokenAddress === toTokenAddress) {\n      value = fromSpread;\n    }\n\n    return {\n      value,\n      isHigh: value.gt(HIGH_SPREAD_THRESHOLD)\n    };\n  }\n}\nexport function getUserTokenBalances(infoTokens) {\n  let userBalances = {};\n  let tokenPrices = {};\n  let poolBalances = {};\n  Object.keys(infoTokens).forEach(token => {\n    if (infoTokens[token]) {\n      const tokenName = formatTitleCase(infoTokens[token].symbol, true);\n      const balanceFieldName = `balance${tokenName}`;\n      const priceFieldName = `price${tokenName}`;\n      const poolBalanceFieldName = `poolBalance${tokenName}`;\n      userBalances[balanceFieldName] = parseFloat(formatAmount(infoTokens[token].balance, infoTokens[token].decimals, infoTokens[token].decimals, false));\n      tokenPrices[priceFieldName] = parseFloat(formatAmount(infoTokens[token].maxPrice, USD_DECIMALS, 2, false));\n      poolBalances[poolBalanceFieldName] = parseFloat(formatAmount(infoTokens[token].poolAmount, infoTokens[token].decimals, 2, false));\n    }\n  });\n  return [userBalances, tokenPrices, poolBalances];\n}\nexport function saveAccountToLocalStorage(address) {\n  const prevIdentifiedAccounts = window.localStorage.getItem(\"identifiedAddresses\");\n\n  if (!prevIdentifiedAccounts) {\n    // Create new localStorage variable to store imported accounts\n    localStorage.setItem(\"identifiedAddresses\", JSON.stringify([address]));\n  } else {\n    const parsedAccounts = JSON.parse(prevIdentifiedAccounts);\n\n    if (!parsedAccounts.includes(address)) {\n      parsedAccounts.push(address);\n    }\n\n    localStorage.setItem(\"identifiedAddresses\", JSON.stringify(parsedAccounts));\n  }\n}\nexport function getPreviousAccounts() {\n  const prevIdentifiedAccounts = window.localStorage.getItem(\"identifiedAddresses\");\n\n  if (prevIdentifiedAccounts) {\n    return JSON.parse(prevIdentifiedAccounts);\n  } else {\n    return [];\n  }\n}\nexport function setCurrentAccount(account) {\n  window.localStorage.setItem(\"walletAddress\", account);\n}\nexport function hasBeenIdentified(account) {\n  const prevIdentifiedAccounts = window.localStorage.getItem(\"identifiedAddresses\");\n  const formattedAddresses = JSON.parse(prevIdentifiedAccounts) || [];\n  return Boolean(formattedAddresses.includes(account));\n}\nexport function hasChangedAccount(account) {\n  const prevAccount = window.localStorage.getItem(\"walletAddress\");\n  return Boolean(prevAccount && prevAccount !== account);\n}\nexport function getUrlParameters(searchString) {\n  const queryString = searchString;\n  const urlParams = new URLSearchParams(queryString);\n  const keys = urlParams.keys();\n  const params = {};\n\n  for (const key of keys) params[key] = urlParams.get(key);\n\n  return params;\n}\nexport function getWindowFeatures() {\n  var _window6, _window7, _window8;\n\n  return {\n    screenHeight: ((_window6 = window) === null || _window6 === void 0 ? void 0 : _window6.innerHeight) || \"unknown\",\n    screenWidth: ((_window7 = window) === null || _window7 === void 0 ? void 0 : _window7.innerWidth) || \"unknown\",\n    screenDensity: ((_window8 = window) === null || _window8 === void 0 ? void 0 : _window8.devicePixelRatio) || \"unknown\"\n  };\n}\nconst defaultTruncateLength = 10;\nexport function truncateMiddleEthAddress(address, truncateLength) {\n  const strLength = truncateLength || defaultTruncateLength;\n\n  if (!isAddress(address)) {\n    console.warn(\"Calling toTruncatedMiddleEthAddress on a string not matching a valid Eth address format\");\n    return address;\n  }\n\n  if (strLength < 7) {\n    console.warn(\"Cannot truncate Eth address by desired amount. Returning original string.\");\n    return address;\n  }\n\n  const leadingCharsNum = strLength / 2 - 1;\n  const trailingCharsNum = strLength - leadingCharsNum - 3;\n  return `${address.slice(0, leadingCharsNum)}...${address.slice(-trailingCharsNum)}`;\n}\n\nvar _c;\n\n$RefreshReg$(_c, \"USDG_ADDRESS\");","map":{"version":3,"names":["React","useState","useRef","useEffect","useCallback","InjectedConnector","WalletConnectConnector","UserRejectedRequestError","UserRejectedRequestErrorWalletConnect","toast","useWeb3React","UnsupportedChainIdError","useLocalStorage","ethers","format","formatDateFn","Token","_","getContract","useSWR","OrderBookReader","OrderBook","getWhitelistedTokens","isValidToken","ComingSoonTooltip","isAddress","copyToClipboard","REFERRAL_CODE_QUERY_PARAMS","CURRENT_PROVIDER_LOCALSTORAGE_KEY","WALLET_CONNECT_LOCALSTORAGE_KEY","WALLET_LINK_LOCALSTORAGE_PREFIX","SHOULD_EAGER_CONNECT_LOCALSTORAGE_KEY","AddressZero","constants","UI_VERSION","PLACEHOLDER_ACCOUNT","Wallet","createRandom","address","ETHEREUM","ARBITRUM_GOERLI","ARBITRUM","DEFAULT_CHAIN_ID","CHAIN_ID","MIN_PROFIT_TIME","SELECTED_NETWORK_LOCAL_STORAGE_KEY","CHAIN_NAMES_MAP","GAS_PRICE_ADJUSTMENT_MAP","MAX_GAS_PRICE_MAP","alchemyWhitelistedDomains","getFallbackArbitrumRpcUrl","useWebsocket","getDefaultArbitrumRpcUrl","includes","window","location","host","getFallbackArbitrumGoerliRpcUrl","getDefaultArbitrumGoerliRpcUrl","ETHEREUM_RPC_PROVIDERS","ARBITRUM_RPC_PROVIDERS","ARBITRUM_GOERLI_RPC_PROVIDERS","getChainName","chainId","USDG_ADDRESS","MAX_LEVERAGE","MAX_PRICE_DEVIATION_BASIS_POINTS","DEFAULT_GAS_LIMIT","SECONDS_PER_YEAR","FORTNIGHTS_IN_YEAR","USDG_DECIMALS","USD_DECIMALS","BASIS_POINTS_DIVISOR","DEPOSIT_FEE","DUST_BNB","DUST_USD","expandDecimals","PRECISION","ETH_DECIMALS","MLP_DECIMALS","MYC_DECIMALS","DEFAULT_MAX_USDG_AMOUNT","TAX_BASIS_POINTS","STABLE_TAX_BASIS_POINTS","MINT_BURN_FEE_BASIS_POINTS","SWAP_FEE_BASIS_POINTS","STABLE_SWAP_FEE_BASIS_POINTS","MARGIN_FEE_BASIS_POINTS","LIQUIDATION_FEE","MLP_COOLDOWN_DURATION","THRESHOLD_REDEMPTION_VALUE","FUNDING_RATE_PRECISION","SWAP","INCREASE","DECREASE","LONG","SHORT","MARKET","LIMIT","STOP","LEVERAGE_ORDER_OPTIONS","SWAP_ORDER_OPTIONS","SWAP_OPTIONS","DEFAULT_SLIPPAGE_AMOUNT","DEFAULT_HIGHER_SLIPPAGE_AMOUNT","TRIGGER_PREFIX_ABOVE","TRIGGER_PREFIX_BELOW","MIN_PROFIT_BIPS","MLP_POOL_COLORS","ETH","BTC","USDC","PPUSD","USDT","MIM","FRAX","DAI","UNI","LINK","CTM","FXS","BAL","CRV","TEST","HIGH_SPREAD_THRESHOLD","div","ICONLINKS","TCR","coingecko","arbitrum","MLP","MYC","platformTokens","name","symbol","decimals","imageUrl","origin","networkOptions","label","value","icon","color","supportedChainIds","injectedConnector","getWalletConnectConnector","localStorage","getItem","rpc","qrcode","isSupportedChain","deserialize","data","key","Object","entries","_type","bigNumberify","helperToast","success","content","error","useLocalStorageByChainId","defaultValue","internalValue","setInternalValue","setValue","newInternalValue","useLocalStorageSerializeKey","opts","JSON","stringify","getTriggerPrice","tokenAddress","max","info","orderOption","triggerPriceUsd","maxPrice","minPrice","getLiquidationPriceFromDelta","liquidationAmount","size","collateral","averagePrice","isLong","eq","gt","liquidationDelta","sub","priceDelta","mul","add","replaceNativeTokenAddress","path","nativeTokenAddress","updatedPath","i","length","push","getMarginFee","sizeDelta","afterFeeUsd","isTriggerRatioInverted","fromTokenInfo","toTokenInfo","isStable","isUsdg","lt","getExchangeRate","tokenAInfo","tokenBInfo","inverted","getMostAbundantStableToken","infoTokens","whitelistedTokens","availableAmount","stableToken","find","t","getTokenInfo","adjustedAvailableAmount","adjustForDecimals","shouldInvertTriggerRatio","tokenA","tokenB","getExchangeRateDisplay","rate","rateValue","formatAmount","omitSymbols","adjustForDecimalsFactory","n","number","amount","divDecimals","mulDecimals","getTargetUsdgAmount","token","usdgSupply","totalTokenWeights","weight","getFeeBasisPoints","usdgDelta","feeBasisPoints","taxBasisPoints","increment","usdgAmount","initialAmount","nextAmount","targetAmount","toNumber","initialDiff","nextDiff","rebateBps","averageDiff","taxBps","getBuyMlpToAmount","fromAmount","swapTokenAddress","mlpPrice","swapToken","mlpAmount","getSellMlpFromAmount","toAmount","getBuyMlpFromAmount","fromTokenAddress","fromToken","getSellMlpToAmount","getNextFromAmount","toTokenAddress","toTokenPriceUsd","ratio","toToken","isNative","isWrapped","adjustDecimals","fromAmountBasedOnRatio","isZero","getSwapFeeBasisPoints","redemptionValue","redemptionAmount","expectedAmount","feeBasisPoints0","feeBasisPoints1","swapFeeBasisPoints","getNextToAmount","toAmountBasedOnRatio","getProfitPrice","closePrice","position","profitPrice","calculatePositionDelta","price","lastIncreasedTime","delta","pendingDelta","minProfitExpired","Date","now","hasProfit","lte","deltaPercentage","pendingDeltaPercentage","getDeltaStr","deltaStr","deltaPercentageStr","getDeltaAfterFees","totalFees","hasProfitAfterFees","pendingDeltaAfterFees","deltaPercentageAfterFees","getLeverage","increaseSize","collateralDelta","increaseCollateral","entryFundingRate","cumulativeFundingRate","includeDelta","nextSize","gte","remainingCollateral","fundingFee","getLiquidationPrice","adjustedDelta","positionFee","liquidationPriceForFees","liquidationPriceForMaxLeverage","getUsd","getPositionKey","account","collateralTokenAddress","indexTokenAddress","tokenAddress0","tokenAddress1","getPositionContractKey","collateralToken","indexToken","utils","solidityKeccak256","RPC_PROVIDERS","FALLBACK_PROVIDERS","shortenAddress","left","Math","floor","substring","formatTimeTill","time","dateNow","secondsTill","minutes","hours","days","formatDateTime","getTimeRemaining","parseInt","diff","formatDate","hasMetaMaskWalletExtension","ethereum","hasCoinBaseWalletExtension","providers","isCoinbaseWallet","activateInjectedProvider","providerName","isMetaMask","undefined","provider","setSelectedProvider","getInjectedConnector","useChainId","chainIdFromLocalStorage","removeItem","useENS","ensName","setENSName","resolveENS","JsonRpcProvider","lookupAddress","toLowerCase","clearWalletConnectData","clearWalletLinkData","map","x","filter","startsWith","useEagerConnect","setActivatingConnector","activate","active","tried","setTried","Boolean","shouldTryWalletConnect","rawData","parse","connected","ex","SyntaxError","connector","currentProviderName","authorized","isAuthorized","useInactiveListener","suppress","injected","on","handleConnect","handleChainChanged","handleAccountsChanged","accounts","handleNetworkChanged","networkId","removeListener","getProvider","library","getSigner","sample","StaticJsonRpcProvider","getFallbackProvider","getContractCall","contractInfo","arg0","arg1","method","params","additionalArgs","onError","contract","Contract","abi","concat","fetcher","args","id","contractCall","shouldCallFallback","handleFallback","resolve","reject","fallbackProvider","console","fallbackContractCall","then","result","catch","e","contractName","Promise","setTimeout","BigNumber","from","pow","trimZeroDecimals","parseFloat","toString","limitDecimals","maxDecimals","amountStr","split","dotIndex","indexOf","substr","padDecimals","minDecimals","padEnd","Number","toFixed","slice","formatKeyAmount","tokenDecimals","displayDecimals","useCommas","formatArrayAmount","arr","index","_parseOrdersData","ordersData","indexes","extractor","uintPropsLength","addressPropsLength","uintProps","addressProps","count","orders","sliced","order","parseDecreaseOrdersData","decreaseOrdersData","triggerPrice","triggerAboveThreshold","type","parseIncreaseOrdersData","increaseOrdersData","purchaseToken","purchaseTokenAmount","parseSwapOrdersData","swapOrdersData","shouldUnwrap","amountIn","minOut","triggerRatio","every","getOrderKey","useAccountOrders","flagOrdersEnabled","overrideAccount","connectedAccount","shouldRequest","orderBookAddress","orderBookReaderAddress","mutate","updateOrders","ordersError","dedupingInterval","orderBookContract","orderBookReaderContract","fetchLastIndex","res","_hex","fetchLastIndexes","swap","increase","decrease","all","getRange","to","_indexes","getIndexes","knownIndexes","lastIndex","sort","a","b","getOrders","parseFunc","lastIndexes","serverIndexes","swapOrders","increaseOrders","decreaseOrders","formatUnits","numberWithCommas","formatAmountFree","parseValue","pValue","isNaN","parseUnits","parts","replace","join","getExplorerUrl","getAccountUrl","getTokenUrl","usePrevious","ref","current","setGasPrice","txnOpts","maxGasPrice","premium","gasPrice","getGasPrice","feeData","getFeeData","maxFeePerGas","maxPriorityFeePerGas","getGasLimit","gasBuffer","defaultGasBuffer","gasLimit","estimateGas","approveTokens","setIsApproving","spender","onApproveSubmitted","pendingTxns","setPendingTxns","includeMessage","approve","MaxUint256","txUrl","hash","pendingTxn","message","failMsg","finally","shouldRaiseGasError","balance","replaceNative","NETWORK_METADATA","chainName","nativeCurrency","rpcUrls","blockExplorerUrls","addNetwork","metadata","request","switchNetwork","setItem","document","reload","chainIdHex","code","getWalletConnectHandler","deactivate","fn","walletConnect","warn","getInjectedHandler","errString","isMobileDevice","navigator","test","userAgent","setTokenUsingIndexPrices","indexPrices","indexPrice","indexPriceBn","spread","spreadBps","minPrimaryPrice","halfSpreadBps","CHART_PERIODS","getTotalVolumeSum","volumes","volume","getBalanceAndSupplyData","balances","keys","balanceData","supplyData","propsLength","getDepositBalanceData","depositBalances","getVestingData","vestingInfo","pairAmount","vestedAmount","escrowedBalance","claimedAmounts","claimable","maxVestableAmount","averageStakedAmount","getStakingData","stakingInfo","tokensPerInterval","averageStakedAmounts","cumulativeRewards","totalSupply","getProcessedData","depositBalanceData","stakingData","vestingData","aum","nativeTokenPrice","stakedMycSupply","mycPrice","mycSupply","mycBalance","myc","mycBalanceUsd","mycSupplyUsd","stakedMycSupplyUsd","mycInStakedMyc","mycInStakedMycUsd","esMycBalance","esMyc","esMycBalanceUsd","stakedMycTrackerSupply","stakedMycTracker","stakedMycTrackerSupplyUsd","stakedEsMycSupply","stakedEsMycSupplyUsd","esMycInStakedMyc","esMycInStakedMycUsd","bnMycInFeeMyc","bonusMycInFeeMyc","feeMycSupply","feeMycTracker","feeMycSupplyUsd","stakedMycTrackerRewards","stakedMycTrackerRewardsUsd","bonusMycTrackerRewards","bonusMycTracker","feeMycTrackerRewards","feeMycTrackerRewardsUsd","boostBasisPoints","stakedMycTrackerAnnualRewardsUsd","mycAprForEsMyc","feeMycTrackerAnnualRewardsUsd","mycAprForNativeToken","mycBoostAprForNativeToken","mycAprTotal","mycAprTotalWithBoost","mycAprForNativeTokenWithBoost","totalMycRewardsUsd","mlpSupply","mlp","mlpSupplyUsd","mlpBalance","mlpInStakedMlp","mlpBalanceUsd","stakedMlpTrackerRewards","stakedMlpTracker","stakedMlpTrackerRewardsUsd","feeMlpTrackerRewards","feeMlpTracker","feeMlpTrackerRewardsUsd","stakedMlpTrackerAnnualRewardsUsd","mlpAprForEsMyc","feeMlpTrackerAnnualRewardsUsd","mlpAprForNativeToken","mlpAprTotal","totalMlpRewardsUsd","totalEsMycRewards","totalEsMycRewardsUsd","mycVesterRewards","mycVester","mlpVesterRewards","mlpVester","mlpVesterRewardsUsd","totalVesterRewards","totalVesterRewardsUsd","mlpVesterVestedAmountUsd","mlpVesterVestedAmount","totalNativeTokenRewards","totalNativeTokenRewardsUsd","totalRewardsUsd","addTokenToMetamask","wasAdded","options","image","sleep","ms","getPageTitle","isHashZero","HashZero","isAddressZero","useDebounce","delay","debouncedValue","setDebouncedValue","handler","clearTimeout","hasUserConsented","consent","formatTitleCase","string","isLowerCase","toUpperCase","NETWORK_NAME","getSpread","fromDiff","fromSpread","toDiff","toSpread","isHigh","getUserTokenBalances","userBalances","tokenPrices","poolBalances","forEach","tokenName","balanceFieldName","priceFieldName","poolBalanceFieldName","poolAmount","saveAccountToLocalStorage","prevIdentifiedAccounts","parsedAccounts","getPreviousAccounts","setCurrentAccount","hasBeenIdentified","formattedAddresses","hasChangedAccount","prevAccount","getUrlParameters","searchString","queryString","urlParams","URLSearchParams","get","getWindowFeatures","screenHeight","innerHeight","screenWidth","innerWidth","screenDensity","devicePixelRatio","defaultTruncateLength","truncateMiddleEthAddress","truncateLength","strLength","leadingCharsNum","trailingCharsNum"],"sources":["C:/Users/rober/Documents/swaps-client/src/Helpers.js"],"sourcesContent":["import React, { useState, useRef, useEffect, useCallback } from \"react\";\nimport { InjectedConnector } from \"@web3-react/injected-connector\";\nimport {\n  WalletConnectConnector,\n  UserRejectedRequestError as UserRejectedRequestErrorWalletConnect,\n} from \"@web3-react/walletconnect-connector\";\nimport { toast } from \"react-toastify\";\nimport { useWeb3React, UnsupportedChainIdError } from \"@web3-react/core\";\nimport { useLocalStorage } from \"react-use\";\nimport { ethers } from \"ethers\";\nimport { format as formatDateFn } from \"date-fns\";\nimport Token from \"./abis/Token.json\";\nimport _ from \"lodash\";\nimport { getContract } from \"./Addresses\";\nimport useSWR from \"swr\";\n\nimport OrderBookReader from \"./abis/OrderBookReader.json\";\nimport OrderBook from \"./abis/OrderBook.json\";\n\nimport { getWhitelistedTokens, isValidToken } from \"./data/Tokens\";\nimport ComingSoonTooltip from \"./components/Tooltip/ComingSoon\";\nimport { isAddress } from \"ethers/lib/utils\";\nimport { copyToClipboard } from './utils/common';\nimport {\n  REFERRAL_CODE_QUERY_PARAMS,\n  CURRENT_PROVIDER_LOCALSTORAGE_KEY,\n  WALLET_CONNECT_LOCALSTORAGE_KEY,\n  WALLET_LINK_LOCALSTORAGE_PREFIX,\n  SHOULD_EAGER_CONNECT_LOCALSTORAGE_KEY,\n} from \"./config/localstorage\";\n\nconst { AddressZero } = ethers.constants;\n\nexport const UI_VERSION = \"1.3\";\n\n// use a random placeholder account instead of the zero address as the zero address might have tokens\nexport const PLACEHOLDER_ACCOUNT = ethers.Wallet.createRandom().address;\n\nexport const ETHEREUM = 1;\nexport const ARBITRUM_GOERLI = 421613;\nexport const ARBITRUM = 42161;\n// TODO take it from web3\nexport const DEFAULT_CHAIN_ID = ARBITRUM;\nexport const CHAIN_ID = DEFAULT_CHAIN_ID;\n\nexport const MIN_PROFIT_TIME = 0;\n\nconst SELECTED_NETWORK_LOCAL_STORAGE_KEY = \"SELECTED_NETWORK\";\n\nconst CHAIN_NAMES_MAP = {\n  [ARBITRUM_GOERLI]: \"Testnet\",\n  [ARBITRUM]: \"Arbitrum\",\n};\n\nconst GAS_PRICE_ADJUSTMENT_MAP = {\n  [ARBITRUM]: \"0\",\n};\n\nconst MAX_GAS_PRICE_MAP = {};\n\nconst alchemyWhitelistedDomains = [\"swaps.mycelium.xyz\"];\n\nexport function getFallbackArbitrumRpcUrl(useWebsocket) {\n  if (useWebsocket) {\n    return \"wss://arb1.arbitrum.io/ws\";\n  }\n  return \"https://arb1.arbitrum.io/rpc\";\n}\nexport function getDefaultArbitrumRpcUrl(useWebsocket) {\n  if (alchemyWhitelistedDomains.includes(window.location.host)) {\n    if (useWebsocket) {\n      return \"wss://arb-mainnet.g.alchemy.com/v2/SKz5SvTuqIVjE38XsFsy0McZbgfFPOng\";\n    }\n    return \"https://arb-mainnet.g.alchemy.com/v2/SKz5SvTuqIVjE38XsFsy0McZbgfFPOng\";\n  }\n  return getFallbackArbitrumRpcUrl(useWebsocket);\n}\n\nexport function getFallbackArbitrumGoerliRpcUrl(useWebsocket) {\n  if (useWebsocket) {\n    return \"https://goerli-rollup.arbitrum.io/rpc\";\n  }\n  return \"https://goerli-rollup.arbitrum.io/rpc\";\n}\nexport function getDefaultArbitrumGoerliRpcUrl(useWebsocket) {\n  if (alchemyWhitelistedDomains.includes(window.location.host)) {\n    if (useWebsocket) {\n      return \"wss://arb-goerli.g.alchemy.com/v2/sI8AlA8NGlqAZR_28jfPm9JPQQqmsN4U\";\n    }\n    return \"https://arb-goerli.g.alchemy.com/v2/sI8AlA8NGlqAZR_28jfPm9JPQQqmsN4U\";\n  }\n  return getFallbackArbitrumGoerliRpcUrl(useWebsocket);\n}\n\nconst ETHEREUM_RPC_PROVIDERS = [\"https://cloudflare-eth.com\"];\nconst ARBITRUM_RPC_PROVIDERS = [getDefaultArbitrumRpcUrl()];\nconst ARBITRUM_GOERLI_RPC_PROVIDERS = [getDefaultArbitrumGoerliRpcUrl()];\n\nexport function getChainName(chainId) {\n  return CHAIN_NAMES_MAP[chainId];\n}\n\nexport const USDG_ADDRESS = getContract(CHAIN_ID, \"USDG\");\nexport const MAX_LEVERAGE = 100 * 10000;\n\nexport const MAX_PRICE_DEVIATION_BASIS_POINTS = 250;\nexport const DEFAULT_GAS_LIMIT = 1 * 1000 * 1000;\nexport const SECONDS_PER_YEAR = 31536000;\nexport const FORTNIGHTS_IN_YEAR = 365 / 14;\nexport const USDG_DECIMALS = 18;\nexport const USD_DECIMALS = 30;\nexport const BASIS_POINTS_DIVISOR = 10000;\nexport const DEPOSIT_FEE = 30;\nexport const DUST_BNB = \"2000000000000000\";\nexport const DUST_USD = expandDecimals(1, USD_DECIMALS);\nexport const PRECISION = expandDecimals(1, 30);\nexport const ETH_DECIMALS = 18;\nexport const MLP_DECIMALS = 18;\nexport const MYC_DECIMALS = 18;\nexport const DEFAULT_MAX_USDG_AMOUNT = expandDecimals(200 * 1000 * 1000, 18);\n\nexport const TAX_BASIS_POINTS = 40;\nexport const STABLE_TAX_BASIS_POINTS = 2;\nexport const MINT_BURN_FEE_BASIS_POINTS = 18;\nexport const SWAP_FEE_BASIS_POINTS = 20;\nexport const STABLE_SWAP_FEE_BASIS_POINTS = 3;\nexport const MARGIN_FEE_BASIS_POINTS = 9;\n\nexport const LIQUIDATION_FEE = expandDecimals(5, USD_DECIMALS);\n\nexport const MLP_COOLDOWN_DURATION = 15 * 60;\nexport const THRESHOLD_REDEMPTION_VALUE = expandDecimals(993, 27); // 0.993\nexport const FUNDING_RATE_PRECISION = 1000000;\n\nexport const SWAP = \"Swap\";\nexport const INCREASE = \"Increase\";\nexport const DECREASE = \"Decrease\";\nexport const LONG = \"Long\";\nexport const SHORT = \"Short\";\n\nexport const MARKET = \"Market\";\nexport const LIMIT = \"Limit\";\nexport const STOP = \"Stop\";\nexport const LEVERAGE_ORDER_OPTIONS = [MARKET, LIMIT];\nexport const SWAP_ORDER_OPTIONS = [MARKET, LIMIT];\nexport const SWAP_OPTIONS = [LONG, SHORT, SWAP];\nexport const DEFAULT_SLIPPAGE_AMOUNT = 30;\nexport const DEFAULT_HIGHER_SLIPPAGE_AMOUNT = 100;\n\nexport const TRIGGER_PREFIX_ABOVE = \">\";\nexport const TRIGGER_PREFIX_BELOW = \"<\";\n\nexport const MIN_PROFIT_BIPS = 0;\n\nexport const MLP_POOL_COLORS = {\n  ETH: \"#6062a6\",\n  BTC: \"#F7931A\",\n  USDC: \"#2775CA\",\n  PPUSD: \"#2A5ADA\",\n  \"USDC.e\": \"#2A5ADA\",\n  USDT: \"#67B18A\",\n  MIM: \"#9695F8\",\n  FRAX: \"#000\",\n  DAI: \"#FAC044\",\n  UNI: \"#E9167C\",\n  LINK: \"#3256D6\",\n  CTM: \"#F8B500\",\n  FXS: \"#3B3B3B\",\n  BAL: \"#1B1B1B\",\n  CRV: \"#CF0301\",\n  TEST: \"#994443\",\n};\n\nexport const HIGH_SPREAD_THRESHOLD = expandDecimals(1, USD_DECIMALS).div(100); // 1%;\n\nexport const ICONLINKS = {\n  [ARBITRUM_GOERLI]: {\n    TCR: {\n      coingecko: \"https://www.coingecko.com/en/coins/tracer-dao\",\n      arbitrum: `https://arbiscan.io/address/${getContract(ARBITRUM_GOERLI, \"TCR\")}`,\n    },\n    MLP: {\n      arbitrum: `https://arbiscan.io/address/${getContract(ARBITRUM_GOERLI, \"StakedMlpTracker\")}`,\n    },\n    MYC: {\n      coingecko: \"https://www.coingecko.com/en/coins/mycelium\",\n      arbitrum: \"https://arbiscan.io/token/0xc74fe4c715510ec2f8c61d70d397b32043f55abe\",\n    },\n    ETH: {\n      coingecko: \"https://www.coingecko.com/en/coins/ethereum\",\n    },\n    BTC: {\n      coingecko: \"https://www.coingecko.com/en/coins/wrapped-bitcoin\",\n      arbitrum: \"https://arbiscan.io/address/0x2f2a2543b76a4166549f7aab2e75bef0aefc5b0f\",\n    },\n    LINK: {\n      coingecko: \"https://www.coingecko.com/en/coins/chainlink\",\n      arbitrum: \"https://arbiscan.io/address/0xf97f4df75117a78c1a5a0dbb814af92458539fb4\",\n    },\n    UNI: {\n      coingecko: \"https://www.coingecko.com/en/coins/uniswap\",\n      arbitrum: \"https://arbiscan.io/address/0xfa7f8980b0f1e64a2062791cc3b0871572f1f7f0\",\n    },\n    USDC: {\n      coingecko: \"https://www.coingecko.com/en/coins/usd-coin\",\n      arbitrum: \"https://arbiscan.io/address/0xff970a61a04b1ca14834a43f5de4533ebddb5cc8\",\n    },\n    PPUSD: {\n      arbitrum: \"https://goerli-rollup-explorer.arbitrum.io/address/0x9e062eee2c0Ab96e1E1c8cE38bF14bA3fa0a35F6\",\n    },\n    TEST: {\n      arbitrum: \"https://goerli-rollup-explorer.arbitrum.io/address/0xf76A36092f52Ea0ad1dFdDB5aced4e9f414524F2\",\n    },\n    USDT: {\n      coingecko: \"https://www.coingecko.com/en/coins/tether\",\n      arbitrum: \"https://arbiscan.io/address/0xfd086bc7cd5c481dcc9c85ebe478a1c0b69fcbb9\",\n    },\n    DAI: {\n      coingecko: \"https://www.coingecko.com/en/coins/dai\",\n      arbitrum: \"https://arbiscan.io/address/0xda10009cbd5d07dd0cecc66161fc93d7c9000da1\",\n    },\n    MIM: {\n      coingecko: \"https://www.coingecko.com/en/coins/magic-internet-money\",\n      arbitrum: \"https://arbiscan.io/address/0xfea7a6a0b346362bf88a9e4a88416b77a57d6c2a\",\n    },\n    FRAX: {\n      coingecko: \"https://www.coingecko.com/en/coins/frax\",\n      arbitrum: \"https://arbiscan.io/address/0x17fc002b466eec40dae837fc4be5c67993ddbd6f\",\n    },\n  },\n  42161: {\n    TCR: {\n      coingecko: \"https://www.coingecko.com/en/coins/tracer-dao\",\n      arbitrum: `https://arbiscan.io/address/${getContract(ARBITRUM, \"TCR\")}`,\n    },\n    MLP: {\n      arbitrum: `https://arbiscan.io/address/${getContract(ARBITRUM, \"StakedMlpTracker\")}`,\n    },\n    MYC: {\n      coingecko: \"https://www.coingecko.com/en/coins/mycelium\",\n      arbitrum: \"https://arbiscan.io/token/0xc74fe4c715510ec2f8c61d70d397b32043f55abe\",\n    },\n    ETH: {\n      coingecko: \"https://www.coingecko.com/en/coins/ethereum\",\n    },\n    BTC: {\n      coingecko: \"https://www.coingecko.com/en/coins/wrapped-bitcoin\",\n      arbitrum: \"https://arbiscan.io/address/0x2f2a2543b76a4166549f7aab2e75bef0aefc5b0f\",\n    },\n    LINK: {\n      coingecko: \"https://www.coingecko.com/en/coins/chainlink\",\n      arbitrum: \"https://arbiscan.io/address/0xf97f4df75117a78c1a5a0dbb814af92458539fb4\",\n    },\n    UNI: {\n      coingecko: \"https://www.coingecko.com/en/coins/uniswap\",\n      arbitrum: \"https://arbiscan.io/address/0xfa7f8980b0f1e64a2062791cc3b0871572f1f7f0\",\n    },\n    USDC: {\n      coingecko: \"https://www.coingecko.com/en/coins/usd-coin\",\n      arbitrum: \"https://arbiscan.io/address/0xff970a61a04b1ca14834a43f5de4533ebddb5cc8\",\n    },\n    USDT: {\n      coingecko: \"https://www.coingecko.com/en/coins/tether\",\n      arbitrum: \"https://arbiscan.io/address/0xfd086bc7cd5c481dcc9c85ebe478a1c0b69fcbb9\",\n    },\n    DAI: {\n      coingecko: \"https://www.coingecko.com/en/coins/dai\",\n      arbitrum: \"https://arbiscan.io/address/0xda10009cbd5d07dd0cecc66161fc93d7c9000da1\",\n    },\n    MIM: {\n      coingecko: \"https://www.coingecko.com/en/coins/magic-internet-money\",\n      arbitrum: \"https://arbiscan.io/address/0xfea7a6a0b346362bf88a9e4a88416b77a57d6c2a\",\n    },\n    FRAX: {\n      coingecko: \"https://www.coingecko.com/en/coins/frax\",\n      arbitrum: \"https://arbiscan.io/address/0x17fc002b466eec40dae837fc4be5c67993ddbd6f\",\n    },\n    FXS: {\n      coingecko: \"https://www.coingecko.com/en/coins/frax-share\",\n      arbitrum: \"https://arbiscan.io/address/0x9d2F299715D94d8A7E6F5eaa8E654E8c74a988A7\",\n    },\n    BAL: {\n      coingecko: \"https://www.coingecko.com/en/coins/balancer\",\n      arbitrum: \"https://arbiscan.io/address/0x040d1EdC9569d4Bab2D15287Dc5A4F10F56a56B8\",\n    },\n    CRV: {\n      coingecko: \"https://www.coingecko.com/en/coins/crv-dao-token\",\n      arbitrum: \"https://arbiscan.io/address/0x11cDb42B0EB46D95f990BeDD4695A6e3fA034978\",\n    },\n  },\n};\n\nexport const platformTokens = {\n  [ARBITRUM_GOERLI]: {\n    // arbitrum testnet\n    TCR: {\n      name: \"TCR\",\n      symbol: \"TCR\",\n      decimals: 18,\n      address: getContract(ARBITRUM_GOERLI, \"TCR\"),\n      imageUrl: `${window?.location?.origin}/icons/ic_tcr_40.svg`,\n    },\n    MLP: {\n      name: \"TCR LP\",\n      symbol: \"MLP\",\n      decimals: 18,\n      address: getContract(ARBITRUM_GOERLI, \"StakedMlpTracker\"), // address of fsMLP token because user only holds fsMLP\n      imageUrl: `${window?.location?.origin}/icons/ic_mlp_custom.svg`,\n    },\n  },\n  [ARBITRUM]: {\n    // arbitrum\n    TCR: {\n      name: \"TCR\",\n      symbol: \"TCR\",\n      decimals: 18,\n      address: getContract(ARBITRUM, \"TCR\"),\n      imageUrl: `${window?.location?.origin}/icons/ic_tcr_40.svg`,\n    },\n    MYC: {\n      name: \"MYC\",\n      symbol: \"MYC\",\n      decimals: 18,\n      address: getContract(ARBITRUM, \"MYC\"),\n      imageUrl: `${window?.location?.origin}/icons/ic_myc_custom.svg`,\n    },\n    MLP: {\n      name: \"MYC LP\",\n      symbol: \"MLP\",\n      decimals: 18,\n      address: getContract(ARBITRUM, \"StakedMlpTracker\"), // address of fsMLP token because user only holds fsMLP\n      imageUrl: `${window?.location?.origin}/icons/ic_mlp_custom.svg`,\n    },\n  },\n};\n\nexport const networkOptions = [\n  \n  {\n    label: \"Testnet\",\n    value: ARBITRUM_GOERLI,\n    icon: \"ic_arbitrum_24.svg\",\n    color: \"#000000\",\n  },\n];\n\nconst supportedChainIds = [ARBITRUM, ARBITRUM_GOERLI];\nconst injectedConnector = new InjectedConnector({\n  supportedChainIds,\n});\n\nconst getWalletConnectConnector = () => {\n  const chainId = localStorage.getItem(SELECTED_NETWORK_LOCAL_STORAGE_KEY) || DEFAULT_CHAIN_ID;\n  return new WalletConnectConnector({\n    rpc: {\n      [ETHEREUM]: ETHEREUM_RPC_PROVIDERS[0],\n      [ARBITRUM]: ARBITRUM_RPC_PROVIDERS[0],\n      [ARBITRUM_GOERLI]: ARBITRUM_GOERLI_RPC_PROVIDERS[0],\n    },\n    qrcode: true,\n    chainId,\n  });\n};\n\nexport function isSupportedChain(chainId) {\n  return supportedChainIds.includes(chainId);\n}\n\nexport function deserialize(data) {\n  for (const [key, value] of Object.entries(data)) {\n    if (value._type === \"BigNumber\") {\n      data[key] = bigNumberify(value.value);\n    }\n  }\n  return data;\n}\n\nexport const helperToast = {\n  success: (content) => {\n    toast.success(content);\n  },\n  error: (content) => {\n    toast.error(content);\n  },\n};\n\nexport function useLocalStorageByChainId(chainId, key, defaultValue) {\n  const [internalValue, setInternalValue] = useLocalStorage(key, {});\n\n  const setValue = useCallback(\n    (value) => {\n      setInternalValue((internalValue) => {\n        if (typeof value === \"function\") {\n          value = value(internalValue[chainId] || defaultValue);\n        }\n        const newInternalValue = {\n          ...internalValue,\n          [chainId]: value,\n        };\n        return newInternalValue;\n      });\n    },\n    [chainId, setInternalValue, defaultValue]\n  );\n\n  let value;\n  if (chainId in internalValue) {\n    value = internalValue[chainId];\n  } else {\n    value = defaultValue;\n  }\n\n  return [value, setValue];\n}\n\nexport function useLocalStorageSerializeKey(key, value, opts) {\n  key = JSON.stringify(key);\n  return useLocalStorage(key, value, opts);\n}\n\nfunction getTriggerPrice(tokenAddress, max, info, orderOption, triggerPriceUsd) {\n  // Limit/stop orders are executed with price specified by user\n  if (orderOption && orderOption !== MARKET && triggerPriceUsd) {\n    return triggerPriceUsd;\n  }\n\n  // Market orders are executed with current market price\n  if (!info) {\n    return;\n  }\n  if (max && !info.maxPrice) {\n    return;\n  }\n  if (!max && !info.minPrice) {\n    return;\n  }\n  return max ? info.maxPrice : info.minPrice;\n}\n\nexport function getLiquidationPriceFromDelta({ liquidationAmount, size, collateral, averagePrice, isLong }) {\n  if (!size || size.eq(0)) {\n    return;\n  }\n\n  if (liquidationAmount.gt(collateral)) {\n    const liquidationDelta = liquidationAmount.sub(collateral);\n    const priceDelta = liquidationDelta.mul(averagePrice).div(size);\n    return isLong ? averagePrice.add(priceDelta) : averagePrice.sub(priceDelta);\n  }\n\n  const liquidationDelta = collateral.sub(liquidationAmount);\n  const priceDelta = liquidationDelta.mul(averagePrice).div(size);\n\n  return isLong ? averagePrice.sub(priceDelta) : averagePrice.add(priceDelta);\n}\n\nexport const replaceNativeTokenAddress = (path, nativeTokenAddress) => {\n  if (!path) {\n    return;\n  }\n\n  let updatedPath = [];\n  for (let i = 0; i < path.length; i++) {\n    let address = path[i];\n    if (address === AddressZero) {\n      address = nativeTokenAddress;\n    }\n    updatedPath.push(address);\n  }\n\n  return updatedPath;\n};\n\nexport function getMarginFee(sizeDelta) {\n  if (!sizeDelta) {\n    return bigNumberify(0);\n  }\n  const afterFeeUsd = sizeDelta.mul(BASIS_POINTS_DIVISOR - MARGIN_FEE_BASIS_POINTS).div(BASIS_POINTS_DIVISOR);\n  return sizeDelta.sub(afterFeeUsd);\n}\n\nexport function isTriggerRatioInverted(fromTokenInfo, toTokenInfo) {\n  if (!toTokenInfo || !fromTokenInfo) return false;\n  if (toTokenInfo.isStable || toTokenInfo.isUsdg) return true;\n  if (toTokenInfo.maxPrice) return toTokenInfo.maxPrice.lt(fromTokenInfo.maxPrice);\n  return false;\n}\n\nexport function getExchangeRate(tokenAInfo, tokenBInfo, inverted) {\n  if (!tokenAInfo || !tokenAInfo.minPrice || !tokenBInfo || !tokenBInfo.maxPrice) {\n    return;\n  }\n  if (inverted) {\n    return tokenAInfo.minPrice.mul(PRECISION).div(tokenBInfo.maxPrice);\n  }\n  return tokenBInfo.maxPrice.mul(PRECISION).div(tokenAInfo.minPrice);\n}\n\nexport function getMostAbundantStableToken(chainId, infoTokens) {\n  const whitelistedTokens = getWhitelistedTokens(chainId);\n  let availableAmount;\n  let stableToken = whitelistedTokens.find((t) => t.isStable);\n  for (let i = 0; i < whitelistedTokens.length; i++) {\n    const info = getTokenInfo(infoTokens, whitelistedTokens[i].address);\n    if (!info.isStable || !info.availableAmount) {\n      continue;\n    }\n\n    const adjustedAvailableAmount = adjustForDecimals(info.availableAmount, info.decimals, USD_DECIMALS);\n    if (!availableAmount || adjustedAvailableAmount.gt(availableAmount)) {\n      availableAmount = adjustedAvailableAmount;\n      stableToken = info;\n    }\n  }\n  return stableToken;\n}\n\nexport function shouldInvertTriggerRatio(tokenA, tokenB) {\n  if (tokenB.isStable || tokenB.isUsdg) return true;\n  if (tokenB.maxPrice && tokenA.maxPrice && tokenB.maxPrice.lt(tokenA.maxPrice)) return true;\n  return false;\n}\n\nexport function getExchangeRateDisplay(rate, tokenA, tokenB, opts = {}) {\n  if (!rate || !tokenA || !tokenB) return \"...\";\n  if (shouldInvertTriggerRatio(tokenA, tokenB)) {\n    [tokenA, tokenB] = [tokenB, tokenA];\n    rate = PRECISION.mul(PRECISION).div(rate);\n  }\n  const rateValue = formatAmount(rate, USD_DECIMALS, tokenA.isStable || tokenA.isUsdg ? 2 : 4, true);\n  if (opts.omitSymbols) {\n    return rateValue;\n  }\n  return `${rateValue} ${tokenA.symbol} / ${tokenB.symbol}`;\n}\n\nconst adjustForDecimalsFactory = (n) => (number) => {\n  if (n === 0) {\n    return number;\n  }\n  if (n > 0) {\n    return number.mul(expandDecimals(1, n));\n  }\n  return number.div(expandDecimals(1, -n));\n};\n\nexport function adjustForDecimals(amount, divDecimals, mulDecimals) {\n  return amount.mul(expandDecimals(1, mulDecimals)).div(expandDecimals(1, divDecimals));\n}\n\nexport function getTargetUsdgAmount(token, usdgSupply, totalTokenWeights) {\n  if (!token || !token.weight || !usdgSupply) {\n    return;\n  }\n\n  if (usdgSupply.eq(0)) {\n    return bigNumberify(0);\n  }\n\n  return token.weight.mul(usdgSupply).div(totalTokenWeights);\n}\n\nexport function getFeeBasisPoints(\n  token,\n  usdgDelta,\n  feeBasisPoints,\n  taxBasisPoints,\n  increment,\n  usdgSupply,\n  totalTokenWeights\n) {\n  if (!token || !token.usdgAmount || !usdgSupply || !totalTokenWeights) {\n    return 0;\n  }\n\n  feeBasisPoints = bigNumberify(feeBasisPoints);\n  taxBasisPoints = bigNumberify(taxBasisPoints);\n\n  const initialAmount = token.usdgAmount;\n  let nextAmount = initialAmount.add(usdgDelta);\n  if (!increment) {\n    nextAmount = usdgDelta.gt(initialAmount) ? bigNumberify(0) : initialAmount.sub(usdgDelta);\n  }\n\n  const targetAmount = getTargetUsdgAmount(token, usdgSupply, totalTokenWeights);\n  if (!targetAmount || targetAmount.eq(0)) {\n    return feeBasisPoints.toNumber();\n  }\n\n  const initialDiff = initialAmount.gt(targetAmount)\n    ? initialAmount.sub(targetAmount)\n    : targetAmount.sub(initialAmount);\n  const nextDiff = nextAmount.gt(targetAmount) ? nextAmount.sub(targetAmount) : targetAmount.sub(nextAmount);\n\n  if (nextDiff.lt(initialDiff)) {\n    const rebateBps = taxBasisPoints.mul(initialDiff).div(targetAmount);\n    return rebateBps.gt(feeBasisPoints) ? 0 : feeBasisPoints.sub(rebateBps).toNumber();\n  }\n\n  let averageDiff = initialDiff.add(nextDiff).div(2);\n  if (averageDiff.gt(targetAmount)) {\n    averageDiff = targetAmount;\n  }\n  const taxBps = taxBasisPoints.mul(averageDiff).div(targetAmount);\n  return feeBasisPoints.add(taxBps).toNumber();\n}\n\nexport function getBuyMlpToAmount(fromAmount, swapTokenAddress, infoTokens, mlpPrice, usdgSupply, totalTokenWeights) {\n  const defaultValue = { amount: bigNumberify(0), feeBasisPoints: 0 };\n  if (!fromAmount || !swapTokenAddress || !infoTokens || !mlpPrice || !usdgSupply || !totalTokenWeights) {\n    return defaultValue;\n  }\n\n  const swapToken = getTokenInfo(infoTokens, swapTokenAddress);\n  if (!swapToken || !swapToken.minPrice) {\n    return defaultValue;\n  }\n\n  let mlpAmount = fromAmount.mul(swapToken.minPrice).div(mlpPrice);\n  mlpAmount = adjustForDecimals(mlpAmount, swapToken.decimals, USDG_DECIMALS);\n\n  let usdgAmount = fromAmount.mul(swapToken.minPrice).div(PRECISION);\n  usdgAmount = adjustForDecimals(usdgAmount, swapToken.decimals, USDG_DECIMALS);\n  const feeBasisPoints = getFeeBasisPoints(\n    swapToken,\n    usdgAmount,\n    MINT_BURN_FEE_BASIS_POINTS,\n    TAX_BASIS_POINTS,\n    true,\n    usdgSupply,\n    totalTokenWeights\n  );\n\n  mlpAmount = mlpAmount.mul(BASIS_POINTS_DIVISOR - feeBasisPoints).div(BASIS_POINTS_DIVISOR);\n\n  return { amount: mlpAmount, feeBasisPoints };\n}\n\nexport function getSellMlpFromAmount(toAmount, swapTokenAddress, infoTokens, mlpPrice, usdgSupply, totalTokenWeights) {\n  const defaultValue = { amount: bigNumberify(0), feeBasisPoints: 0 };\n  if (!toAmount || !swapTokenAddress || !infoTokens || !mlpPrice || !usdgSupply || !totalTokenWeights) {\n    return defaultValue;\n  }\n\n  const swapToken = getTokenInfo(infoTokens, swapTokenAddress);\n  if (!swapToken || !swapToken.maxPrice) {\n    return defaultValue;\n  }\n\n  let mlpAmount = toAmount.mul(swapToken.maxPrice).div(mlpPrice);\n  mlpAmount = adjustForDecimals(mlpAmount, swapToken.decimals, USDG_DECIMALS);\n\n  let usdgAmount = toAmount.mul(swapToken.maxPrice).div(PRECISION);\n  usdgAmount = adjustForDecimals(usdgAmount, swapToken.decimals, USDG_DECIMALS);\n  const feeBasisPoints = getFeeBasisPoints(\n    swapToken,\n    usdgAmount,\n    MINT_BURN_FEE_BASIS_POINTS,\n    TAX_BASIS_POINTS,\n    false,\n    usdgSupply,\n    totalTokenWeights\n  );\n\n  mlpAmount = mlpAmount.mul(BASIS_POINTS_DIVISOR).div(BASIS_POINTS_DIVISOR - feeBasisPoints);\n\n  return { amount: mlpAmount, feeBasisPoints };\n}\n\nexport function getBuyMlpFromAmount(toAmount, fromTokenAddress, infoTokens, mlpPrice, usdgSupply, totalTokenWeights) {\n  const defaultValue = { amount: bigNumberify(0) };\n  if (!toAmount || !fromTokenAddress || !infoTokens || !mlpPrice || !usdgSupply || !totalTokenWeights) {\n    return defaultValue;\n  }\n\n  const fromToken = getTokenInfo(infoTokens, fromTokenAddress);\n  if (!fromToken || !fromToken.minPrice) {\n    return defaultValue;\n  }\n\n  let fromAmount = toAmount.mul(mlpPrice).div(fromToken.minPrice);\n  fromAmount = adjustForDecimals(fromAmount, MLP_DECIMALS, fromToken.decimals);\n\n  const usdgAmount = toAmount.mul(mlpPrice).div(PRECISION);\n  const feeBasisPoints = getFeeBasisPoints(\n    fromToken,\n    usdgAmount,\n    MINT_BURN_FEE_BASIS_POINTS,\n    TAX_BASIS_POINTS,\n    true,\n    usdgSupply,\n    totalTokenWeights\n  );\n\n  fromAmount = fromAmount.mul(BASIS_POINTS_DIVISOR).div(BASIS_POINTS_DIVISOR - feeBasisPoints);\n\n  return { amount: fromAmount, feeBasisPoints };\n}\n\nexport function getSellMlpToAmount(toAmount, fromTokenAddress, infoTokens, mlpPrice, usdgSupply, totalTokenWeights) {\n  const defaultValue = { amount: bigNumberify(0) };\n  if (!toAmount || !fromTokenAddress || !infoTokens || !mlpPrice || !usdgSupply || !totalTokenWeights) {\n    return defaultValue;\n  }\n\n  const fromToken = getTokenInfo(infoTokens, fromTokenAddress);\n  if (!fromToken || !fromToken.maxPrice) {\n    return defaultValue;\n  }\n\n  let fromAmount = toAmount.mul(mlpPrice).div(fromToken.maxPrice);\n  fromAmount = adjustForDecimals(fromAmount, MLP_DECIMALS, fromToken.decimals);\n\n  const usdgAmount = toAmount.mul(mlpPrice).div(PRECISION);\n  const feeBasisPoints = getFeeBasisPoints(\n    fromToken,\n    usdgAmount,\n    MINT_BURN_FEE_BASIS_POINTS,\n    TAX_BASIS_POINTS,\n    false,\n    usdgSupply,\n    totalTokenWeights\n  );\n\n  fromAmount = fromAmount.mul(BASIS_POINTS_DIVISOR - feeBasisPoints).div(BASIS_POINTS_DIVISOR);\n\n  return { amount: fromAmount, feeBasisPoints };\n}\n\nexport function getNextFromAmount(\n  chainId,\n  toAmount,\n  fromTokenAddress,\n  toTokenAddress,\n  infoTokens,\n  toTokenPriceUsd,\n  ratio,\n  usdgSupply,\n  totalTokenWeights\n) {\n  const defaultValue = { amount: bigNumberify(0) };\n\n  if (!toAmount || !fromTokenAddress || !toTokenAddress || !infoTokens) {\n    return defaultValue;\n  }\n\n  if (fromTokenAddress === toTokenAddress) {\n    return { amount: toAmount };\n  }\n\n  const fromToken = getTokenInfo(infoTokens, fromTokenAddress);\n  const toToken = getTokenInfo(infoTokens, toTokenAddress);\n\n  if (fromToken.isNative && toToken.isWrapped) {\n    return { amount: toAmount };\n  }\n\n  if (fromToken.isWrapped && toToken.isNative) {\n    return { amount: toAmount };\n  }\n\n  if (!fromToken || !fromToken.minPrice || !toToken || !toToken.maxPrice) {\n    return defaultValue;\n  }\n\n  const adjustDecimals = adjustForDecimalsFactory(fromToken.decimals - toToken.decimals);\n\n  let fromAmountBasedOnRatio;\n  if (ratio && !ratio.isZero()) {\n    fromAmountBasedOnRatio = toAmount.mul(ratio).div(PRECISION);\n  }\n\n  if (toTokenAddress === USDG_ADDRESS) {\n    const feeBasisPoints = getSwapFeeBasisPoints(fromToken.isStable);\n\n    if (ratio && !ratio.isZero()) {\n      return {\n        amount: adjustDecimals(\n          fromAmountBasedOnRatio.mul(BASIS_POINTS_DIVISOR + feeBasisPoints).div(BASIS_POINTS_DIVISOR)\n        ),\n      };\n    }\n    const fromAmount = toAmount.mul(PRECISION).div(fromToken.maxPrice);\n    return {\n      amount: adjustDecimals(fromAmount.mul(BASIS_POINTS_DIVISOR + feeBasisPoints).div(BASIS_POINTS_DIVISOR)),\n    };\n  }\n\n  if (fromTokenAddress === USDG_ADDRESS) {\n    const redemptionValue = toToken.redemptionAmount.mul(toToken.maxPrice).div(expandDecimals(1, toToken.decimals));\n    if (redemptionValue.gt(THRESHOLD_REDEMPTION_VALUE)) {\n      const feeBasisPoints = getSwapFeeBasisPoints(toToken.isStable);\n\n      const fromAmount =\n        ratio && !ratio.isZero()\n          ? fromAmountBasedOnRatio\n          : toAmount.mul(expandDecimals(1, toToken.decimals)).div(toToken.redemptionAmount);\n\n      return {\n        amount: adjustDecimals(fromAmount.mul(BASIS_POINTS_DIVISOR + feeBasisPoints).div(BASIS_POINTS_DIVISOR)),\n      };\n    }\n\n    const expectedAmount = toAmount.mul(toToken.maxPrice).div(PRECISION);\n\n    const stableToken = getMostAbundantStableToken(chainId, infoTokens);\n    if (!stableToken || stableToken.availableAmount.lt(expectedAmount)) {\n      const feeBasisPoints = getSwapFeeBasisPoints(toToken.isStable);\n\n      const fromAmount =\n        ratio && !ratio.isZero()\n          ? fromAmountBasedOnRatio\n          : toAmount.mul(expandDecimals(1, toToken.decimals)).div(toToken.redemptionAmount);\n\n      return {\n        amount: adjustDecimals(fromAmount.mul(BASIS_POINTS_DIVISOR + feeBasisPoints).div(BASIS_POINTS_DIVISOR)),\n      };\n    }\n\n    const feeBasisPoints0 = getSwapFeeBasisPoints(true);\n    const feeBasisPoints1 = getSwapFeeBasisPoints(false);\n\n    if (ratio && !ratio.isZero()) {\n      // apply fees twice usdg -> token1 -> token2\n      const fromAmount = fromAmountBasedOnRatio\n        .mul(BASIS_POINTS_DIVISOR + feeBasisPoints0 + feeBasisPoints1)\n        .div(BASIS_POINTS_DIVISOR);\n      return {\n        amount: adjustDecimals(fromAmount),\n        path: [USDG_ADDRESS, stableToken.address, toToken.address],\n      };\n    }\n\n    // get fromAmount for stableToken => toToken\n    let fromAmount = toAmount.mul(toToken.maxPrice).div(stableToken.minPrice);\n\n    // apply stableToken => toToken fees\n    fromAmount = fromAmount.mul(BASIS_POINTS_DIVISOR + feeBasisPoints1).div(BASIS_POINTS_DIVISOR);\n\n    // get fromAmount for USDG => stableToken\n    fromAmount = fromAmount.mul(stableToken.maxPrice).div(PRECISION);\n\n    // apply USDG => stableToken fees\n    fromAmount = fromAmount.mul(BASIS_POINTS_DIVISOR + feeBasisPoints0).div(BASIS_POINTS_DIVISOR);\n\n    return {\n      amount: adjustDecimals(fromAmount),\n      path: [USDG_ADDRESS, stableToken.address, toToken.address],\n    };\n  }\n\n  const fromAmount =\n    ratio && !ratio.isZero() ? fromAmountBasedOnRatio : toAmount.mul(toToken.maxPrice).div(fromToken.minPrice);\n\n  let usdgAmount = fromAmount.mul(fromToken.minPrice).div(PRECISION);\n  usdgAmount = adjustForDecimals(usdgAmount, toToken.decimals, USDG_DECIMALS);\n  const swapFeeBasisPoints =\n    fromToken.isStable && toToken.isStable ? STABLE_SWAP_FEE_BASIS_POINTS : SWAP_FEE_BASIS_POINTS;\n  const taxBasisPoints = fromToken.isStable && toToken.isStable ? STABLE_TAX_BASIS_POINTS : TAX_BASIS_POINTS;\n  const feeBasisPoints0 = getFeeBasisPoints(\n    fromToken,\n    usdgAmount,\n    swapFeeBasisPoints,\n    taxBasisPoints,\n    true,\n    usdgSupply,\n    totalTokenWeights\n  );\n  const feeBasisPoints1 = getFeeBasisPoints(\n    toToken,\n    usdgAmount,\n    swapFeeBasisPoints,\n    taxBasisPoints,\n    false,\n    usdgSupply,\n    totalTokenWeights\n  );\n  const feeBasisPoints = feeBasisPoints0 > feeBasisPoints1 ? feeBasisPoints0 : feeBasisPoints1;\n\n  return {\n    amount: adjustDecimals(fromAmount.mul(BASIS_POINTS_DIVISOR).div(BASIS_POINTS_DIVISOR - feeBasisPoints)),\n    feeBasisPoints,\n  };\n}\n\nexport function getNextToAmount(\n  chainId,\n  fromAmount,\n  fromTokenAddress,\n  toTokenAddress,\n  infoTokens,\n  toTokenPriceUsd,\n  ratio,\n  usdgSupply,\n  totalTokenWeights\n) {\n  const defaultValue = { amount: bigNumberify(0) };\n  if (!fromAmount || !fromTokenAddress || !toTokenAddress || !infoTokens) {\n    return defaultValue;\n  }\n\n  if (fromTokenAddress === toTokenAddress) {\n    return { amount: fromAmount };\n  }\n\n  const fromToken = getTokenInfo(infoTokens, fromTokenAddress);\n  const toToken = getTokenInfo(infoTokens, toTokenAddress);\n\n  if (fromToken.isNative && toToken.isWrapped) {\n    return { amount: fromAmount };\n  }\n\n  if (fromToken.isWrapped && toToken.isNative) {\n    return { amount: fromAmount };\n  }\n\n  if (!fromToken || !fromToken.minPrice || !toToken || !toToken.maxPrice) {\n    return defaultValue;\n  }\n\n  const adjustDecimals = adjustForDecimalsFactory(toToken.decimals - fromToken.decimals);\n\n  let toAmountBasedOnRatio = bigNumberify(0);\n  if (ratio && !ratio.isZero()) {\n    toAmountBasedOnRatio = fromAmount.mul(PRECISION).div(ratio);\n  }\n\n  if (toTokenAddress === USDG_ADDRESS) {\n    const feeBasisPoints = getSwapFeeBasisPoints(fromToken.isStable);\n\n    if (ratio && !ratio.isZero()) {\n      const toAmount = toAmountBasedOnRatio;\n      return {\n        amount: adjustDecimals(toAmount.mul(BASIS_POINTS_DIVISOR - feeBasisPoints).div(BASIS_POINTS_DIVISOR)),\n        feeBasisPoints,\n      };\n    }\n\n    const toAmount = fromAmount.mul(fromToken.minPrice).div(PRECISION);\n    return {\n      amount: adjustDecimals(toAmount.mul(BASIS_POINTS_DIVISOR - feeBasisPoints).div(BASIS_POINTS_DIVISOR)),\n      feeBasisPoints,\n    };\n  }\n\n  if (fromTokenAddress === USDG_ADDRESS) {\n    const redemptionValue = toToken.redemptionAmount\n      .mul(toTokenPriceUsd || toToken.maxPrice)\n      .div(expandDecimals(1, toToken.decimals));\n\n    if (redemptionValue.gt(THRESHOLD_REDEMPTION_VALUE)) {\n      const feeBasisPoints = getSwapFeeBasisPoints(toToken.isStable);\n\n      const toAmount =\n        ratio && !ratio.isZero()\n          ? toAmountBasedOnRatio\n          : fromAmount.mul(toToken.redemptionAmount).div(expandDecimals(1, toToken.decimals));\n\n      return {\n        amount: adjustDecimals(toAmount.mul(BASIS_POINTS_DIVISOR - feeBasisPoints).div(BASIS_POINTS_DIVISOR)),\n        feeBasisPoints,\n      };\n    }\n\n    const expectedAmount = fromAmount;\n\n    const stableToken = getMostAbundantStableToken(chainId, infoTokens);\n    if (!stableToken || stableToken.availableAmount.lt(expectedAmount)) {\n      const toAmount =\n        ratio && !ratio.isZero()\n          ? toAmountBasedOnRatio\n          : fromAmount.mul(toToken.redemptionAmount).div(expandDecimals(1, toToken.decimals));\n      const feeBasisPoints = getSwapFeeBasisPoints(toToken.isStable);\n      return {\n        amount: adjustDecimals(toAmount.mul(BASIS_POINTS_DIVISOR - feeBasisPoints).div(BASIS_POINTS_DIVISOR)),\n        feeBasisPoints,\n      };\n    }\n\n    const feeBasisPoints0 = getSwapFeeBasisPoints(true);\n    const feeBasisPoints1 = getSwapFeeBasisPoints(false);\n\n    if (ratio && !ratio.isZero()) {\n      const toAmount = toAmountBasedOnRatio\n        .mul(BASIS_POINTS_DIVISOR - feeBasisPoints0 - feeBasisPoints1)\n        .div(BASIS_POINTS_DIVISOR);\n      return {\n        amount: adjustDecimals(toAmount),\n        path: [USDG_ADDRESS, stableToken.address, toToken.address],\n        feeBasisPoints: feeBasisPoints0 + feeBasisPoints1,\n      };\n    }\n\n    // get toAmount for USDG => stableToken\n    let toAmount = fromAmount.mul(PRECISION).div(stableToken.maxPrice);\n    // apply USDG => stableToken fees\n    toAmount = toAmount.mul(BASIS_POINTS_DIVISOR - feeBasisPoints0).div(BASIS_POINTS_DIVISOR);\n\n    // get toAmount for stableToken => toToken\n    toAmount = toAmount.mul(stableToken.minPrice).div(toTokenPriceUsd || toToken.maxPrice);\n    // apply stableToken => toToken fees\n    toAmount = toAmount.mul(BASIS_POINTS_DIVISOR - feeBasisPoints1).div(BASIS_POINTS_DIVISOR);\n\n    return {\n      amount: adjustDecimals(toAmount),\n      path: [USDG_ADDRESS, stableToken.address, toToken.address],\n      feeBasisPoints: feeBasisPoints0 + feeBasisPoints1,\n    };\n  }\n\n  const toAmount =\n    ratio && !ratio.isZero()\n      ? toAmountBasedOnRatio\n      : fromAmount.mul(fromToken.minPrice).div(toTokenPriceUsd || toToken.maxPrice);\n\n  let usdgAmount = fromAmount.mul(fromToken.minPrice).div(PRECISION);\n  usdgAmount = adjustForDecimals(usdgAmount, fromToken.decimals, USDG_DECIMALS);\n  const swapFeeBasisPoints =\n    fromToken.isStable && toToken.isStable ? STABLE_SWAP_FEE_BASIS_POINTS : SWAP_FEE_BASIS_POINTS;\n  const taxBasisPoints = fromToken.isStable && toToken.isStable ? STABLE_TAX_BASIS_POINTS : TAX_BASIS_POINTS;\n  const feeBasisPoints0 = getFeeBasisPoints(\n    fromToken,\n    usdgAmount,\n    swapFeeBasisPoints,\n    taxBasisPoints,\n    true,\n    usdgSupply,\n    totalTokenWeights\n  );\n  const feeBasisPoints1 = getFeeBasisPoints(\n    toToken,\n    usdgAmount,\n    swapFeeBasisPoints,\n    taxBasisPoints,\n    false,\n    usdgSupply,\n    totalTokenWeights\n  );\n  const feeBasisPoints = feeBasisPoints0 > feeBasisPoints1 ? feeBasisPoints0 : feeBasisPoints1;\n\n  return {\n    amount: adjustDecimals(toAmount.mul(BASIS_POINTS_DIVISOR - feeBasisPoints).div(BASIS_POINTS_DIVISOR)),\n    feeBasisPoints,\n  };\n}\n\nexport function getProfitPrice(closePrice, position) {\n  let profitPrice;\n  if (position && position.averagePrice && closePrice) {\n    profitPrice = position.isLong\n      ? position.averagePrice.mul(BASIS_POINTS_DIVISOR + MIN_PROFIT_BIPS).div(BASIS_POINTS_DIVISOR)\n      : position.averagePrice.mul(BASIS_POINTS_DIVISOR - MIN_PROFIT_BIPS).div(BASIS_POINTS_DIVISOR);\n  }\n  return profitPrice;\n}\n\nexport function calculatePositionDelta(\n  price,\n  { size, collateral, isLong, averagePrice, lastIncreasedTime },\n  sizeDelta\n) {\n  if (!sizeDelta) {\n    sizeDelta = size;\n  }\n  const priceDelta = averagePrice.gt(price) ? averagePrice.sub(price) : price.sub(averagePrice);\n  let delta = sizeDelta.mul(priceDelta).div(averagePrice);\n  const pendingDelta = delta;\n\n  const minProfitExpired = lastIncreasedTime + MIN_PROFIT_TIME < Date.now() / 1000;\n  const hasProfit = isLong ? price.gt(averagePrice) : price.lt(averagePrice);\n  if (!minProfitExpired && hasProfit && delta.mul(BASIS_POINTS_DIVISOR).lte(size.mul(MIN_PROFIT_BIPS))) {\n    delta = bigNumberify(0);\n  }\n\n  const deltaPercentage = delta.mul(BASIS_POINTS_DIVISOR).div(collateral);\n  const pendingDeltaPercentage = pendingDelta.mul(BASIS_POINTS_DIVISOR).div(collateral);\n\n  return {\n    delta,\n    pendingDelta,\n    pendingDeltaPercentage,\n    hasProfit,\n    deltaPercentage,\n  };\n}\n\nexport function getDeltaStr({ delta, deltaPercentage, hasProfit }) {\n  let deltaStr;\n  let deltaPercentageStr;\n\n  if (delta.gt(0)) {\n    deltaStr = hasProfit ? \"+\" : \"-\";\n    deltaPercentageStr = hasProfit ? \"+\" : \"-\";\n  } else {\n    deltaStr = \"\";\n    deltaPercentageStr = \"\";\n  }\n  deltaStr += `$${formatAmount(delta, USD_DECIMALS, 2, true)}`;\n  deltaPercentageStr += `${formatAmount(deltaPercentage, 2, 2)}%`;\n\n  return { deltaStr, deltaPercentageStr };\n}\n\nexport function getDeltaAfterFees({ delta, totalFees, collateral, hasProfit }) {\n  let hasProfitAfterFees;\n  let pendingDeltaAfterFees;\n\n  if (hasProfit) {\n    if (delta.gt(totalFees)) {\n      hasProfitAfterFees = true;\n      pendingDeltaAfterFees = delta.sub(totalFees);\n    } else {\n      hasProfitAfterFees = false;\n      pendingDeltaAfterFees = totalFees.sub(delta);\n    }\n  } else {\n    hasProfitAfterFees = false;\n    pendingDeltaAfterFees = delta.add(totalFees);\n  }\n\n  let deltaPercentageAfterFees = pendingDeltaAfterFees.mul(BASIS_POINTS_DIVISOR).div(collateral);\n\n  return { pendingDeltaAfterFees, deltaPercentageAfterFees, hasProfitAfterFees };\n}\n\nexport function getLeverage({\n  size,\n  sizeDelta,\n  increaseSize,\n  collateral,\n  collateralDelta,\n  increaseCollateral,\n  entryFundingRate,\n  cumulativeFundingRate,\n  hasProfit,\n  delta,\n  includeDelta,\n}) {\n  if (!size && !sizeDelta) {\n    return;\n  }\n  if (!collateral && !collateralDelta) {\n    return;\n  }\n\n  let nextSize = size ? size : bigNumberify(0);\n  if (sizeDelta) {\n    if (increaseSize) {\n      nextSize = size.add(sizeDelta);\n    } else {\n      if (sizeDelta.gte(size)) {\n        return;\n      }\n      nextSize = size.sub(sizeDelta);\n    }\n  }\n\n  let remainingCollateral = collateral ? collateral : bigNumberify(0);\n  if (collateralDelta) {\n    if (increaseCollateral) {\n      remainingCollateral = collateral.add(collateralDelta);\n    } else {\n      if (collateralDelta.gte(collateral)) {\n        return;\n      }\n      remainingCollateral = collateral.sub(collateralDelta);\n    }\n  }\n\n  if (delta && includeDelta) {\n    if (hasProfit) {\n      remainingCollateral = remainingCollateral.add(delta);\n    } else {\n      if (delta.gt(remainingCollateral)) {\n        return;\n      }\n\n      remainingCollateral = remainingCollateral.sub(delta);\n    }\n  }\n\n  if (remainingCollateral.eq(0)) {\n    return;\n  }\n\n  remainingCollateral = sizeDelta\n    ? remainingCollateral.mul(BASIS_POINTS_DIVISOR - MARGIN_FEE_BASIS_POINTS).div(BASIS_POINTS_DIVISOR)\n    : remainingCollateral;\n  if (entryFundingRate && cumulativeFundingRate) {\n    const fundingFee = size.mul(cumulativeFundingRate.sub(entryFundingRate)).div(FUNDING_RATE_PRECISION);\n    remainingCollateral = remainingCollateral.sub(fundingFee);\n  }\n\n  return nextSize.mul(BASIS_POINTS_DIVISOR).div(remainingCollateral);\n}\n\nexport function getLiquidationPrice(data) {\n  let {\n    isLong,\n    size,\n    collateral,\n    averagePrice,\n    entryFundingRate,\n    cumulativeFundingRate,\n    sizeDelta,\n    collateralDelta,\n    increaseCollateral,\n    increaseSize,\n    delta,\n    hasProfit,\n    includeDelta,\n  } = data;\n  if (!size || !collateral || !averagePrice) {\n    return;\n  }\n\n  let nextSize = size ? size : bigNumberify(0);\n  let remainingCollateral = collateral;\n\n  if (sizeDelta) {\n    if (increaseSize) {\n      nextSize = size.add(sizeDelta);\n    } else {\n      if (sizeDelta.gte(size)) {\n        return;\n      }\n      nextSize = size.sub(sizeDelta);\n    }\n\n    if (includeDelta && !hasProfit) {\n      const adjustedDelta = sizeDelta.mul(delta).div(size);\n      remainingCollateral = remainingCollateral.sub(adjustedDelta);\n    }\n  }\n\n  if (collateralDelta) {\n    if (increaseCollateral) {\n      remainingCollateral = remainingCollateral.add(collateralDelta);\n    } else {\n      if (collateralDelta.gte(remainingCollateral)) {\n        return;\n      }\n      remainingCollateral = remainingCollateral.sub(collateralDelta);\n    }\n  }\n\n  let positionFee = getMarginFee(size).add(LIQUIDATION_FEE);\n  if (entryFundingRate && cumulativeFundingRate) {\n    const fundingFee = size.mul(cumulativeFundingRate.sub(entryFundingRate)).div(FUNDING_RATE_PRECISION);\n    positionFee = positionFee.add(fundingFee);\n  }\n\n  const liquidationPriceForFees = getLiquidationPriceFromDelta({\n    liquidationAmount: positionFee,\n    size: nextSize,\n    collateral: remainingCollateral,\n    averagePrice,\n    isLong,\n  });\n\n  const liquidationPriceForMaxLeverage = getLiquidationPriceFromDelta({\n    liquidationAmount: nextSize.mul(BASIS_POINTS_DIVISOR).div(MAX_LEVERAGE),\n    size: nextSize,\n    collateral: remainingCollateral,\n    averagePrice,\n    isLong,\n  });\n\n  if (!liquidationPriceForFees) {\n    return liquidationPriceForMaxLeverage;\n  }\n  if (!liquidationPriceForMaxLeverage) {\n    return liquidationPriceForFees;\n  }\n\n  if (isLong) {\n    // return the higher price\n    return liquidationPriceForFees.gt(liquidationPriceForMaxLeverage)\n      ? liquidationPriceForFees\n      : liquidationPriceForMaxLeverage;\n  }\n\n  // return the lower price\n  return liquidationPriceForFees.lt(liquidationPriceForMaxLeverage)\n    ? liquidationPriceForFees\n    : liquidationPriceForMaxLeverage;\n}\n\nexport function getUsd(amount, tokenAddress, max, infoTokens, orderOption, triggerPriceUsd) {\n  if (!amount) {\n    return;\n  }\n  if (tokenAddress === USDG_ADDRESS) {\n    return amount.mul(PRECISION).div(expandDecimals(1, 18));\n  }\n  const info = getTokenInfo(infoTokens, tokenAddress);\n  const price = getTriggerPrice(tokenAddress, max, info, orderOption, triggerPriceUsd);\n  if (!price) {\n    return;\n  }\n\n  return amount.mul(price).div(expandDecimals(1, info.decimals));\n}\n\nexport function getPositionKey(account, collateralTokenAddress, indexTokenAddress, isLong, nativeTokenAddress) {\n  const tokenAddress0 = collateralTokenAddress === AddressZero ? nativeTokenAddress : collateralTokenAddress;\n  const tokenAddress1 = indexTokenAddress === AddressZero ? nativeTokenAddress : indexTokenAddress;\n  return account + \":\" + tokenAddress0 + \":\" + tokenAddress1 + \":\" + isLong;\n}\n\nexport function getPositionContractKey(account, collateralToken, indexToken, isLong) {\n  return ethers.utils.solidityKeccak256(\n    [\"address\", \"address\", \"address\", \"bool\"],\n    [account, collateralToken, indexToken, isLong]\n  );\n}\n\nexport function getSwapFeeBasisPoints(isStable) {\n  return isStable ? STABLE_SWAP_FEE_BASIS_POINTS : SWAP_FEE_BASIS_POINTS;\n}\n\nconst RPC_PROVIDERS = {\n  [ETHEREUM]: ETHEREUM_RPC_PROVIDERS,\n  [ARBITRUM]: ARBITRUM_RPC_PROVIDERS,\n  [ARBITRUM_GOERLI]: ARBITRUM_GOERLI_RPC_PROVIDERS,\n};\n\nconst FALLBACK_PROVIDERS = {\n  [ARBITRUM]: [getFallbackArbitrumRpcUrl()],\n  [ARBITRUM_GOERLI]: [getFallbackArbitrumGoerliRpcUrl()],\n};\n\nexport function shortenAddress(address, length) {\n  if (!length) {\n    return \"\";\n  }\n  if (!address) {\n    return address;\n  }\n  if (address.length < 10) {\n    return address;\n  }\n  let left = Math.floor((length - 3) / 2) + 1;\n  return address.substring(0, left) + \"...\" + address.substring(address.length - (length - (left + 3)), address.length);\n}\n\nexport function formatTimeTill(time) {\n  const dateNow = new Date() / 1000;\n\n  if (time < dateNow) {\n    return \"0d 0h 0s\";\n  }\n\n  const secondsTill = Math.floor(time - dateNow);\n\n  let minutes = Math.floor(secondsTill / 60);\n  let hours = Math.floor(minutes / 60);\n  const days = Math.floor(hours / 24);\n\n  hours = hours - days * 24;\n  minutes = minutes - days * 24 * 60 - hours * 60;\n  return `${days}d ${hours}h ${minutes}m`;\n}\n\nexport function formatDateTime(time) {\n  return formatDateFn(time * 1000, \"dd MMM yyyy, h:mm a\");\n}\n\nexport function getTimeRemaining(time) {\n  const now = parseInt(Date.now() / 1000);\n  if (time < now) {\n    return \"0h 0m\";\n  }\n  const diff = time - now;\n  const hours = parseInt(diff / (60 * 60));\n  const minutes = parseInt((diff - hours * 60 * 60) / 60);\n  return `${hours}h ${minutes}m`;\n}\n\nexport function formatDate(time) {\n  return formatDateFn(time * 1000, \"dd MMM yyyy\");\n}\n\nexport function hasMetaMaskWalletExtension() {\n  return window.ethereum;\n}\n\nexport function hasCoinBaseWalletExtension() {\n  const { ethereum } = window;\n\n  if (!ethereum?.providers && !ethereum?.isCoinbaseWallet) {\n    return false;\n  }\n  return window.ethereum.isCoinbaseWallet || ethereum.providers.find(({ isCoinbaseWallet }) => isCoinbaseWallet);\n}\n\nexport function activateInjectedProvider(providerName) {\n  const { ethereum } = window;\n\n  if (!ethereum?.providers && !ethereum?.isCoinbaseWallet && !ethereum?.isMetaMask) {\n    return undefined;\n  }\n\n  let provider;\n  if (ethereum?.providers) {\n    switch (providerName) {\n      case \"CoinBase\":\n        provider = ethereum.providers.find(({ isCoinbaseWallet }) => isCoinbaseWallet);\n        break;\n      case \"MetaMask\":\n      default:\n        provider = ethereum.providers.find(({ isMetaMask }) => isMetaMask);\n        break;\n    }\n  }\n\n  if (provider) {\n    ethereum.setSelectedProvider(provider);\n  }\n}\n\nexport function getInjectedConnector() {\n  return injectedConnector;\n}\n\nexport function useChainId() {\n  let { chainId } = useWeb3React();\n\n  if (!chainId) {\n    const chainIdFromLocalStorage = localStorage.getItem(SELECTED_NETWORK_LOCAL_STORAGE_KEY);\n    if (chainIdFromLocalStorage) {\n      chainId = parseInt(chainIdFromLocalStorage);\n      if (!chainId) {\n        // localstorage value is invalid\n        localStorage.removeItem(SELECTED_NETWORK_LOCAL_STORAGE_KEY);\n      }\n    }\n  }\n\n  if (!chainId || !supportedChainIds.includes(chainId)) {\n    chainId = DEFAULT_CHAIN_ID;\n  }\n  return { chainId };\n}\n\nexport function useENS(address) {\n  const [ensName, setENSName] = useState();\n\n  useEffect(() => {\n    async function resolveENS() {\n      if (address) {\n        const provider = new ethers.providers.JsonRpcProvider(\"https://rpc.ankr.com/eth\");\n        const name = await provider.lookupAddress(address.toLowerCase());\n        if (name) {\n          setENSName(name);\n        } else {\n          setENSName();\n        }\n      }\n    }\n    resolveENS();\n  }, [address]);\n\n  return { ensName };\n}\n\nexport function clearWalletConnectData() {\n  localStorage.removeItem(WALLET_CONNECT_LOCALSTORAGE_KEY);\n}\n\nexport function clearWalletLinkData() {\n  Object.entries(localStorage)\n    .map((x) => x[0])\n    .filter((x) => x.startsWith(WALLET_LINK_LOCALSTORAGE_PREFIX))\n    .map((x) => localStorage.removeItem(x));\n}\n\nexport function useEagerConnect(setActivatingConnector) {\n  const { activate, active } = useWeb3React();\n  const [tried, setTried] = useState(false);\n\n  useEffect(() => {\n    (async function () {\n      if (Boolean(localStorage.getItem(SHOULD_EAGER_CONNECT_LOCALSTORAGE_KEY)) !== true) {\n        // only works with WalletConnect\n        clearWalletConnectData();\n        // force clear localStorage connection for MM/CB Wallet (Brave legacy)\n        clearWalletLinkData();\n        return;\n      }\n\n      let shouldTryWalletConnect = false;\n      try {\n        // naive validation to not trigger Wallet Connect if data is corrupted\n        const rawData = localStorage.getItem(WALLET_CONNECT_LOCALSTORAGE_KEY);\n        if (rawData) {\n          const data = JSON.parse(rawData);\n          if (data && data.connected) {\n            shouldTryWalletConnect = true;\n          }\n        }\n      } catch (ex) {\n        if (ex instanceof SyntaxError) {\n          // rawData is not a valid json\n          clearWalletConnectData();\n        }\n      }\n\n      if (shouldTryWalletConnect) {\n        try {\n          const connector = getWalletConnectConnector();\n          setActivatingConnector(connector);\n          await activate(connector, undefined, true);\n          // in case Wallet Connect is activated no need to check injected wallet\n          return;\n        } catch (ex) {\n          // assume data in localstorage is corrupted and delete it to not retry on next page load\n          clearWalletConnectData();\n        }\n      }\n\n      try {\n        const connector = getInjectedConnector();\n        const currentProviderName = localStorage.getItem(CURRENT_PROVIDER_LOCALSTORAGE_KEY) ?? false;\n        if (currentProviderName !== false) {\n          activateInjectedProvider(currentProviderName);\n        }\n        const authorized = await connector.isAuthorized();\n        if (authorized) {\n          setActivatingConnector(connector);\n          await activate(connector, undefined, true);\n        }\n      } catch (ex) {}\n\n      setTried(true);\n    })();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []); // intentionally only running on mount (make sure it's only mounted once :))\n\n  // if the connection worked, wait until we get confirmation of that to flip the flag\n  useEffect(() => {\n    if (!tried && active) {\n      setTried(true);\n    }\n  }, [tried, active]);\n\n  return tried;\n}\n\nexport function useInactiveListener(suppress = false) {\n  const injected = getInjectedConnector();\n  const { active, error, activate } = useWeb3React();\n\n  useEffect(() => {\n    const { ethereum } = window;\n    if (ethereum && ethereum.on && !active && !error && !suppress) {\n      const handleConnect = () => {\n        activate(injected);\n      };\n      const handleChainChanged = (chainId) => {\n        activate(injected);\n      };\n      const handleAccountsChanged = (accounts) => {\n        if (accounts.length > 0) {\n          activate(injected);\n        }\n      };\n      const handleNetworkChanged = (networkId) => {\n        activate(injected);\n      };\n\n      ethereum.on(\"connect\", handleConnect);\n      ethereum.on(\"chainChanged\", handleChainChanged);\n      ethereum.on(\"accountsChanged\", handleAccountsChanged);\n      ethereum.on(\"networkChanged\", handleNetworkChanged);\n\n      return () => {\n        if (ethereum.removeListener) {\n          ethereum.removeListener(\"connect\", handleConnect);\n          ethereum.removeListener(\"chainChanged\", handleChainChanged);\n          ethereum.removeListener(\"accountsChanged\", handleAccountsChanged);\n          ethereum.removeListener(\"networkChanged\", handleNetworkChanged);\n        }\n      };\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [active, error, suppress, activate]);\n}\n\nexport function getProvider(library, chainId) {\n  let provider;\n  if (library) {\n    return library.getSigner();\n  }\n  provider = _.sample(RPC_PROVIDERS[chainId]);\n  return new ethers.providers.StaticJsonRpcProvider(provider, { chainId });\n}\n\nexport function getFallbackProvider(chainId) {\n  if (!FALLBACK_PROVIDERS[chainId]) {\n    return;\n  }\n\n  const provider = _.sample(FALLBACK_PROVIDERS[chainId]);\n  return new ethers.providers.StaticJsonRpcProvider(provider, { chainId });\n}\n\nexport const getContractCall = ({ provider, contractInfo, arg0, arg1, method, params, additionalArgs, onError }) => {\n  if (ethers.utils.isAddress(arg0)) {\n    const address = arg0;\n    const contract = new ethers.Contract(address, contractInfo.abi, provider);\n\n    if (additionalArgs) {\n      return contract[method](...params.concat(additionalArgs));\n    }\n    return contract[method](...params);\n  }\n\n  if (!provider) {\n    return;\n  }\n\n  return provider[method](arg1, ...params);\n};\n\n// prettier-ignore\nexport const fetcher = (library, contractInfo, additionalArgs) => (...args) => {\n  // eslint-disable-next-line\n  const [id, chainId, arg0, arg1, ...params] = args;\n  const provider = getProvider(library, chainId);\n\n  const method = ethers.utils.isAddress(arg0) ? arg1 : arg0;\n\n  const contractCall = getContractCall({\n    provider,\n    contractInfo,\n    arg0,\n    arg1,\n    method,\n    params,\n    additionalArgs,\n  })\n\n  let shouldCallFallback = true\n\n  const handleFallback = async (resolve, reject, error) => {\n    if (!shouldCallFallback) {\n      return\n    }\n    // prevent fallback from being called twice\n    shouldCallFallback = false\n\n    const fallbackProvider = getFallbackProvider(chainId)\n    if (!fallbackProvider) {\n      reject(error)\n      return\n    }\n\n    console.info(\"using fallbackProvider for\", method)\n    const fallbackContractCall = getContractCall({\n      provider: fallbackProvider,\n      contractInfo,\n      arg0,\n      arg1,\n      method,\n      params,\n      additionalArgs,\n    })\n\n    fallbackContractCall.then((result) => resolve(result)).catch((e) => {\n      console.error(\"fallback fetcher error\", id, contractInfo.contractName, method, e);\n      reject(e)\n    })\n  }\n\n  return new Promise(async (resolve, reject) => {\n    contractCall.then((result) => {\n      shouldCallFallback = false\n      resolve(result)\n    }).catch((e) => {\n      console.error(\"fetcher error\", id, contractInfo.contractName, method, e);\n      handleFallback(resolve, reject, e)\n    })\n\n    setTimeout(() => {\n      handleFallback(resolve, reject, \"contractCall timeout\")\n    }, 2000)\n  })\n};\n\nexport function bigNumberify(n) {\n  return ethers.BigNumber.from(n);\n}\n\nexport function expandDecimals(n, decimals) {\n  return bigNumberify(n).mul(bigNumberify(10).pow(decimals));\n}\n\nexport const trimZeroDecimals = (amount) => {\n  if (parseFloat(amount) === parseInt(amount)) {\n    return parseInt(amount).toString();\n  }\n  return amount;\n};\n\nexport const limitDecimals = (amount, maxDecimals) => {\n  let amountStr = amount.toString();\n  if (maxDecimals === undefined) {\n    return amountStr;\n  }\n  if (maxDecimals === 0) {\n    return amountStr.split(\".\")[0];\n  }\n  const dotIndex = amountStr.indexOf(\".\");\n  if (dotIndex !== -1) {\n    let decimals = amountStr.length - dotIndex - 1;\n    if (decimals > maxDecimals) {\n      amountStr = amountStr.substr(0, amountStr.length - (decimals - maxDecimals));\n    }\n  }\n  return amountStr;\n};\n\nexport const padDecimals = (amount, minDecimals) => {\n  let amountStr = amount.toString();\n  const dotIndex = amountStr.indexOf(\".\");\n  if (dotIndex !== -1) {\n    const decimals = amountStr.length - dotIndex - 1;\n    if (decimals < minDecimals) {\n      amountStr = amountStr.padEnd(amountStr.length + (minDecimals - decimals), \"0\");\n    }\n  } else {\n    amountStr = amountStr + Number(0).toFixed(minDecimals).slice(1);\n  }\n  return amountStr;\n};\n\nexport const formatKeyAmount = (map, key, tokenDecimals, displayDecimals, useCommas) => {\n  if (!map || !map[key]) {\n    return \"...\";\n  }\n\n  return formatAmount(map[key], tokenDecimals, displayDecimals, useCommas);\n};\n\nexport const formatArrayAmount = (arr, index, tokenDecimals, displayDecimals, useCommas) => {\n  if (!arr || !arr[index]) {\n    return \"...\";\n  }\n\n  return formatAmount(arr[index], tokenDecimals, displayDecimals, useCommas);\n};\n\nfunction _parseOrdersData(ordersData, account, indexes, extractor, uintPropsLength, addressPropsLength) {\n  if (!ordersData || ordersData.length === 0) {\n    return [];\n  }\n  const [uintProps, addressProps] = ordersData;\n  const count = uintProps.length / uintPropsLength;\n\n  const orders = [];\n  for (let i = 0; i < count; i++) {\n    const sliced = addressProps\n      .slice(addressPropsLength * i, addressPropsLength * (i + 1))\n      .concat(uintProps.slice(uintPropsLength * i, uintPropsLength * (i + 1)));\n\n    if (sliced[0] === AddressZero && sliced[1] === AddressZero) {\n      continue;\n    }\n\n    const order = extractor(sliced);\n    order.index = indexes[i];\n    order.account = account;\n    orders.push(order);\n  }\n\n  return orders;\n}\n\nfunction parseDecreaseOrdersData(chainId, decreaseOrdersData, account, indexes) {\n  const extractor = (sliced) => {\n    const isLong = sliced[4].toString() === \"1\";\n    return {\n      collateralToken: sliced[0],\n      indexToken: sliced[1],\n      collateralDelta: sliced[2],\n      sizeDelta: sliced[3],\n      isLong,\n      triggerPrice: sliced[5],\n      triggerAboveThreshold: sliced[6].toString() === \"1\",\n      type: DECREASE,\n    };\n  };\n  return _parseOrdersData(decreaseOrdersData, account, indexes, extractor, 5, 2).filter((order) => {\n    return isValidToken(chainId, order.collateralToken) && isValidToken(chainId, order.indexToken);\n  });\n}\n\nfunction parseIncreaseOrdersData(chainId, increaseOrdersData, account, indexes) {\n  const extractor = (sliced) => {\n    const isLong = sliced[5].toString() === \"1\";\n    return {\n      purchaseToken: sliced[0],\n      collateralToken: sliced[1],\n      indexToken: sliced[2],\n      purchaseTokenAmount: sliced[3],\n      sizeDelta: sliced[4],\n      isLong,\n      triggerPrice: sliced[6],\n      triggerAboveThreshold: sliced[7].toString() === \"1\",\n      type: INCREASE,\n    };\n  };\n  return _parseOrdersData(increaseOrdersData, account, indexes, extractor, 5, 3).filter((order) => {\n    return (\n      isValidToken(chainId, order.purchaseToken) &&\n      isValidToken(chainId, order.collateralToken) &&\n      isValidToken(chainId, order.indexToken)\n    );\n  });\n}\n\nfunction parseSwapOrdersData(chainId, swapOrdersData, account, indexes) {\n  if (!swapOrdersData || !swapOrdersData.length) {\n    return [];\n  }\n\n  const extractor = (sliced) => {\n    const triggerAboveThreshold = sliced[6].toString() === \"1\";\n    const shouldUnwrap = sliced[7].toString() === \"1\";\n\n    return {\n      path: [sliced[0], sliced[1], sliced[2]].filter((address) => address !== AddressZero),\n      amountIn: sliced[3],\n      minOut: sliced[4],\n      triggerRatio: sliced[5],\n      triggerAboveThreshold,\n      type: SWAP,\n      shouldUnwrap,\n    };\n  };\n  return _parseOrdersData(swapOrdersData, account, indexes, extractor, 5, 3).filter((order) => {\n    return order.path.every((token) => isValidToken(chainId, token));\n  });\n}\n\nexport function getOrderKey(order) {\n  return `${order.type}-${order.account}-${order.index}`;\n}\n\nexport function useAccountOrders(flagOrdersEnabled, overrideAccount) {\n  const { library, account: connectedAccount } = useWeb3React();\n  const active = true; // this is used in Actions.js so set active to always be true\n  const account = overrideAccount || connectedAccount;\n\n  const { chainId } = useChainId();\n  const shouldRequest = active && account && flagOrdersEnabled;\n\n  const orderBookAddress = getContract(chainId, \"OrderBook\");\n  const orderBookReaderAddress = getContract(chainId, \"OrderBookReader\");\n  const key = shouldRequest ? [active, chainId, orderBookAddress, account] : false;\n  const {\n    data: orders = [],\n    mutate: updateOrders,\n    error: ordersError,\n  } = useSWR(key, {\n    dedupingInterval: 5000,\n    fetcher: async (active, chainId, orderBookAddress, account) => {\n      const provider = getProvider(library, chainId);\n      const orderBookContract = new ethers.Contract(orderBookAddress, OrderBook.abi, provider);\n      const orderBookReaderContract = new ethers.Contract(orderBookReaderAddress, OrderBookReader.abi, provider);\n\n      const fetchLastIndex = async (type) => {\n        const method = type.toLowerCase() + \"OrdersIndex\";\n        return await orderBookContract[method](account).then((res) => bigNumberify(res._hex).toNumber());\n      };\n\n      const fetchLastIndexes = async () => {\n        const [swap, increase, decrease] = await Promise.all([\n          fetchLastIndex(\"swap\"),\n          fetchLastIndex(\"increase\"),\n          fetchLastIndex(\"decrease\"),\n        ]);\n\n        return { swap, increase, decrease };\n      };\n\n      const getRange = (to, from) => {\n        const LIMIT = 10;\n        const _indexes = [];\n        from = from || Math.max(to - LIMIT, 0);\n        for (let i = to - 1; i >= from; i--) {\n          _indexes.push(i);\n        }\n        return _indexes;\n      };\n\n      const getIndexes = (knownIndexes, lastIndex) => {\n        if (knownIndexes.length === 0) {\n          return getRange(lastIndex);\n        }\n        return [\n          ...knownIndexes,\n          ...getRange(lastIndex, knownIndexes[knownIndexes.length - 1] + 1).sort((a, b) => b - a),\n        ];\n      };\n\n      const getOrders = async (method, knownIndexes, lastIndex, parseFunc) => {\n        const indexes = getIndexes(knownIndexes, lastIndex);\n        const ordersData = await orderBookReaderContract[method](orderBookAddress, account, indexes);\n        const orders = parseFunc(chainId, ordersData, account, indexes);\n\n        return orders;\n      };\n\n      try {\n        const lastIndexes = await fetchLastIndexes();\n        const serverIndexes = { swap: [], increase: [], decrease: [] };\n\n        const [swapOrders = [], increaseOrders = [], decreaseOrders = []] = await Promise.all([\n          getOrders(\"getSwapOrders\", serverIndexes.swap, lastIndexes.swap, parseSwapOrdersData),\n          getOrders(\"getIncreaseOrders\", serverIndexes.increase, lastIndexes.increase, parseIncreaseOrdersData),\n          getOrders(\"getDecreaseOrders\", serverIndexes.decrease, lastIndexes.decrease, parseDecreaseOrdersData),\n        ]);\n        return [...swapOrders, ...increaseOrders, ...decreaseOrders];\n      } catch (ex) {\n        console.error(ex);\n      }\n    },\n  });\n\n  return [orders, updateOrders, ordersError];\n}\n\nexport const formatAmount = (amount, tokenDecimals, displayDecimals, useCommas, defaultValue) => {\n  if (!defaultValue) {\n    defaultValue = \"...\";\n  }\n  if (amount === undefined || amount.toString().length === 0) {\n    return defaultValue;\n  }\n  if (displayDecimals === undefined) {\n    displayDecimals = 4;\n  }\n  let amountStr = ethers.utils.formatUnits(amount, tokenDecimals);\n  amountStr = limitDecimals(amountStr, displayDecimals);\n  if (displayDecimals !== 0) {\n    amountStr = padDecimals(amountStr, displayDecimals);\n  }\n  if (useCommas) {\n    return numberWithCommas(amountStr);\n  }\n  return amountStr;\n};\n\nexport const formatAmountFree = (amount, tokenDecimals, displayDecimals) => {\n  if (!amount) {\n    return \"...\";\n  }\n  let amountStr = ethers.utils.formatUnits(amount, tokenDecimals);\n  amountStr = limitDecimals(amountStr, displayDecimals);\n  return trimZeroDecimals(amountStr);\n};\n\nexport const parseValue = (value, tokenDecimals) => {\n  const pValue = parseFloat(value);\n  if (isNaN(pValue)) {\n    return undefined;\n  }\n  value = limitDecimals(value, tokenDecimals);\n  const amount = ethers.utils.parseUnits(value, tokenDecimals);\n  return bigNumberify(amount);\n};\n\nexport function numberWithCommas(x) {\n  if (!x) {\n    return \"...\";\n  }\n  var parts = x.toString().split(\".\");\n  parts[0] = parts[0].replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\n  return parts.join(\".\");\n}\n\nexport function getExplorerUrl(chainId) {\n  if (chainId === 3) {\n    return \"https://ropsten.etherscan.io/\";\n  } else if (chainId === 42) {\n    return \"https://kovan.etherscan.io/\";\n  } else if (chainId === ARBITRUM_GOERLI) {\n    return \"https://goerli-rollup-explorer.arbitrum.io/\";\n  } else if (chainId === ARBITRUM) {\n    return \"https://arbiscan.io/\";\n  }\n  return \"https://etherscan.io/\";\n}\n\nexport function getAccountUrl(chainId, account) {\n  if (!account) {\n    return getExplorerUrl(chainId);\n  }\n  return getExplorerUrl(chainId) + \"address/\" + account;\n}\n\nexport function getTokenUrl(chainId, address) {\n  if (!address) {\n    return getExplorerUrl(chainId);\n  }\n  return getExplorerUrl(chainId) + \"token/\" + address;\n}\n\nexport function usePrevious(value) {\n  const ref = useRef();\n  useEffect(() => {\n    ref.current = value;\n  });\n  return ref.current;\n}\n\nexport async function setGasPrice(txnOpts, provider, chainId) {\n  let maxGasPrice = MAX_GAS_PRICE_MAP[chainId];\n  const premium = GAS_PRICE_ADJUSTMENT_MAP[chainId] || bigNumberify(0);\n\n  if (maxGasPrice) {\n    const gasPrice = await provider.getGasPrice();\n    if (gasPrice.gt(maxGasPrice)) {\n      maxGasPrice = gasPrice;\n    }\n\n    const feeData = await provider.getFeeData();\n    txnOpts.maxFeePerGas = maxGasPrice;\n    txnOpts.maxPriorityFeePerGas = feeData.maxPriorityFeePerGas.add(premium);\n  } else {\n    const gasPrice = await provider.getGasPrice();\n    txnOpts.gasPrice = gasPrice.add(premium);\n  }\n}\n\nexport async function getGasLimit(contract, method, params = [], value, gasBuffer) {\n  const defaultGasBuffer = 300000;\n  const defaultValue = bigNumberify(0);\n\n  if (!value) {\n    value = defaultValue;\n  }\n\n  let gasLimit = await contract.estimateGas[method](...params, { value });\n\n  if (!gasBuffer) {\n    gasBuffer = defaultGasBuffer;\n  }\n\n  return gasLimit.add(gasBuffer);\n}\n\nexport function approveTokens({\n  setIsApproving,\n  library,\n  tokenAddress,\n  spender,\n  chainId,\n  onApproveSubmitted,\n  getTokenInfo,\n  infoTokens,\n  pendingTxns,\n  setPendingTxns,\n  includeMessage,\n}) {\n  setIsApproving(true);\n  const contract = new ethers.Contract(tokenAddress, Token.abi, library.getSigner());\n  contract\n    .approve(spender, ethers.constants.MaxUint256)\n    .then(async (res) => {\n      const txUrl = getExplorerUrl(chainId) + \"tx/\" + res.hash;\n      helperToast.success(\n        <div>\n          Approval submitted!{\" \"}\n          <a href={txUrl} target=\"_blank\" rel=\"noopener noreferrer\">\n            View status.\n          </a>\n          <br />\n        </div>\n      );\n      if (onApproveSubmitted) {\n        onApproveSubmitted();\n      }\n      if (getTokenInfo && infoTokens && pendingTxns && setPendingTxns) {\n        const token = getTokenInfo(infoTokens, tokenAddress);\n        const pendingTxn = {\n          hash: res.hash,\n          message: includeMessage ? `${token.symbol} Approved!` : false,\n        };\n        setPendingTxns([...pendingTxns, pendingTxn]);\n      }\n    })\n    .catch((e) => {\n      console.error(e);\n      let failMsg;\n      if (\n        [\"not enough funds for gas\", \"failed to execute call with revert code InsufficientGasFunds\"].includes(\n          e.data?.message\n        )\n      ) {\n        failMsg = (\n          <div>\n            There is not enough ETH in your account on Arbitrum to send this transaction.\n            <br />\n            <br />\n            <a href={\"https://arbitrum.io/bridge-tutorial/\"} target=\"_blank\" rel=\"noopener noreferrer\">\n              Bridge ETH to Arbitrum\n            </a>\n          </div>\n        );\n      } else if (e.message?.includes(\"User denied transaction signature\")) {\n        failMsg = \"Approval was cancelled.\";\n      } else {\n        failMsg = \"Approval failed.\";\n      }\n      helperToast.error(failMsg);\n    })\n    .finally(() => {\n      setIsApproving(false);\n    });\n}\n\nexport const shouldRaiseGasError = (token, amount) => {\n  if (!amount) {\n    return false;\n  }\n  if (token.address !== AddressZero) {\n    return false;\n  }\n  if (!token.balance) {\n    return false;\n  }\n  if (amount.gte(token.balance)) {\n    return true;\n  }\n  if (token.balance.sub(amount).lt(DUST_BNB)) {\n    return true;\n  }\n  return false;\n};\n\nexport const getTokenInfo = (infoTokens, tokenAddress, replaceNative, nativeTokenAddress) => {\n  if (replaceNative && tokenAddress === nativeTokenAddress) {\n    return infoTokens[AddressZero];\n  }\n  return infoTokens[tokenAddress];\n};\n\nconst NETWORK_METADATA = {\n  [ARBITRUM_GOERLI]: {\n    chainId: \"0x\" + ARBITRUM_GOERLI.toString(16),\n    chainName: \"Arbitrum Goerli\",\n    nativeCurrency: {\n      name: \"ETH\",\n      symbol: \"ETH\",\n      decimals: 18,\n    },\n    rpcUrls: ARBITRUM_GOERLI_RPC_PROVIDERS,\n    blockExplorerUrls: [getExplorerUrl(ARBITRUM_GOERLI)],\n  },\n  [ARBITRUM]: {\n    chainId: \"0x\" + ARBITRUM.toString(16),\n    chainName: \"Arbitrum\",\n    nativeCurrency: {\n      name: \"ETH\",\n      symbol: \"ETH\",\n      decimals: 18,\n    },\n    rpcUrls: ARBITRUM_RPC_PROVIDERS,\n    blockExplorerUrls: [getExplorerUrl(ARBITRUM)],\n  },\n};\n\nexport const addNetwork = async (metadata) => {\n  await window.ethereum.request({ method: \"wallet_addEthereumChain\", params: [metadata] }).catch();\n};\n\nexport const switchNetwork = async (chainId, active) => {\n  if (!active) {\n    // chainId in localStorage allows to switch network even if wallet is not connected\n    // or there is no wallet at all\n    localStorage.setItem(SELECTED_NETWORK_LOCAL_STORAGE_KEY, chainId);\n    document.location.reload();\n    return;\n  }\n\n  try {\n    const chainIdHex = \"0x\" + chainId.toString(16);\n    await window.ethereum.request({\n      method: \"wallet_switchEthereumChain\",\n      params: [{ chainId: chainIdHex }],\n    });\n    helperToast.success(\"Connected to \" + getChainName(chainId));\n    return getChainName(chainId);\n  } catch (ex) {\n    // https://docs.metamask.io/guide/rpc-api.html#other-rpc-methods\n    // This error code indicates that the chain has not been added to MetaMask.\n    // 4001 error means user has denied the request\n    // If the error code is not 4001, then we need to add the network\n    if (ex.code !== 4001) {\n      return await addNetwork(NETWORK_METADATA[chainId]);\n    }\n\n    console.error(\"error\", ex);\n  }\n};\n\nexport const getWalletConnectHandler = (activate, deactivate, setActivatingConnector) => {\n  const fn = async () => {\n    const walletConnect = getWalletConnectConnector();\n    setActivatingConnector(walletConnect);\n    activate(walletConnect, (ex) => {\n      if (ex instanceof UnsupportedChainIdError) {\n        helperToast.error(\"Unsupported chain. Switch to Arbitrum network on your wallet and try again\");\n        console.warn(ex);\n      } else if (!(ex instanceof UserRejectedRequestErrorWalletConnect)) {\n        helperToast.error(ex.message);\n        console.warn(ex);\n      }\n      clearWalletConnectData();\n      deactivate();\n    });\n  };\n  return fn;\n};\n\nexport const getInjectedHandler = (activate) => {\n  const fn = async () => {\n    activate(getInjectedConnector(), (e) => {\n      const chainId = localStorage.getItem(SELECTED_NETWORK_LOCAL_STORAGE_KEY) || DEFAULT_CHAIN_ID;\n\n      if (e instanceof UnsupportedChainIdError) {\n        helperToast.error(\n          <div>\n            <div>Your wallet is not connected to {getChainName(chainId)}.</div>\n            <br />\n            <div className=\"clickable underline margin-bottom\" onClick={() => switchNetwork(chainId, true)}>\n              Switch to {getChainName(chainId)}\n            </div>\n            <div className=\"clickable underline\" onClick={() => switchNetwork(chainId, true)}>\n              Add {getChainName(chainId)}\n            </div>\n          </div>\n        );\n        return;\n      }\n      const errString = e.message ?? e.toString();\n      helperToast.error(errString);\n    });\n  };\n  return fn;\n};\n\nexport function isMobileDevice(navigator) {\n  return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\n}\n\nexport function setTokenUsingIndexPrices(token, indexPrices, nativeTokenAddress) {\n  if (!indexPrices) {\n    return;\n  }\n\n  const tokenAddress = token.isNative ? nativeTokenAddress : token.address;\n\n  const indexPrice = indexPrices[tokenAddress];\n  if (!indexPrice) {\n    return;\n  }\n\n  const indexPriceBn = bigNumberify(indexPrice);\n  if (indexPriceBn.eq(0)) {\n    return;\n  }\n\n  const spread = token.maxPrice.sub(token.minPrice);\n  const spreadBps = spread.mul(BASIS_POINTS_DIVISOR).div(token.maxPrice);\n\n  if (spreadBps.gt(MAX_PRICE_DEVIATION_BASIS_POINTS - 1)) {\n    // only set of the values as there will be a spread between the index price and the Chainlink price\n    if (indexPriceBn.gt(token.minPrimaryPrice)) {\n      token.maxPrice = indexPriceBn;\n    } else {\n      token.minPrice = indexPriceBn;\n    }\n    return;\n  }\n\n  const halfSpreadBps = spreadBps.div(2).toNumber();\n  token.maxPrice = indexPriceBn.mul(BASIS_POINTS_DIVISOR + halfSpreadBps).div(BASIS_POINTS_DIVISOR);\n  token.minPrice = indexPriceBn.mul(BASIS_POINTS_DIVISOR - halfSpreadBps).div(BASIS_POINTS_DIVISOR);\n}\n\nexport const CHART_PERIODS = {\n  \"5m\": 60 * 5,\n  \"15m\": 60 * 15,\n  \"1h\": 60 * 60,\n  \"4h\": 60 * 60 * 4,\n  \"1d\": 60 * 60 * 24,\n};\n\nexport function getTotalVolumeSum(volumes) {\n  if (!volumes || volumes.length === 0) {\n    return;\n  }\n\n  let volume = bigNumberify(0);\n  for (let i = 0; i < volumes.length; i++) {\n    volume = volume.add(volumes[i].data.volume);\n  }\n\n  return volume;\n}\n\nexport function getBalanceAndSupplyData(balances) {\n  if (!balances || balances.length === 0) {\n    return {};\n  }\n\n  const keys = [\"myc\", \"esMyc\", \"mlp\", \"stakedMycTracker\"];\n  const balanceData = {};\n  const supplyData = {};\n  const propsLength = 2;\n\n  for (let i = 0; i < keys.length; i++) {\n    const key = keys[i];\n    balanceData[key] = balances[i * propsLength];\n    supplyData[key] = balances[i * propsLength + 1];\n  }\n\n  return { balanceData, supplyData };\n}\n\nexport function getDepositBalanceData(depositBalances) {\n  if (!depositBalances || depositBalances.length === 0) {\n    return;\n  }\n\n  const keys = [\n    \"mycInStakedMyc\",\n    \"esMycInStakedMyc\",\n    \"stakedMycInBonusMyc\",\n    \"bonusMycInFeeMyc\",\n    \"bnMycInFeeMyc\",\n    \"mlpInStakedMlp\",\n  ];\n  const data = {};\n\n  for (let i = 0; i < keys.length; i++) {\n    const key = keys[i];\n    data[key] = depositBalances[i];\n  }\n\n  return data;\n}\n\nexport function getVestingData(vestingInfo) {\n  if (!vestingInfo || vestingInfo.length === 0) {\n    return;\n  }\n\n  const keys = [\"mycVester\", \"mlpVester\"];\n  const data = {};\n  const propsLength = 7;\n\n  for (let i = 0; i < keys.length; i++) {\n    const key = keys[i];\n    data[key] = {\n      pairAmount: vestingInfo[i * propsLength],\n      vestedAmount: vestingInfo[i * propsLength + 1],\n      escrowedBalance: vestingInfo[i * propsLength + 2],\n      claimedAmounts: vestingInfo[i * propsLength + 3],\n      claimable: vestingInfo[i * propsLength + 4],\n      maxVestableAmount: vestingInfo[i * propsLength + 5],\n      averageStakedAmount: vestingInfo[i * propsLength + 6],\n    };\n\n    data[key + \"PairAmount\"] = data[key].pairAmount;\n    data[key + \"VestedAmount\"] = data[key].vestedAmount;\n    data[key + \"EscrowedBalance\"] = data[key].escrowedBalance;\n    data[key + \"ClaimSum\"] = data[key].claimedAmounts.add(data[key].claimable);\n    data[key + \"Claimable\"] = data[key].claimable;\n    data[key + \"MaxVestableAmount\"] = data[key].maxVestableAmount;\n    data[key + \"AverageStakedAmount\"] = data[key].averageStakedAmount;\n  }\n\n  return data;\n}\n\nexport function getStakingData(stakingInfo) {\n  if (!stakingInfo || stakingInfo.length === 0) {\n    return;\n  }\n\n  const keys = [\"stakedMycTracker\", \"bonusMycTracker\", \"feeMycTracker\", \"stakedMlpTracker\", \"feeMlpTracker\"];\n  const data = {};\n  const propsLength = 5;\n\n  for (let i = 0; i < keys.length; i++) {\n    const key = keys[i];\n    data[key] = {\n      claimable: stakingInfo[i * propsLength],\n      tokensPerInterval: stakingInfo[i * propsLength + 1],\n      averageStakedAmounts: stakingInfo[i * propsLength + 2],\n      cumulativeRewards: stakingInfo[i * propsLength + 3],\n      totalSupply: stakingInfo[i * propsLength + 4],\n    };\n  }\n\n  return data;\n}\n\nexport function getProcessedData(\n  balanceData,\n  supplyData,\n  depositBalanceData,\n  stakingData,\n  vestingData,\n  aum,\n  nativeTokenPrice,\n  stakedMycSupply,\n  mycPrice,\n  mycSupply\n) {\n  if (\n    !balanceData ||\n    !supplyData ||\n    !depositBalanceData ||\n    !stakingData ||\n    !vestingData ||\n    !aum ||\n    !nativeTokenPrice ||\n    !stakedMycSupply ||\n    !mycPrice ||\n    !mycSupply\n  ) {\n    return {};\n  }\n\n  const data = {};\n\n  data.mycBalance = balanceData.myc;\n  data.mycBalanceUsd = balanceData.myc.mul(mycPrice).div(expandDecimals(1, 18));\n\n  data.mycSupply = bigNumberify(mycSupply);\n\n  data.mycSupplyUsd = data.mycSupply.mul(mycPrice).div(expandDecimals(1, 18));\n  data.stakedMycSupply = stakedMycSupply;\n  data.stakedMycSupplyUsd = stakedMycSupply.mul(mycPrice).div(expandDecimals(1, 18));\n  data.mycInStakedMyc = depositBalanceData.mycInStakedMyc;\n  data.mycInStakedMycUsd = depositBalanceData.mycInStakedMyc.mul(mycPrice).div(expandDecimals(1, 18));\n\n  data.esMycBalance = balanceData.esMyc;\n  data.esMycBalanceUsd = balanceData.esMyc.mul(mycPrice).div(expandDecimals(1, 18));\n\n  data.stakedMycTrackerSupply = supplyData.stakedMycTracker;\n  data.stakedMycTrackerSupplyUsd = supplyData.stakedMycTracker.mul(mycPrice).div(expandDecimals(1, 18));\n  data.stakedEsMycSupply = data.stakedMycTrackerSupply.sub(data.stakedMycSupply);\n  data.stakedEsMycSupplyUsd = data.stakedEsMycSupply.mul(mycPrice).div(expandDecimals(1, 18));\n\n  data.esMycInStakedMyc = depositBalanceData.esMycInStakedMyc;\n  data.esMycInStakedMycUsd = depositBalanceData.esMycInStakedMyc.mul(mycPrice).div(expandDecimals(1, 18));\n\n  data.bnMycInFeeMyc = depositBalanceData.bnMycInFeeMyc;\n  data.bonusMycInFeeMyc = depositBalanceData.bonusMycInFeeMyc;\n  data.feeMycSupply = stakingData.feeMycTracker.totalSupply;\n  data.feeMycSupplyUsd = data.feeMycSupply.mul(mycPrice).div(expandDecimals(1, 18));\n\n  data.stakedMycTrackerRewards = stakingData.stakedMycTracker.claimable;\n  data.stakedMycTrackerRewardsUsd = stakingData.stakedMycTracker.claimable.mul(mycPrice).div(expandDecimals(1, 18));\n\n  data.bonusMycTrackerRewards = stakingData.bonusMycTracker.claimable;\n\n  data.feeMycTrackerRewards = stakingData.feeMycTracker.claimable;\n  data.feeMycTrackerRewardsUsd = stakingData.feeMycTracker.claimable.mul(nativeTokenPrice).div(expandDecimals(1, 18));\n\n  data.boostBasisPoints = bigNumberify(0);\n  if (data && data.bnMycInFeeMyc && data.bonusMycInFeeMyc && data.bonusMycInFeeMyc.gt(0)) {\n    data.boostBasisPoints = data.bnMycInFeeMyc.mul(BASIS_POINTS_DIVISOR).div(data.bonusMycInFeeMyc);\n  }\n\n  data.stakedMycTrackerAnnualRewardsUsd = stakingData.stakedMycTracker.tokensPerInterval\n    .mul(SECONDS_PER_YEAR)\n    .mul(mycPrice)\n    .div(expandDecimals(1, 18));\n  data.mycAprForEsMyc =\n    data.stakedMycTrackerSupplyUsd && data.stakedMycTrackerSupplyUsd.gt(0)\n      ? data.stakedMycTrackerAnnualRewardsUsd.mul(BASIS_POINTS_DIVISOR).div(data.stakedMycTrackerSupplyUsd)\n      : bigNumberify(0);\n  data.feeMycTrackerAnnualRewardsUsd = stakingData.feeMycTracker.tokensPerInterval\n    .mul(SECONDS_PER_YEAR)\n    .mul(nativeTokenPrice)\n    .div(expandDecimals(1, 18));\n  data.mycAprForNativeToken =\n    data.feeMycSupplyUsd && data.feeMycSupplyUsd.gt(0)\n      ? data.feeMycTrackerAnnualRewardsUsd.mul(BASIS_POINTS_DIVISOR).div(data.feeMycSupplyUsd)\n      : bigNumberify(0);\n  data.mycBoostAprForNativeToken = data.mycAprForNativeToken.mul(data.boostBasisPoints).div(BASIS_POINTS_DIVISOR);\n  data.mycAprTotal = data.mycAprForNativeToken.add(data.mycAprForEsMyc);\n  data.mycAprTotalWithBoost = data.mycAprForNativeToken.add(data.mycBoostAprForNativeToken).add(data.mycAprForEsMyc);\n  data.mycAprForNativeTokenWithBoost = data.mycAprForNativeToken.add(data.mycBoostAprForNativeToken);\n\n  data.totalMycRewardsUsd = data.stakedMycTrackerRewardsUsd.add(data.feeMycTrackerRewardsUsd);\n\n  data.mlpSupply = supplyData.mlp;\n  data.mlpPrice =\n    data.mlpSupply && data.mlpSupply.gt(0)\n      ? aum.mul(expandDecimals(1, MLP_DECIMALS)).div(data.mlpSupply)\n      : bigNumberify(0);\n\n  data.mlpSupplyUsd = supplyData.mlp.mul(data.mlpPrice).div(expandDecimals(1, 18));\n\n  data.mlpBalance = depositBalanceData.mlpInStakedMlp;\n  data.mlpBalanceUsd = depositBalanceData.mlpInStakedMlp.mul(data.mlpPrice).div(expandDecimals(1, MLP_DECIMALS));\n\n  data.stakedMlpTrackerRewards = stakingData.stakedMlpTracker.claimable;\n  data.stakedMlpTrackerRewardsUsd = stakingData.stakedMlpTracker.claimable.mul(mycPrice).div(expandDecimals(1, 18));\n\n  data.feeMlpTrackerRewards = stakingData.feeMlpTracker.claimable;\n  data.feeMlpTrackerRewardsUsd = stakingData.feeMlpTracker.claimable.mul(nativeTokenPrice).div(expandDecimals(1, 18));\n\n  data.stakedMlpTrackerAnnualRewardsUsd = stakingData.stakedMlpTracker.tokensPerInterval\n    .mul(SECONDS_PER_YEAR)\n    .mul(mycPrice)\n    .div(expandDecimals(1, 18));\n  data.mlpAprForEsMyc =\n    data.mlpSupplyUsd && data.mlpSupplyUsd.gt(0)\n      ? data.stakedMlpTrackerAnnualRewardsUsd.mul(BASIS_POINTS_DIVISOR).div(data.mlpSupplyUsd)\n      : bigNumberify(0);\n  data.feeMlpTrackerAnnualRewardsUsd = stakingData.feeMlpTracker.tokensPerInterval\n    .mul(SECONDS_PER_YEAR)\n    .mul(nativeTokenPrice)\n    .div(expandDecimals(1, 18));\n  data.mlpAprForNativeToken =\n    data.mlpSupplyUsd && data.mlpSupplyUsd.gt(0)\n      ? data.feeMlpTrackerAnnualRewardsUsd.mul(BASIS_POINTS_DIVISOR).div(data.mlpSupplyUsd)\n      : bigNumberify(0);\n\n  data.mlpAprTotal = data.mlpAprForNativeToken.add(data.mlpAprForEsMyc);\n\n  data.totalMlpRewardsUsd = data.stakedMlpTrackerRewardsUsd.add(data.feeMlpTrackerRewardsUsd);\n\n  data.totalEsMycRewards = data.stakedMycTrackerRewards.add(data.stakedMlpTrackerRewards);\n  data.totalEsMycRewardsUsd = data.stakedMycTrackerRewardsUsd.add(data.stakedMlpTrackerRewardsUsd);\n\n  data.mycVesterRewards = vestingData.mycVester.claimable;\n  data.mlpVesterRewards = vestingData.mlpVester.claimable;\n  data.mlpVesterRewardsUsd = vestingData.mlpVester.claimable.mul(mycPrice).div(expandDecimals(1, 18));\n  data.totalVesterRewards = data.mycVesterRewards.add(data.mlpVesterRewards);\n  data.totalVesterRewardsUsd = data.totalVesterRewards.mul(mycPrice).div(expandDecimals(1, 18));\n  data.mlpVesterVestedAmountUsd = vestingData.mlpVesterVestedAmount.mul(mycPrice).div(expandDecimals(1, 18));\n\n  data.totalNativeTokenRewards = data.feeMycTrackerRewards.add(data.feeMlpTrackerRewards);\n  data.totalNativeTokenRewardsUsd = data.feeMycTrackerRewardsUsd.add(data.feeMlpTrackerRewardsUsd);\n\n  data.totalRewardsUsd = data.totalEsMycRewardsUsd.add(data.totalNativeTokenRewardsUsd).add(data.totalVesterRewardsUsd);\n\n  return data;\n}\n\nexport async function addTokenToMetamask(token) {\n  try {\n    const wasAdded = await window.ethereum.request({\n      method: \"wallet_watchAsset\",\n      params: {\n        type: \"ERC20\",\n        options: {\n          address: token.address,\n          symbol: token.symbol,\n          decimals: token.decimals,\n          image: token.imageUrl,\n        },\n      },\n    });\n    if (wasAdded) {\n      // https://github.com/MetaMask/metamask-extension/issues/11377\n      // We can show a toast message when the token is added to metamask but because of the bug we can't. Once the bug is fixed we can show a toast message.\n    }\n  } catch (error) {\n    console.error(error);\n  }\n}\n\nexport function sleep(ms) {\n  return new Promise((resolve) => resolve(), ms);\n}\n\nexport function getPageTitle(data) {\n  return `${data} | Perpetual Swaps`;\n}\n\nexport function isHashZero(value) {\n  return value === ethers.constants.HashZero;\n}\nexport function isAddressZero(value) {\n  return value === ethers.constants.AddressZero;\n}\n\nexport function useDebounce(value, delay) {\n  // State and setters for debounced value\n  const [debouncedValue, setDebouncedValue] = useState(value);\n  useEffect(\n    () => {\n      // Update debounced value after delay\n      const handler = setTimeout(() => {\n        setDebouncedValue(value);\n      }, delay);\n      // Cancel the timeout if value changes (also on delay change or unmount)\n      // This is how we prevent debounced value from updating if value is changed ...\n      // .. within the delay period. Timeout gets cleared and restarted.\n      return () => {\n        clearTimeout(handler);\n      };\n    },\n    [value, delay] // Only re-call effect if value or delay changes\n  );\n  return debouncedValue;\n}\n\nexport function hasUserConsented() {\n  const consent = localStorage.getItem(\"consentAcknowledged\");\n  return consent && consent === \"true\";\n}\n\nexport function formatTitleCase(string, isLowerCase = false) {\n  return `${string[0].toUpperCase()}${isLowerCase ? string.slice(1).toLowerCase() : string.slice(1)}`;\n}\n\nexport const NETWORK_NAME = {\n  [ARBITRUM]: \"Arbitrum\",\n  [ARBITRUM_GOERLI]: \"Testnet\",\n};\n\nexport function getSpread(fromTokenInfo, toTokenInfo, isLong, nativeTokenAddress) {\n  if (fromTokenInfo && fromTokenInfo.maxPrice && toTokenInfo && toTokenInfo.minPrice) {\n    const fromDiff = fromTokenInfo.maxPrice.sub(fromTokenInfo.minPrice);\n    const fromSpread = fromDiff.mul(PRECISION).div(fromTokenInfo.maxPrice);\n    const toDiff = toTokenInfo.maxPrice.sub(toTokenInfo.minPrice);\n    const toSpread = toDiff.mul(PRECISION).div(toTokenInfo.maxPrice);\n\n    let value = fromSpread.add(toSpread);\n\n    const fromTokenAddress = fromTokenInfo.isNative ? nativeTokenAddress : fromTokenInfo.address;\n    const toTokenAddress = toTokenInfo.isNative ? nativeTokenAddress : toTokenInfo.address;\n\n    if (isLong && fromTokenAddress === toTokenAddress) {\n      value = fromSpread;\n    }\n\n    return {\n      value,\n      isHigh: value.gt(HIGH_SPREAD_THRESHOLD),\n    };\n  }\n}\n\nexport function getUserTokenBalances(infoTokens) {\n  let userBalances = {};\n  let tokenPrices = {};\n  let poolBalances = {};\n  Object.keys(infoTokens).forEach((token) => {\n    if (infoTokens[token]) {\n      const tokenName = formatTitleCase(infoTokens[token].symbol, true);\n      const balanceFieldName = `balance${tokenName}`;\n      const priceFieldName = `price${tokenName}`;\n      const poolBalanceFieldName = `poolBalance${tokenName}`;\n      userBalances[balanceFieldName] = parseFloat(\n        formatAmount(infoTokens[token].balance, infoTokens[token].decimals, infoTokens[token].decimals, false)\n      );\n      tokenPrices[priceFieldName] = parseFloat(formatAmount(infoTokens[token].maxPrice, USD_DECIMALS, 2, false));\n      poolBalances[poolBalanceFieldName] = parseFloat(\n        formatAmount(infoTokens[token].poolAmount, infoTokens[token].decimals, 2, false)\n      );\n    }\n  });\n  return [userBalances, tokenPrices, poolBalances];\n}\n\nexport function saveAccountToLocalStorage(address) {\n  const prevIdentifiedAccounts = window.localStorage.getItem(\"identifiedAddresses\");\n  if (!prevIdentifiedAccounts) {\n    // Create new localStorage variable to store imported accounts\n    localStorage.setItem(\"identifiedAddresses\", JSON.stringify([address]));\n  } else {\n    const parsedAccounts = JSON.parse(prevIdentifiedAccounts);\n    if (!parsedAccounts.includes(address)) {\n      parsedAccounts.push(address);\n    }\n    localStorage.setItem(\"identifiedAddresses\", JSON.stringify(parsedAccounts));\n  }\n}\n\nexport function getPreviousAccounts() {\n  const prevIdentifiedAccounts = window.localStorage.getItem(\"identifiedAddresses\");\n  if (prevIdentifiedAccounts) {\n    return JSON.parse(prevIdentifiedAccounts);\n  } else {\n    return [];\n  }\n}\n\nexport function setCurrentAccount(account) {\n  window.localStorage.setItem(\"walletAddress\", account);\n}\n\nexport function hasBeenIdentified(account) {\n  const prevIdentifiedAccounts = window.localStorage.getItem(\"identifiedAddresses\");\n  const formattedAddresses = JSON.parse(prevIdentifiedAccounts) || [];\n  return Boolean(formattedAddresses.includes(account));\n}\n\nexport function hasChangedAccount(account) {\n  const prevAccount = window.localStorage.getItem(\"walletAddress\");\n  return Boolean(prevAccount && prevAccount !== account);\n}\n\nexport function getUrlParameters(searchString) {\n  const queryString = searchString;\n  const urlParams = new URLSearchParams(queryString);\n  const keys = urlParams.keys();\n  const params = {};\n  for (const key of keys) params[key] = urlParams.get(key);\n  return params;\n}\n\nexport function getWindowFeatures() {\n  return {\n    screenHeight: window?.innerHeight || \"unknown\",\n    screenWidth: window?.innerWidth || \"unknown\",\n    screenDensity: window?.devicePixelRatio || \"unknown\",\n  };\n}\n\nconst defaultTruncateLength = 10;\n\nexport function truncateMiddleEthAddress(address, truncateLength) {\n  const strLength = truncateLength || defaultTruncateLength;\n  if (!isAddress(address)) {\n    console.warn(\"Calling toTruncatedMiddleEthAddress on a string not matching a valid Eth address format\");\n    return address;\n  }\n\n  if (strLength < 7) {\n    console.warn(\"Cannot truncate Eth address by desired amount. Returning original string.\");\n    return address;\n  }\n\n  const leadingCharsNum = strLength / 2 - 1;\n  const trailingCharsNum = strLength - leadingCharsNum - 3;\n\n  return `${address.slice(0, leadingCharsNum)}...${address.slice(-trailingCharsNum)}`;\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}